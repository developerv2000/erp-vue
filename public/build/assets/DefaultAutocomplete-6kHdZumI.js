import{_ as xe}from"./StandardLabeledGroup-BSSzWc1k.js";import{u as Ce,a as we,b as Se,c as Ae,h as Fe,d as Ie,m as De}from"./filter-CnEtE6uU.js";import{R as Pe,M as Re,au as _e,h as _,N as x,br as Me,bQ as Le,S as q,aW as Be,l as y,bs as Ee,P as M,af as W,bp as Te,Y as Ne,bt as Q,a as v,e as C,z as Y,bR as ze,F as U,az as Ke,_ as h,ax as Oe,ay as G,bg as qe,aw as Ue,bb as $e,V as je,bv as He,aK as We,aF as Qe,ba as Ye,aj as Ge,g as Je,bw as Xe,av as Ze,bz as el,bA as J,aV as ll,bB as X,bL as al,c as tl,o as ul,w as nl,b as ol}from"./app-CAQEU6tV.js";const sl=Re({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...De({filterKeys:["title"]}),...Ie(),...Ze(el({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VAutocomplete"),il=Pe()({name:"VAutocomplete",props:sl(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,w){let{slots:o}=w;const{t:$}=_e(),f=_(),g=x(!1),p=x(!0),L=x(!1),j=_(),B=_(),s=x(-1),k=x(null),{items:E,transformIn:Z,transformOut:ee}=Me(l),{textColorClasses:le,textColorStyles:ae}=Le(()=>f.value?.color),i=q(l,"search",""),u=q(l,"modelValue",[],e=>Z(e===null?[null]:Be(e)),e=>{const n=ee(e);return l.multiple?n:n[0]??null}),te=y(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),I=Ee(l),{filteredItems:T,getMatches:ue}=Ce(l,E,()=>k.value??(p.value?"":i.value)),b=y(()=>l.hideSelected&&k.value===null?T.value.filter(e=>!u.value.some(n=>n.value===e.value)):T.value),D=y(()=>!!(l.chips||o.chip)),S=y(()=>D.value||!!o.selection),ne=y(()=>u.value.map(e=>e.props.value)),N=y(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&i.value===b.value[0]?.title)&&b.value.length>0&&!p.value&&!L.value),P=y(()=>l.hideNoData&&!b.value.length||I.isReadonly.value||I.isDisabled.value),z=q(l,"menu"),r=y({get:()=>z.value,set:e=>{z.value&&!e&&j.value?.Î¨openChildren.size||e&&P.value||(z.value=e)}}),{menuId:oe,ariaExpanded:se,ariaControls:ie,ariaLabel:H}=we(l,r),K=_(),re=Se(K,f);function ce(e){l.openOnClear&&(r.value=!0),i.value=""}function ve(){P.value||(r.value=!0)}function de(e){P.value||(g.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function fe(e){(J(e)||e.key==="Backspace")&&f.value?.focus()}function me(e){if(I.isReadonly.value)return;const n=f.value?.selectionStart,c=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),N.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(a=>{let{value:t}=a;return t===b.value[0].value})&&V(b.value[0]),e.key==="ArrowDown"&&N.value&&K.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&S.value&&u.value.length>0&&!i.value)return V(u.value[0],!1);if(~s.value){e.preventDefault();const a=s.value;V(u.value[s.value],!1),s.value=a>=c-1?c-2:a}else e.key==="Backspace"&&!i.value&&(s.value=c-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(s.value<0&&n&&n>0)return;const a=s.value>-1?s.value-1:c-1;if(u.value[a])s.value=a;else{const t=i.value?.length??null;s.value=-1,f.value?.setSelectionRange(t,t)}}else if(e.key==="ArrowRight"){if(s.value<0)return;const a=s.value+1;u.value[a]?s.value=a:(s.value=-1,f.value?.setSelectionRange(0,0))}else~s.value&&J(e)&&(s.value=-1)}function pe(e){if(X(f.value,":autofill")||X(f.value,":-webkit-autofill")){const n=E.value.find(c=>c.title===e.target.value);n&&V(n)}}function he(){l.eager&&B.value?.calculateVisibleItems()}function ge(){g.value&&(p.value=!0,f.value?.focus()),k.value=null}function be(e){g.value=!0,setTimeout(()=>{L.value=!0})}function ye(e){L.value=!1}function Ve(e){(e==null||e===""&&!l.multiple&&!S.value)&&(u.value=[])}const O=x(!1);function V(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const c=u.value.findIndex(t=>(l.valueComparator||ll)(t.value,e.value)),a=n??!~c;if(~c){const t=a?[...u.value,e]:[...u.value];t.splice(c,1),u.value=t}else a&&(u.value=[...u.value,e]);l.clearOnSelect&&(i.value="")}else{const c=n!==!1;u.value=c?[e]:[],k.value=p.value?"":i.value??"",i.value=c&&!S.value?e.title:"",W(()=>{r.value=!1,p.value=!0})}}return M(g,(e,n)=>{e!==n&&(e?(O.value=!0,i.value=l.multiple||S.value?"":String(u.value.at(-1)?.props.title??""),p.value=!0,W(()=>O.value=!1)):(!l.multiple&&i.value==null&&(u.value=[]),r.value=!1,!p.value&&i.value&&(k.value=i.value),i.value="",s.value=-1))}),M(i,e=>{!g.value||O.value||(e&&(r.value=!0),p.value=!e)}),M(r,e=>{if(!l.hideSelected&&e&&u.value.length&&p.value){const n=b.value.findIndex(c=>u.value.some(a=>c.value===a.value));Te&&window.requestAnimationFrame(()=>{n>=0&&B.value?.scrollToIndex(n)})}e&&(k.value=null)}),M(E,(e,n)=>{r.value||g.value&&!n.length&&e.length&&(r.value=!0)}),Ne(()=>{const e=!!(!l.hideNoData||b.value.length||o["prepend-item"]||o["append-item"]||o["no-data"]),n=u.value.length>0,c=Q.filterProps(l);return v(Q,h({ref:f},c,{modelValue:i.value,"onUpdate:modelValue":[a=>i.value=a,Ve],focused:g.value,"onUpdate:focused":a=>g.value=a,validationValue:u.externalValue,counterValue:te.value,dirty:n,onChange:pe,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!S.value,"v-autocomplete--selecting-index":s.value>-1},l.class],style:l.style,readonly:I.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":ce,"onMousedown:control":ve,onKeydown:me,"aria-expanded":se.value,"aria-controls":ie.value}),{...o,default:()=>C(U,null,[v(Ke,h({id:oe.value,ref:j,modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,activator:"parent",contentClass:"v-autocomplete__content",disabled:P.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:he,onAfterLeave:ge},l.menuProps),{default:()=>[e&&v(Oe,h({ref:K,filterable:!0,selected:ne.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:fe,onFocusin:be,onFocusout:ye,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},re,l.listProps),{default:()=>[o["prepend-item"]?.(),!b.value.length&&!l.hideNoData&&(o["no-data"]?.()??v(G,{key:"no-data",title:$(l.noDataText)},null)),v(Ae,{ref:B,renderless:!0,items:b.value,itemKey:"value"},{default:a=>{let{item:t,index:d,itemRef:R}=a;const A=h(t.props,{ref:R,key:t.value,active:N.value&&d===0?!0:void 0,onClick:()=>V(t,null)});return t.type==="divider"?o.divider?.({props:t.raw,index:d})??v(qe,h(t.props,{key:`divider-${d}`}),null):t.type==="subheader"?o.subheader?.({props:t.raw,index:d})??v(Ue,h(t.props,{key:`subheader-${d}`}),null):o.item?.({item:t,index:d,props:A})??v(G,h(A,{role:"option"}),{prepend:F=>{let{isSelected:m}=F;return C(U,null,[l.multiple&&!l.hideSelected?v($e,{key:t.value,modelValue:m,ripple:!1,tabindex:"-1",onClick:ke=>ke.preventDefault()},null):void 0,t.props.prependAvatar&&v(je,{image:t.props.prependAvatar},null),t.props.prependIcon&&v(Y,{icon:t.props.prependIcon},null)])},title:()=>p.value?t.title:Fe("v-autocomplete",t.title,ue(t)?.title)})}}),o["append-item"]?.()]})]}),u.value.map((a,t)=>{function d(m){m.stopPropagation(),m.preventDefault(),V(a,!1)}const R={"onClick:close":d,onKeydown(m){m.key!=="Enter"&&m.key!==" "||(m.preventDefault(),m.stopPropagation(),d(m))},onMousedown(m){m.preventDefault(),m.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},A=D.value?!!o.chip:!!o.selection,F=A?He(D.value?o.chip({item:a,index:t,props:R}):o.selection({item:a,index:t})):void 0;if(!(A&&!F))return C("div",{key:a.value,class:Qe(["v-autocomplete__selection",t===s.value&&["v-autocomplete__selection--selected",le.value]]),style:We(t===s.value?ae.value:{})},[D.value?o.chip?v(Ge,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:a.title}}},{default:()=>[F]}):v(Ye,h({key:"chip",closable:l.closableChips,size:"small",text:a.title,disabled:a.props.disabled},R),null):F??C("span",{class:"v-autocomplete__selection-text"},[a.title,l.multiple&&t<u.value.length-1&&C("span",{class:"v-autocomplete__selection-comma"},[Je(",")])])])})]),"append-inner":function(){for(var a=arguments.length,t=new Array(a),d=0;d<a;d++)t[d]=arguments[d];return C(U,null,[o["append-inner"]?.(...t),l.menuIcon?v(Y,{class:"v-autocomplete__menu-icon",color:f.value?.fieldIconColor,icon:l.menuIcon,onMousedown:de,onClick:ze,"aria-label":H.value,title:H.value,tabindex:"-1"},null):void 0])}})}),Xe({isFocused:g,isPristine:p,menu:r,search:i,filteredItems:T,select:V},f)}}),dl={__name:"DefaultAutocomplete",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(l){const w=al(),o=y(()=>w.multiple===""||!!w.multiple);return($,f)=>(ul(),tl(xe,h({label:l.label},l.groupAttrs,{required:l.required}),{default:nl(()=>[v(il,h({color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},autocomplete:"off","hide-details":"auto",clearable:!o.value,"clear-on-select":!!o.value,chips:!!o.value,"closable-chips":!!o.value},ol(w)),null,16,["clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{dl as _};
