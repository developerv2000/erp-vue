import{_ as we}from"./StandardLabeledGroup-2MFCue-t.js";import{u as xe,a as Se,b as Ae,c as Ie,h as De,d as Fe,m as Pe}from"./filter-3O7ON2dG.js";import{L as Le,G as Re,ao as Me,h as M,H as I,bj as _e,bK as Te,M as H,aP as Be,l as x,bk as Ee,J as O,a9 as J,bh as Oe,R as Ne,bl as Q,a as d,e as D,A as X,bL as Ke,F as $,at as ze,T as C,ar as Ue,as as W,b8 as qe,aq as He,E as $e,V as je,bn as We,aD as Ge,az as Je,b3 as Qe,ad as Xe,g as Ye,bo as Ze,ap as el,br as ll,bs as Y,aO as tl,bt as Z,bD as al,c as ul,o as nl,w as j,b as ol,bM as sl,bN as il,bO as rl}from"./app-BQRYHKht.js";const cl=Re({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Pe({filterKeys:["title"]}),...Fe(),...el(ll({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VAutocomplete"),vl=Le()({name:"VAutocomplete",props:cl(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,F){let{slots:s}=F;const{t:A}=Me(),f=M(),g=I(!1),i=I(!0),b=I(!1),y=M(),V=M(),u=I(-1),h=I(null),{items:k,transformIn:ee,transformOut:le}=_e(l),{textColorClasses:te,textColorStyles:ae}=Te(()=>f.value?.color),r=H(l,"search",""),n=H(l,"modelValue",[],e=>ee(e===null?[null]:Be(e)),e=>{const o=le(e);return l.multiple?o:o[0]??null}),ue=x(()=>typeof l.counterValue=="function"?l.counterValue(n.value):typeof l.counterValue=="number"?l.counterValue:n.value.length),_=Ee(l),{filteredItems:N,getMatches:ne}=xe(l,k,()=>h.value??(i.value?"":r.value)),w=x(()=>l.hideSelected&&h.value===null?N.value.filter(e=>!n.value.some(o=>o.value===e.value)):N.value),T=x(()=>!!(l.chips||s.chip)),P=x(()=>T.value||!!s.selection),oe=x(()=>n.value.map(e=>e.props.value)),K=x(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&r.value===w.value[0]?.title)&&w.value.length>0&&!i.value&&!b.value),B=x(()=>l.hideNoData&&!w.value.length||_.isReadonly.value||_.isDisabled.value),z=H(l,"menu"),c=x({get:()=>z.value,set:e=>{z.value&&!e&&y.value?.Î¨openChildren.size||e&&B.value||(z.value=e)}}),{menuId:se,ariaExpanded:ie,ariaControls:re,ariaLabel:G}=Se(l,c),U=M(),ce=Ae(U,f);function ve(e){l.openOnClear&&(c.value=!0),r.value=""}function de(){B.value||(c.value=!0)}function fe(e){B.value||(g.value&&(e.preventDefault(),e.stopPropagation()),c.value=!c.value)}function me(e){(Y(e)||e.key==="Backspace")&&f.value?.focus()}function pe(e){if(_.isReadonly.value)return;const o=f.value?.selectionStart,v=n.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(c.value=!0),["Escape"].includes(e.key)&&(c.value=!1),K.value&&["Enter","Tab"].includes(e.key)&&!n.value.some(t=>{let{value:a}=t;return a===w.value[0].value})&&S(w.value[0]),e.key==="ArrowDown"&&K.value&&U.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&P.value&&n.value.length>0&&!r.value)return S(n.value[0],!1);if(~u.value){e.preventDefault();const t=u.value;S(n.value[u.value],!1),u.value=t>=v-1?v-2:t}else e.key==="Backspace"&&!r.value&&(u.value=v-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(u.value<0&&o&&o>0)return;const t=u.value>-1?u.value-1:v-1;if(n.value[t])u.value=t;else{const a=r.value?.length??null;u.value=-1,f.value?.setSelectionRange(a,a)}}else if(e.key==="ArrowRight"){if(u.value<0)return;const t=u.value+1;n.value[t]?u.value=t:(u.value=-1,f.value?.setSelectionRange(0,0))}else~u.value&&Y(e)&&(u.value=-1)}function he(e){if(Z(f.value,":autofill")||Z(f.value,":-webkit-autofill")){const o=k.value.find(v=>v.title===e.target.value);o&&S(o)}}function ge(){l.eager&&V.value?.calculateVisibleItems()}function be(){g.value&&(i.value=!0,f.value?.focus()),h.value=null}function ye(e){g.value=!0,setTimeout(()=>{b.value=!0})}function Ve(e){b.value=!1}function ke(e){(e==null||e===""&&!l.multiple&&!P.value)&&(n.value=[])}const q=I(!1);function S(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const v=n.value.findIndex(a=>(l.valueComparator||tl)(a.value,e.value)),t=o??!~v;if(~v){const a=t?[...n.value,e]:[...n.value];a.splice(v,1),n.value=a}else t&&(n.value=[...n.value,e]);l.clearOnSelect&&(r.value="")}else{const v=o!==!1;n.value=v?[e]:[],h.value=i.value?"":r.value??"",r.value=v&&!P.value?e.title:"",J(()=>{c.value=!1,i.value=!0})}}return O(g,(e,o)=>{e!==o&&(e?(q.value=!0,r.value=l.multiple||P.value?"":String(n.value.at(-1)?.props.title??""),i.value=!0,J(()=>q.value=!1)):(!l.multiple&&r.value==null&&(n.value=[]),c.value=!1,!i.value&&r.value&&(h.value=r.value),r.value="",u.value=-1))}),O(r,e=>{!g.value||q.value||(e&&(c.value=!0),i.value=!e)}),O(c,e=>{if(!l.hideSelected&&e&&n.value.length&&i.value){const o=w.value.findIndex(v=>n.value.some(t=>v.value===t.value));Oe&&window.requestAnimationFrame(()=>{o>=0&&V.value?.scrollToIndex(o)})}e&&(h.value=null)}),O(k,(e,o)=>{c.value||g.value&&!o.length&&e.length&&(c.value=!0)}),Ne(()=>{const e=!!(!l.hideNoData||w.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),o=n.value.length>0,v=Q.filterProps(l);return d(Q,C({ref:f},v,{modelValue:r.value,"onUpdate:modelValue":[t=>r.value=t,ke],focused:g.value,"onUpdate:focused":t=>g.value=t,validationValue:n.externalValue,counterValue:ue.value,dirty:o,onChange:he,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":c.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!P.value,"v-autocomplete--selecting-index":u.value>-1},l.class],style:l.style,readonly:_.isReadonly.value,placeholder:o?void 0:l.placeholder,"onClick:clear":ve,"onMousedown:control":de,onKeydown:pe,"aria-expanded":ie.value,"aria-controls":re.value}),{...s,default:()=>D($,null,[d(ze,C({id:se.value,ref:y,modelValue:c.value,"onUpdate:modelValue":t=>c.value=t,activator:"parent",contentClass:"v-autocomplete__content",disabled:B.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:ge,onAfterLeave:be},l.menuProps),{default:()=>[e&&d(Ue,C({ref:U,filterable:!0,selected:oe.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:me,onFocusin:ye,onFocusout:Ve,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},ce,l.listProps),{default:()=>[s["prepend-item"]?.(),!w.value.length&&!l.hideNoData&&(s["no-data"]?.()??d(W,{key:"no-data",title:A(l.noDataText)},null)),d(Ie,{ref:V,renderless:!0,items:w.value,itemKey:"value"},{default:t=>{let{item:a,index:m,itemRef:E}=t;const L=C(a.props,{ref:E,key:a.value,active:K.value&&m===0?!0:void 0,onClick:()=>S(a,null)});return a.type==="divider"?s.divider?.({props:a.raw,index:m})??d(qe,C(a.props,{key:`divider-${m}`}),null):a.type==="subheader"?s.subheader?.({props:a.raw,index:m})??d(He,C(a.props,{key:`subheader-${m}`}),null):s.item?.({item:a,index:m,props:L})??d(W,C(L,{role:"option"}),{prepend:R=>{let{isSelected:p}=R;return D($,null,[l.multiple&&!l.hideSelected?d($e,{key:a.value,modelValue:p,ripple:!1,tabindex:"-1",onClick:Ce=>Ce.preventDefault()},null):void 0,a.props.prependAvatar&&d(je,{image:a.props.prependAvatar},null),a.props.prependIcon&&d(X,{icon:a.props.prependIcon},null)])},title:()=>i.value?a.title:De("v-autocomplete",a.title,ne(a)?.title)})}}),s["append-item"]?.()]})]}),n.value.map((t,a)=>{function m(p){p.stopPropagation(),p.preventDefault(),S(t,!1)}const E={"onClick:close":m,onKeydown(p){p.key!=="Enter"&&p.key!==" "||(p.preventDefault(),p.stopPropagation(),m(p))},onMousedown(p){p.preventDefault(),p.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},L=T.value?!!s.chip:!!s.selection,R=L?We(T.value?s.chip({item:t,index:a,props:E}):s.selection({item:t,index:a})):void 0;if(!(L&&!R))return D("div",{key:t.value,class:Je(["v-autocomplete__selection",a===u.value&&["v-autocomplete__selection--selected",te.value]]),style:Ge(a===u.value?ae.value:{})},[T.value?s.chip?d(Xe,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:t.title}}},{default:()=>[R]}):d(Qe,C({key:"chip",closable:l.closableChips,size:"small",text:t.title,disabled:t.props.disabled},E),null):R??D("span",{class:"v-autocomplete__selection-text"},[t.title,l.multiple&&a<n.value.length-1&&D("span",{class:"v-autocomplete__selection-comma"},[Ye(",")])])])})]),"append-inner":function(){for(var t=arguments.length,a=new Array(t),m=0;m<t;m++)a[m]=arguments[m];return D($,null,[s["append-inner"]?.(...a),l.menuIcon?d(X,{class:"v-autocomplete__menu-icon",color:f.value?.fieldIconColor,icon:l.menuIcon,onMousedown:fe,onClick:Ke,"aria-label":G.value,title:G.value,tabindex:"-1"},null):void 0])}})}),Ze({isFocused:g,isPristine:i,menu:c,search:r,filteredItems:N,select:S},f)}}),pl={__name:"DefaultAutocomplete",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(l){const F=al(),s=M(""),A=x(()=>F.multiple===""||!!F.multiple),f=(i,b)=>{if(!b)return!0;if(!i)return!1;const y=String(i).toLowerCase(),V=b.toLowerCase().trim().split(/\s+/).filter(Boolean);let u=0;for(const h of V){const k=y.indexOf(h,u);if(k===-1)return!1;u=k+h.length}return!0},g=i=>{if(!s.value)return i;const b=s.value.trim().split(/\s+/).filter(Boolean).map(u=>u.toLowerCase()),y=i.toLowerCase();let V="";for(let u=0;u<y.length;u++){let h=!1;for(const k of b)if(y.startsWith(k,u)){V+=`<mark>${i.substr(u,k.length)}</mark>`,u+=k.length-1,h=!0;break}h||(V+=i[u])}return V};return(i,b)=>(nl(),ul(we,C({label:l.label},l.groupAttrs,{required:l.required}),{default:j(()=>[d(vl,C({search:s.value,"onUpdate:search":b[0]||(b[0]=y=>s.value=y),color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},autocomplete:"off","hide-details":"auto",clearable:!A.value,"clear-on-select":A.value,chips:A.value,"closable-chips":A.value,"auto-select-first":"","hide-selected":"","custom-filter":f},ol(F)),{item:j(({item:y,props:V})=>[d(W,sl(il({...V,title:null})),{default:j(()=>[d(rl,{innerHTML:g(y.title)},null,8,["innerHTML"])]),_:2},1040)]),_:1},16,["search","clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{pl as _};
