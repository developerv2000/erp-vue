import{_ as xe}from"./StandardLabeledGroup-DlI0SdXp.js";import{u as Ce,a as we,b as Se,V as Ae,h as Fe,m as Ie,c as De}from"./filter-C_VrKd3f.js";import{v as Pe,x as Re,aZ as _e,r as _,A as x,bl as Me,b8 as Le,y as U,bm as Be,c as y,bn as Ee,F as M,Z as j,bo as Te,H as Oe,bk as W,b as v,d as C,e as G,bp as Ne,M as z,b2 as qe,O as h,b0 as Ke,b1 as J,a7 as Ue,a$ as ze,bq as $e,br as He,bs as Ze,ag as je,S as We,ae as Ge,aR as Je,g as Qe,U as Xe,ak as Ye,bt as el,bu as Q,bv as ll,bw as X,a0 as al,a as tl,o as ul,w as nl,u as ol}from"./app-BN27vI2s.js";const sl=Re({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...De({filterKeys:["title"]}),...Ie(),...Ye(el({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VAutocomplete"),il=Pe()({name:"VAutocomplete",props:sl(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,w){let{slots:o}=w;const{t:$}=_e(),f=_(),g=x(!1),p=x(!0),L=x(!1),H=_(),B=_(),s=x(-1),k=x(null),{items:E,transformIn:Y,transformOut:ee}=Me(l),{textColorClasses:le,textColorStyles:ae}=Le(()=>f.value?.color),i=U(l,"search",""),u=U(l,"modelValue",[],e=>Y(e===null?[null]:Be(e)),e=>{const n=ee(e);return l.multiple?n:n[0]??null}),te=y(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),I=Ee(l),{filteredItems:T,getMatches:ue}=Ce(l,E,()=>k.value??(p.value?"":i.value)),b=y(()=>l.hideSelected&&k.value===null?T.value.filter(e=>!u.value.some(n=>n.value===e.value)):T.value),D=y(()=>!!(l.chips||o.chip)),S=y(()=>D.value||!!o.selection),ne=y(()=>u.value.map(e=>e.props.value)),O=y(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&i.value===b.value[0]?.title)&&b.value.length>0&&!p.value&&!L.value),P=y(()=>l.hideNoData&&!b.value.length||I.isReadonly.value||I.isDisabled.value),N=U(l,"menu"),r=y({get:()=>N.value,set:e=>{N.value&&!e&&H.value?.Î¨openChildren.size||e&&P.value||(N.value=e)}}),{menuId:oe,ariaExpanded:se,ariaControls:ie,ariaLabel:Z}=we(l,r),q=_(),re=Se(q,f);function ce(e){l.openOnClear&&(r.value=!0),i.value=""}function ve(){P.value||(r.value=!0)}function de(e){P.value||(g.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function fe(e){(Q(e)||e.key==="Backspace")&&f.value?.focus()}function me(e){if(I.isReadonly.value)return;const n=f.value?.selectionStart,c=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),O.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(a=>{let{value:t}=a;return t===b.value[0].value})&&V(b.value[0]),e.key==="ArrowDown"&&O.value&&q.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&S.value&&u.value.length>0&&!i.value)return V(u.value[0],!1);if(~s.value){e.preventDefault();const a=s.value;V(u.value[s.value],!1),s.value=a>=c-1?c-2:a}else e.key==="Backspace"&&!i.value&&(s.value=c-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(s.value<0&&n&&n>0)return;const a=s.value>-1?s.value-1:c-1;if(u.value[a])s.value=a;else{const t=i.value?.length??null;s.value=-1,f.value?.setSelectionRange(t,t)}}else if(e.key==="ArrowRight"){if(s.value<0)return;const a=s.value+1;u.value[a]?s.value=a:(s.value=-1,f.value?.setSelectionRange(0,0))}else~s.value&&Q(e)&&(s.value=-1)}function pe(e){if(X(f.value,":autofill")||X(f.value,":-webkit-autofill")){const n=E.value.find(c=>c.title===e.target.value);n&&V(n)}}function he(){l.eager&&B.value?.calculateVisibleItems()}function ge(){g.value&&(p.value=!0,f.value?.focus()),k.value=null}function be(e){g.value=!0,setTimeout(()=>{L.value=!0})}function ye(e){L.value=!1}function Ve(e){(e==null||e===""&&!l.multiple&&!S.value)&&(u.value=[])}const K=x(!1);function V(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const c=u.value.findIndex(t=>(l.valueComparator||ll)(t.value,e.value)),a=n??!~c;if(~c){const t=a?[...u.value,e]:[...u.value];t.splice(c,1),u.value=t}else a&&(u.value=[...u.value,e]);l.clearOnSelect&&(i.value="")}else{const c=n!==!1;u.value=c?[e]:[],k.value=p.value?"":i.value??"",i.value=c&&!S.value?e.title:"",j(()=>{r.value=!1,p.value=!0})}}return M(g,(e,n)=>{e!==n&&(e?(K.value=!0,i.value=l.multiple||S.value?"":String(u.value.at(-1)?.props.title??""),p.value=!0,j(()=>K.value=!1)):(!l.multiple&&i.value==null&&(u.value=[]),r.value=!1,!p.value&&i.value&&(k.value=i.value),i.value="",s.value=-1))}),M(i,e=>{!g.value||K.value||(e&&(r.value=!0),p.value=!e)}),M(r,e=>{if(!l.hideSelected&&e&&u.value.length&&p.value){const n=b.value.findIndex(c=>u.value.some(a=>c.value===a.value));Te&&window.requestAnimationFrame(()=>{n>=0&&B.value?.scrollToIndex(n)})}e&&(k.value=null)}),M(E,(e,n)=>{r.value||g.value&&!n.length&&e.length&&(r.value=!0)}),Oe(()=>{const e=!!(!l.hideNoData||b.value.length||o["prepend-item"]||o["append-item"]||o["no-data"]),n=u.value.length>0,c=W.filterProps(l);return v(W,h({ref:f},c,{modelValue:i.value,"onUpdate:modelValue":[a=>i.value=a,Ve],focused:g.value,"onUpdate:focused":a=>g.value=a,validationValue:u.externalValue,counterValue:te.value,dirty:n,onChange:pe,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!S.value,"v-autocomplete--selecting-index":s.value>-1},l.class],style:l.style,readonly:I.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":ce,"onMousedown:control":ve,onKeydown:me,"aria-expanded":se.value,"aria-controls":ie.value}),{...o,default:()=>C(z,null,[v(qe,h({id:oe.value,ref:H,modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,activator:"parent",contentClass:"v-autocomplete__content",disabled:P.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:he,onAfterLeave:ge},l.menuProps),{default:()=>[e&&v(Ke,h({ref:q,filterable:!0,selected:ne.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:fe,onFocusin:be,onFocusout:ye,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},re,l.listProps),{default:()=>[o["prepend-item"]?.(),!b.value.length&&!l.hideNoData&&(o["no-data"]?.()??v(J,{key:"no-data",title:$(l.noDataText)},null)),v(Ae,{ref:B,renderless:!0,items:b.value,itemKey:"value"},{default:a=>{let{item:t,index:d,itemRef:R}=a;const A=h(t.props,{ref:R,key:t.value,active:O.value&&d===0?!0:void 0,onClick:()=>V(t,null)});return t.type==="divider"?o.divider?.({props:t.raw,index:d})??v(Ue,h(t.props,{key:`divider-${d}`}),null):t.type==="subheader"?o.subheader?.({props:t.raw,index:d})??v(ze,h(t.props,{key:`subheader-${d}`}),null):o.item?.({item:t,index:d,props:A})??v(J,h(A,{role:"option"}),{prepend:F=>{let{isSelected:m}=F;return C(z,null,[l.multiple&&!l.hideSelected?v($e,{key:t.value,modelValue:m,ripple:!1,tabindex:"-1",onClick:ke=>ke.preventDefault()},null):void 0,t.props.prependAvatar&&v(He,{image:t.props.prependAvatar},null),t.props.prependIcon&&v(G,{icon:t.props.prependIcon},null)])},title:()=>p.value?t.title:Fe("v-autocomplete",t.title,ue(t)?.title)})}}),o["append-item"]?.()]})]}),u.value.map((a,t)=>{function d(m){m.stopPropagation(),m.preventDefault(),V(a,!1)}const R={"onClick:close":d,onKeydown(m){m.key!=="Enter"&&m.key!==" "||(m.preventDefault(),m.stopPropagation(),d(m))},onMousedown(m){m.preventDefault(),m.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},A=D.value?!!o.chip:!!o.selection,F=A?Ze(D.value?o.chip({item:a,index:t,props:R}):o.selection({item:a,index:t})):void 0;if(!(A&&!F))return C("div",{key:a.value,class:We(["v-autocomplete__selection",t===s.value&&["v-autocomplete__selection--selected",le.value]]),style:je(t===s.value?ae.value:{})},[D.value?o.chip?v(Je,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:a.title}}},{default:()=>[F]}):v(Ge,h({key:"chip",closable:l.closableChips,size:"small",text:a.title,disabled:a.props.disabled},R),null):F??C("span",{class:"v-autocomplete__selection-text"},[a.title,l.multiple&&t<u.value.length-1&&C("span",{class:"v-autocomplete__selection-comma"},[Qe(",")])])])})]),"append-inner":function(){for(var a=arguments.length,t=new Array(a),d=0;d<a;d++)t[d]=arguments[d];return C(z,null,[o["append-inner"]?.(...t),l.menuIcon?v(G,{class:"v-autocomplete__menu-icon",color:f.value?.fieldIconColor,icon:l.menuIcon,onMousedown:de,onClick:Ne,"aria-label":Z.value,title:Z.value,tabindex:"-1"},null):void 0])}})}),Xe({isFocused:g,isPristine:p,menu:r,search:i,filteredItems:T,select:V},f)}}),dl={__name:"DefaultAutocomplete",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(l){const w=al(),o=y(()=>w.multiple===""||!!w.multiple);return($,f)=>(ul(),tl(xe,h({label:l.label},l.groupAttrs,{required:l.required}),{default:nl(()=>[v(il,h({color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},autocomplete:"off","hide-details":"auto",clearable:!o.value,"clear-on-select":!!o.value,chips:!!o.value,"closable-chips":!!o.value},ol(w)),null,16,["clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{dl as _};
