import{_ as xe}from"./StandardLabeledGroup-CT3OW7Q_.js";import{u as Ce,a as we,b as Se,c as Ae,h as Fe,d as Ie,m as De}from"./filter-CukaYM7o.js";import{_ as Pe,U as _e,aC as Re,h as E,W as C,bz as Le,bY as Me,$,b2 as Ee,l as V,bA as Be,Y as B,an as W,bx as Te,a4 as Ne,bB as Y,a as d,e as w,z as G,bZ as Oe,F as H,aH as ze,a6 as g,aF as Ke,aG as J,bo as Ue,aE as qe,bj as $e,V as He,bD as je,aS as We,aN as Ye,bi as Ge,ar as Je,g as Ze,bE as Qe,aD as Xe,bH as el,bI as Z,b1 as ll,bJ as Q,bT as tl,c as al,o as ul,w as nl,b as ol}from"./app-SLdfdST1.js";const sl=_e({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...De({filterKeys:["title"]}),...Ie(),...Xe(el({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VAutocomplete"),il=Pe()({name:"VAutocomplete",props:sl(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,S){let{slots:o}=S;const{t:T}=Re(),v=E(),m=C(!1),h=C(!0),A=C(!1),P=E(),x=E(),s=C(-1),b=C(null),{items:N,transformIn:X,transformOut:ee}=Le(l),{textColorClasses:le,textColorStyles:te}=Me(()=>v.value?.color),i=$(l,"search",""),u=$(l,"modelValue",[],e=>X(e===null?[null]:Ee(e)),e=>{const n=ee(e);return l.multiple?n:n[0]??null}),ae=V(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),_=Be(l),{filteredItems:O,getMatches:ue}=Ce(l,N,()=>b.value??(h.value?"":i.value)),y=V(()=>l.hideSelected&&b.value===null?O.value.filter(e=>!u.value.some(n=>n.value===e.value)):O.value),R=V(()=>!!(l.chips||o.chip)),F=V(()=>R.value||!!o.selection),ne=V(()=>u.value.map(e=>e.props.value)),z=V(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&i.value===y.value[0]?.title)&&y.value.length>0&&!h.value&&!A.value),L=V(()=>l.hideNoData&&!y.value.length||_.isReadonly.value||_.isDisabled.value),K=$(l,"menu"),r=V({get:()=>K.value,set:e=>{K.value&&!e&&P.value?.Î¨openChildren.size||e&&L.value||(K.value=e)}}),{menuId:oe,ariaExpanded:se,ariaControls:ie,ariaLabel:j}=we(l,r),U=E(),re=Se(U,v);function ce(e){l.openOnClear&&(r.value=!0),i.value=""}function ve(){L.value||(r.value=!0)}function de(e){L.value||(m.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function fe(e){(Z(e)||e.key==="Backspace")&&v.value?.focus()}function me(e){if(_.isReadonly.value)return;const n=v.value?.selectionStart,c=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),z.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(t=>{let{value:a}=t;return a===y.value[0].value})&&k(y.value[0]),e.key==="ArrowDown"&&z.value&&U.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&F.value&&u.value.length>0&&!i.value)return k(u.value[0],!1);if(~s.value){e.preventDefault();const t=s.value;k(u.value[s.value],!1),s.value=t>=c-1?c-2:t}else e.key==="Backspace"&&!i.value&&(s.value=c-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(s.value<0&&n&&n>0)return;const t=s.value>-1?s.value-1:c-1;if(u.value[t])s.value=t;else{const a=i.value?.length??null;s.value=-1,v.value?.setSelectionRange(a,a)}}else if(e.key==="ArrowRight"){if(s.value<0)return;const t=s.value+1;u.value[t]?s.value=t:(s.value=-1,v.value?.setSelectionRange(0,0))}else~s.value&&Z(e)&&(s.value=-1)}function pe(e){if(Q(v.value,":autofill")||Q(v.value,":-webkit-autofill")){const n=N.value.find(c=>c.title===e.target.value);n&&k(n)}}function he(){l.eager&&x.value?.calculateVisibleItems()}function ge(){m.value&&(h.value=!0,v.value?.focus()),b.value=null}function be(e){m.value=!0,setTimeout(()=>{A.value=!0})}function ye(e){A.value=!1}function Ve(e){(e==null||e===""&&!l.multiple&&!F.value)&&(u.value=[])}const q=C(!1);function k(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const c=u.value.findIndex(a=>(l.valueComparator||ll)(a.value,e.value)),t=n??!~c;if(~c){const a=t?[...u.value,e]:[...u.value];a.splice(c,1),u.value=a}else t&&(u.value=[...u.value,e]);l.clearOnSelect&&(i.value="")}else{const c=n!==!1;u.value=c?[e]:[],b.value=h.value?"":i.value??"",i.value=c&&!F.value?e.title:"",W(()=>{r.value=!1,h.value=!0})}}return B(m,(e,n)=>{e!==n&&(e?(q.value=!0,i.value=l.multiple||F.value?"":String(u.value.at(-1)?.props.title??""),h.value=!0,W(()=>q.value=!1)):(!l.multiple&&i.value==null&&(u.value=[]),r.value=!1,!h.value&&i.value&&(b.value=i.value),i.value="",s.value=-1))}),B(i,e=>{!m.value||q.value||(e&&(r.value=!0),h.value=!e)}),B(r,e=>{if(!l.hideSelected&&e&&u.value.length&&h.value){const n=y.value.findIndex(c=>u.value.some(t=>c.value===t.value));Te&&window.requestAnimationFrame(()=>{n>=0&&x.value?.scrollToIndex(n)})}e&&(b.value=null)}),B(N,(e,n)=>{r.value||m.value&&!n.length&&e.length&&(r.value=!0)}),Ne(()=>{const e=!!(!l.hideNoData||y.value.length||o["prepend-item"]||o["append-item"]||o["no-data"]),n=u.value.length>0,c=Y.filterProps(l);return d(Y,g({ref:v},c,{modelValue:i.value,"onUpdate:modelValue":[t=>i.value=t,Ve],focused:m.value,"onUpdate:focused":t=>m.value=t,validationValue:u.externalValue,counterValue:ae.value,dirty:n,onChange:pe,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!F.value,"v-autocomplete--selecting-index":s.value>-1},l.class],style:l.style,readonly:_.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":ce,"onMousedown:control":ve,onKeydown:me,"aria-expanded":se.value,"aria-controls":ie.value}),{...o,default:()=>w(H,null,[d(ze,g({id:oe.value,ref:P,modelValue:r.value,"onUpdate:modelValue":t=>r.value=t,activator:"parent",contentClass:"v-autocomplete__content",disabled:L.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:he,onAfterLeave:ge},l.menuProps),{default:()=>[e&&d(Ke,g({ref:U,filterable:!0,selected:ne.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:fe,onFocusin:be,onFocusout:ye,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},re,l.listProps),{default:()=>[o["prepend-item"]?.(),!y.value.length&&!l.hideNoData&&(o["no-data"]?.()??d(J,{key:"no-data",title:T(l.noDataText)},null)),d(Ae,{ref:x,renderless:!0,items:y.value,itemKey:"value"},{default:t=>{let{item:a,index:f,itemRef:M}=t;const I=g(a.props,{ref:M,key:a.value,active:z.value&&f===0?!0:void 0,onClick:()=>k(a,null)});return a.type==="divider"?o.divider?.({props:a.raw,index:f})??d(Ue,g(a.props,{key:`divider-${f}`}),null):a.type==="subheader"?o.subheader?.({props:a.raw,index:f})??d(qe,g(a.props,{key:`subheader-${f}`}),null):o.item?.({item:a,index:f,props:I})??d(J,g(I,{role:"option"}),{prepend:D=>{let{isSelected:p}=D;return w(H,null,[l.multiple&&!l.hideSelected?d($e,{key:a.value,modelValue:p,ripple:!1,tabindex:"-1",onClick:ke=>ke.preventDefault()},null):void 0,a.props.prependAvatar&&d(He,{image:a.props.prependAvatar},null),a.props.prependIcon&&d(G,{icon:a.props.prependIcon},null)])},title:()=>h.value?a.title:Fe("v-autocomplete",a.title,ue(a)?.title)})}}),o["append-item"]?.()]})]}),u.value.map((t,a)=>{function f(p){p.stopPropagation(),p.preventDefault(),k(t,!1)}const M={"onClick:close":f,onKeydown(p){p.key!=="Enter"&&p.key!==" "||(p.preventDefault(),p.stopPropagation(),f(p))},onMousedown(p){p.preventDefault(),p.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},I=R.value?!!o.chip:!!o.selection,D=I?je(R.value?o.chip({item:t,index:a,props:M}):o.selection({item:t,index:a})):void 0;if(!(I&&!D))return w("div",{key:t.value,class:Ye(["v-autocomplete__selection",a===s.value&&["v-autocomplete__selection--selected",le.value]]),style:We(a===s.value?te.value:{})},[R.value?o.chip?d(Je,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:t.title}}},{default:()=>[D]}):d(Ge,g({key:"chip",closable:l.closableChips,size:"small",text:t.title,disabled:t.props.disabled},M),null):D??w("span",{class:"v-autocomplete__selection-text"},[t.title,l.multiple&&a<u.value.length-1&&w("span",{class:"v-autocomplete__selection-comma"},[Ze(",")])])])})]),"append-inner":function(){for(var t=arguments.length,a=new Array(t),f=0;f<t;f++)a[f]=arguments[f];return w(H,null,[o["append-inner"]?.(...a),l.menuIcon?d(G,{class:"v-autocomplete__menu-icon",color:v.value?.fieldIconColor,icon:l.menuIcon,onMousedown:de,onClick:Oe,"aria-label":j.value,title:j.value,tabindex:"-1"},null):void 0])}})}),Qe({isFocused:m,isPristine:h,menu:r,search:i,filteredItems:O,select:k},v)}}),dl={__name:"DefaultAutocomplete",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(l){const S=tl(),o=V(()=>S.multiple===""||!!S.multiple),T=(v,m,h)=>{if(!m)return!0;if(!v)return!1;const A=String(v).toLowerCase(),P=m.toLowerCase().trim().split(/\s+/);let x=0;for(const s of P){const b=A.indexOf(s,x);if(b===-1)return!1;x=b+s.length}return!0};return(v,m)=>(ul(),al(xe,g({label:l.label},l.groupAttrs,{required:l.required}),{default:nl(()=>[d(il,g({color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},autocomplete:"off","hide-details":"auto",clearable:!o.value,"clear-on-select":!!o.value,chips:!!o.value,"closable-chips":!!o.value,"auto-select-first":"","hide-selected":"","custom-filter":T},ol(S)),null,16,["clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{dl as _};
