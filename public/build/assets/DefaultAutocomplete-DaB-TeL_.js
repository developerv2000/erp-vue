import{_ as we}from"./StandardLabeledGroup-CKUmWAz5.js";import{u as xe,a as Se,b as Ae,c as Ie,h as Fe,d as De,m as Pe}from"./filter-p85kxTXY.js";import{_ as _e,U as Le,aC as Re,h as R,W as I,bz as Me,bY as Te,$ as H,b2 as Be,l as x,bA as Ee,Y as N,an as G,bx as Ne,a4 as Oe,bB as J,a as d,e as F,z as Z,bZ as ze,F as q,aH as Ue,a6 as C,aF as Ke,aG as j,bo as $e,aE as He,bj as qe,V as We,bD as je,aS as Ye,aN as Ge,bi as Je,ar as Ze,g as Qe,bE as Xe,aD as el,bH as ll,bI as Q,b1 as tl,bJ as X,bT as al,c as ul,o as nl,w as W,b as ol,b_ as sl,b$ as il,c0 as rl}from"./app-BLgoNwh9.js";const cl=Le({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Pe({filterKeys:["title"]}),...De(),...el(ll({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VAutocomplete"),vl=_e()({name:"VAutocomplete",props:cl(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,D){let{slots:s}=D;const{t:A}=Re(),f=R(),g=I(!1),i=I(!0),b=I(!1),y=R(),V=R(),u=I(-1),h=I(null),{items:k,transformIn:ee,transformOut:le}=Me(l),{textColorClasses:te,textColorStyles:ae}=Te(()=>f.value?.color),r=H(l,"search",""),n=H(l,"modelValue",[],e=>ee(e===null?[null]:Be(e)),e=>{const o=le(e);return l.multiple?o:o[0]??null}),ue=x(()=>typeof l.counterValue=="function"?l.counterValue(n.value):typeof l.counterValue=="number"?l.counterValue:n.value.length),M=Ee(l),{filteredItems:O,getMatches:ne}=xe(l,k,()=>h.value??(i.value?"":r.value)),w=x(()=>l.hideSelected&&h.value===null?O.value.filter(e=>!n.value.some(o=>o.value===e.value)):O.value),T=x(()=>!!(l.chips||s.chip)),P=x(()=>T.value||!!s.selection),oe=x(()=>n.value.map(e=>e.props.value)),z=x(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&r.value===w.value[0]?.title)&&w.value.length>0&&!i.value&&!b.value),B=x(()=>l.hideNoData&&!w.value.length||M.isReadonly.value||M.isDisabled.value),U=H(l,"menu"),c=x({get:()=>U.value,set:e=>{U.value&&!e&&y.value?.Î¨openChildren.size||e&&B.value||(U.value=e)}}),{menuId:se,ariaExpanded:ie,ariaControls:re,ariaLabel:Y}=Se(l,c),K=R(),ce=Ae(K,f);function ve(e){l.openOnClear&&(c.value=!0),r.value=""}function de(){B.value||(c.value=!0)}function fe(e){B.value||(g.value&&(e.preventDefault(),e.stopPropagation()),c.value=!c.value)}function me(e){(Q(e)||e.key==="Backspace")&&f.value?.focus()}function pe(e){if(M.isReadonly.value)return;const o=f.value?.selectionStart,v=n.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(c.value=!0),["Escape"].includes(e.key)&&(c.value=!1),z.value&&["Enter","Tab"].includes(e.key)&&!n.value.some(t=>{let{value:a}=t;return a===w.value[0].value})&&S(w.value[0]),e.key==="ArrowDown"&&z.value&&K.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&P.value&&n.value.length>0&&!r.value)return S(n.value[0],!1);if(~u.value){e.preventDefault();const t=u.value;S(n.value[u.value],!1),u.value=t>=v-1?v-2:t}else e.key==="Backspace"&&!r.value&&(u.value=v-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(u.value<0&&o&&o>0)return;const t=u.value>-1?u.value-1:v-1;if(n.value[t])u.value=t;else{const a=r.value?.length??null;u.value=-1,f.value?.setSelectionRange(a,a)}}else if(e.key==="ArrowRight"){if(u.value<0)return;const t=u.value+1;n.value[t]?u.value=t:(u.value=-1,f.value?.setSelectionRange(0,0))}else~u.value&&Q(e)&&(u.value=-1)}function he(e){if(X(f.value,":autofill")||X(f.value,":-webkit-autofill")){const o=k.value.find(v=>v.title===e.target.value);o&&S(o)}}function ge(){l.eager&&V.value?.calculateVisibleItems()}function be(){g.value&&(i.value=!0,f.value?.focus()),h.value=null}function ye(e){g.value=!0,setTimeout(()=>{b.value=!0})}function Ve(e){b.value=!1}function ke(e){(e==null||e===""&&!l.multiple&&!P.value)&&(n.value=[])}const $=I(!1);function S(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const v=n.value.findIndex(a=>(l.valueComparator||tl)(a.value,e.value)),t=o??!~v;if(~v){const a=t?[...n.value,e]:[...n.value];a.splice(v,1),n.value=a}else t&&(n.value=[...n.value,e]);l.clearOnSelect&&(r.value="")}else{const v=o!==!1;n.value=v?[e]:[],h.value=i.value?"":r.value??"",r.value=v&&!P.value?e.title:"",G(()=>{c.value=!1,i.value=!0})}}return N(g,(e,o)=>{e!==o&&(e?($.value=!0,r.value=l.multiple||P.value?"":String(n.value.at(-1)?.props.title??""),i.value=!0,G(()=>$.value=!1)):(!l.multiple&&r.value==null&&(n.value=[]),c.value=!1,!i.value&&r.value&&(h.value=r.value),r.value="",u.value=-1))}),N(r,e=>{!g.value||$.value||(e&&(c.value=!0),i.value=!e)}),N(c,e=>{if(!l.hideSelected&&e&&n.value.length&&i.value){const o=w.value.findIndex(v=>n.value.some(t=>v.value===t.value));Ne&&window.requestAnimationFrame(()=>{o>=0&&V.value?.scrollToIndex(o)})}e&&(h.value=null)}),N(k,(e,o)=>{c.value||g.value&&!o.length&&e.length&&(c.value=!0)}),Oe(()=>{const e=!!(!l.hideNoData||w.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),o=n.value.length>0,v=J.filterProps(l);return d(J,C({ref:f},v,{modelValue:r.value,"onUpdate:modelValue":[t=>r.value=t,ke],focused:g.value,"onUpdate:focused":t=>g.value=t,validationValue:n.externalValue,counterValue:ue.value,dirty:o,onChange:he,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":c.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!P.value,"v-autocomplete--selecting-index":u.value>-1},l.class],style:l.style,readonly:M.isReadonly.value,placeholder:o?void 0:l.placeholder,"onClick:clear":ve,"onMousedown:control":de,onKeydown:pe,"aria-expanded":ie.value,"aria-controls":re.value}),{...s,default:()=>F(q,null,[d(Ue,C({id:se.value,ref:y,modelValue:c.value,"onUpdate:modelValue":t=>c.value=t,activator:"parent",contentClass:"v-autocomplete__content",disabled:B.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:ge,onAfterLeave:be},l.menuProps),{default:()=>[e&&d(Ke,C({ref:K,filterable:!0,selected:oe.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:me,onFocusin:ye,onFocusout:Ve,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},ce,l.listProps),{default:()=>[s["prepend-item"]?.(),!w.value.length&&!l.hideNoData&&(s["no-data"]?.()??d(j,{key:"no-data",title:A(l.noDataText)},null)),d(Ie,{ref:V,renderless:!0,items:w.value,itemKey:"value"},{default:t=>{let{item:a,index:m,itemRef:E}=t;const _=C(a.props,{ref:E,key:a.value,active:z.value&&m===0?!0:void 0,onClick:()=>S(a,null)});return a.type==="divider"?s.divider?.({props:a.raw,index:m})??d($e,C(a.props,{key:`divider-${m}`}),null):a.type==="subheader"?s.subheader?.({props:a.raw,index:m})??d(He,C(a.props,{key:`subheader-${m}`}),null):s.item?.({item:a,index:m,props:_})??d(j,C(_,{role:"option"}),{prepend:L=>{let{isSelected:p}=L;return F(q,null,[l.multiple&&!l.hideSelected?d(qe,{key:a.value,modelValue:p,ripple:!1,tabindex:"-1",onClick:Ce=>Ce.preventDefault()},null):void 0,a.props.prependAvatar&&d(We,{image:a.props.prependAvatar},null),a.props.prependIcon&&d(Z,{icon:a.props.prependIcon},null)])},title:()=>i.value?a.title:Fe("v-autocomplete",a.title,ne(a)?.title)})}}),s["append-item"]?.()]})]}),n.value.map((t,a)=>{function m(p){p.stopPropagation(),p.preventDefault(),S(t,!1)}const E={"onClick:close":m,onKeydown(p){p.key!=="Enter"&&p.key!==" "||(p.preventDefault(),p.stopPropagation(),m(p))},onMousedown(p){p.preventDefault(),p.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},_=T.value?!!s.chip:!!s.selection,L=_?je(T.value?s.chip({item:t,index:a,props:E}):s.selection({item:t,index:a})):void 0;if(!(_&&!L))return F("div",{key:t.value,class:Ge(["v-autocomplete__selection",a===u.value&&["v-autocomplete__selection--selected",te.value]]),style:Ye(a===u.value?ae.value:{})},[T.value?s.chip?d(Ze,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:t.title}}},{default:()=>[L]}):d(Je,C({key:"chip",closable:l.closableChips,size:"small",text:t.title,disabled:t.props.disabled},E),null):L??F("span",{class:"v-autocomplete__selection-text"},[t.title,l.multiple&&a<n.value.length-1&&F("span",{class:"v-autocomplete__selection-comma"},[Qe(",")])])])})]),"append-inner":function(){for(var t=arguments.length,a=new Array(t),m=0;m<t;m++)a[m]=arguments[m];return F(q,null,[s["append-inner"]?.(...a),l.menuIcon?d(Z,{class:"v-autocomplete__menu-icon",color:f.value?.fieldIconColor,icon:l.menuIcon,onMousedown:fe,onClick:ze,"aria-label":Y.value,title:Y.value,tabindex:"-1"},null):void 0])}})}),Xe({isFocused:g,isPristine:i,menu:c,search:r,filteredItems:O,select:S},f)}}),pl={__name:"DefaultAutocomplete",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(l){const D=al(),s=R(""),A=x(()=>D.multiple===""||!!D.multiple),f=(i,b)=>{if(!b)return!0;if(!i)return!1;const y=String(i).toLowerCase(),V=b.toLowerCase().trim().split(/\s+/).filter(Boolean);let u=0;for(const h of V){const k=y.indexOf(h,u);if(k===-1)return!1;u=k+h.length}return!0},g=i=>{if(!s.value)return i;const b=s.value.trim().split(/\s+/).filter(Boolean).map(u=>u.toLowerCase()),y=i.toLowerCase();let V="";for(let u=0;u<y.length;u++){let h=!1;for(const k of b)if(y.startsWith(k,u)){V+=`<mark>${i.substr(u,k.length)}</mark>`,u+=k.length-1,h=!0;break}h||(V+=i[u])}return V};return(i,b)=>(nl(),ul(we,C({label:l.label},l.groupAttrs,{required:l.required}),{default:W(()=>[d(vl,C({search:s.value,"onUpdate:search":b[0]||(b[0]=y=>s.value=y),color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},autocomplete:"off","hide-details":"auto",clearable:!A.value,"clear-on-select":A.value,chips:A.value,"closable-chips":A.value,"auto-select-first":"","hide-selected":"","custom-filter":f},ol(D)),{item:W(({item:y,props:V})=>[d(j,sl(il({...V,title:null})),{default:W(()=>[d(rl,{innerHTML:g(y.title)},null,8,["innerHTML"])]),_:2},1040)]),_:1},16,["search","clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{pl as _};
