import{_ as Ce}from"./StandardLabeledGroup-BV07aOWA.js";import{u as xe,a as Se,b as we,c as Ae,h as Ie,d as De,m as Fe}from"./filter-B1WJDCTu.js";import{J as Pe,K as _e,aI as Re,h as R,O as C,bB as Me,bV as Be,M as U,b4 as Le,s as y,bC as Ee,S as M,a8 as W,bz as Oe,U as Te,bD as j,a as v,e as x,G,bW as Ke,F as z,aP as Ne,_ as h,aN as qe,aO as Q,bq as Ue,aM as ze,bl as $e,D as Je,bF as He,aV as We,a2 as je,bk as Ge,ax as Qe,g as Xe,a4 as Ye,aJ as Ze,bI as el,bJ as X,b3 as ll,bK as Y,ab as al,c as tl,o as ul,w as nl,b as ol}from"./app-hZxUZo90.js";const sl=_e({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Fe({filterKeys:["title"]}),...De(),...Ze(el({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VAutocomplete"),il=Pe()({name:"VAutocomplete",props:sl(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,S){let{slots:o}=S;const{t:$}=Re(),f=R(),g=C(!1),p=C(!0),B=C(!1),J=R(),L=R(),s=C(-1),k=C(null),{items:E,transformIn:Z,transformOut:ee}=Me(l),{textColorClasses:le,textColorStyles:ae}=Be(()=>f.value?.color),i=U(l,"search",""),u=U(l,"modelValue",[],e=>Z(e===null?[null]:Le(e)),e=>{const n=ee(e);return l.multiple?n:n[0]??null}),te=y(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),D=Ee(l),{filteredItems:O,getMatches:ue}=xe(l,E,()=>k.value??(p.value?"":i.value)),b=y(()=>l.hideSelected&&k.value===null?O.value.filter(e=>!u.value.some(n=>n.value===e.value)):O.value),F=y(()=>!!(l.chips||o.chip)),w=y(()=>F.value||!!o.selection),ne=y(()=>u.value.map(e=>e.props.value)),T=y(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&i.value===b.value[0]?.title)&&b.value.length>0&&!p.value&&!B.value),P=y(()=>l.hideNoData&&!b.value.length||D.isReadonly.value||D.isDisabled.value),K=U(l,"menu"),r=y({get:()=>K.value,set:e=>{K.value&&!e&&J.value?.Î¨openChildren.size||e&&P.value||(K.value=e)}}),{menuId:oe,ariaExpanded:se,ariaControls:ie,ariaLabel:H}=Se(l,r),N=R(),re=we(N,f);function ce(e){l.openOnClear&&(r.value=!0),i.value=""}function ve(){P.value||(r.value=!0)}function de(e){P.value||(g.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function fe(e){(X(e)||e.key==="Backspace")&&f.value?.focus()}function me(e){if(D.isReadonly.value)return;const n=f.value?.selectionStart,c=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),T.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(a=>{let{value:t}=a;return t===b.value[0].value})&&V(b.value[0]),e.key==="ArrowDown"&&T.value&&N.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&w.value&&u.value.length>0&&!i.value)return V(u.value[0],!1);if(~s.value){e.preventDefault();const a=s.value;V(u.value[s.value],!1),s.value=a>=c-1?c-2:a}else e.key==="Backspace"&&!i.value&&(s.value=c-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(s.value<0&&n&&n>0)return;const a=s.value>-1?s.value-1:c-1;if(u.value[a])s.value=a;else{const t=i.value?.length??null;s.value=-1,f.value?.setSelectionRange(t,t)}}else if(e.key==="ArrowRight"){if(s.value<0)return;const a=s.value+1;u.value[a]?s.value=a:(s.value=-1,f.value?.setSelectionRange(0,0))}else~s.value&&X(e)&&(s.value=-1)}function pe(e){if(Y(f.value,":autofill")||Y(f.value,":-webkit-autofill")){const n=E.value.find(c=>c.title===e.target.value);n&&V(n)}}function he(){l.eager&&L.value?.calculateVisibleItems()}function ge(){g.value&&(p.value=!0,f.value?.focus()),k.value=null}function be(e){g.value=!0,setTimeout(()=>{B.value=!0})}function ye(e){B.value=!1}function Ve(e){(e==null||e===""&&!l.multiple&&!w.value)&&(u.value=[])}const q=C(!1);function V(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const c=u.value.findIndex(t=>(l.valueComparator||ll)(t.value,e.value)),a=n??!~c;if(~c){const t=a?[...u.value,e]:[...u.value];t.splice(c,1),u.value=t}else a&&(u.value=[...u.value,e]);l.clearOnSelect&&(i.value="")}else{const c=n!==!1;u.value=c?[e]:[],k.value=p.value?"":i.value??"",i.value=c&&!w.value?e.title:"",W(()=>{r.value=!1,p.value=!0})}}return M(g,(e,n)=>{e!==n&&(e?(q.value=!0,i.value=l.multiple||w.value?"":String(u.value.at(-1)?.props.title??""),p.value=!0,W(()=>q.value=!1)):(!l.multiple&&i.value==null&&(u.value=[]),r.value=!1,!p.value&&i.value&&(k.value=i.value),i.value="",s.value=-1))}),M(i,e=>{!g.value||q.value||(e&&(r.value=!0),p.value=!e)}),M(r,e=>{if(!l.hideSelected&&e&&u.value.length&&p.value){const n=b.value.findIndex(c=>u.value.some(a=>c.value===a.value));Oe&&window.requestAnimationFrame(()=>{n>=0&&L.value?.scrollToIndex(n)})}e&&(k.value=null)}),M(E,(e,n)=>{r.value||g.value&&!n.length&&e.length&&(r.value=!0)}),Te(()=>{const e=!!(!l.hideNoData||b.value.length||o["prepend-item"]||o["append-item"]||o["no-data"]),n=u.value.length>0,c=j.filterProps(l);return v(j,h({ref:f},c,{modelValue:i.value,"onUpdate:modelValue":[a=>i.value=a,Ve],focused:g.value,"onUpdate:focused":a=>g.value=a,validationValue:u.externalValue,counterValue:te.value,dirty:n,onChange:pe,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!w.value,"v-autocomplete--selecting-index":s.value>-1},l.class],style:l.style,readonly:D.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":ce,"onMousedown:control":ve,onKeydown:me,"aria-expanded":se.value,"aria-controls":ie.value}),{...o,default:()=>x(z,null,[v(Ne,h({id:oe.value,ref:J,modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,activator:"parent",contentClass:"v-autocomplete__content",disabled:P.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:he,onAfterLeave:ge},l.menuProps),{default:()=>[e&&v(qe,h({ref:N,filterable:!0,selected:ne.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:fe,onFocusin:be,onFocusout:ye,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},re,l.listProps),{default:()=>[o["prepend-item"]?.(),!b.value.length&&!l.hideNoData&&(o["no-data"]?.()??v(Q,{key:"no-data",title:$(l.noDataText)},null)),v(Ae,{ref:L,renderless:!0,items:b.value,itemKey:"value"},{default:a=>{let{item:t,index:d,itemRef:_}=a;const A=h(t.props,{ref:_,key:t.value,active:T.value&&d===0?!0:void 0,onClick:()=>V(t,null)});return t.type==="divider"?o.divider?.({props:t.raw,index:d})??v(Ue,h(t.props,{key:`divider-${d}`}),null):t.type==="subheader"?o.subheader?.({props:t.raw,index:d})??v(ze,h(t.props,{key:`subheader-${d}`}),null):o.item?.({item:t,index:d,props:A})??v(Q,h(A,{role:"option"}),{prepend:I=>{let{isSelected:m}=I;return x(z,null,[l.multiple&&!l.hideSelected?v($e,{key:t.value,modelValue:m,ripple:!1,tabindex:"-1",onClick:ke=>ke.preventDefault()},null):void 0,t.props.prependAvatar&&v(Je,{image:t.props.prependAvatar},null),t.props.prependIcon&&v(G,{icon:t.props.prependIcon},null)])},title:()=>p.value?t.title:Ie("v-autocomplete",t.title,ue(t)?.title)})}}),o["append-item"]?.()]})]}),u.value.map((a,t)=>{function d(m){m.stopPropagation(),m.preventDefault(),V(a,!1)}const _={"onClick:close":d,onKeydown(m){m.key!=="Enter"&&m.key!==" "||(m.preventDefault(),m.stopPropagation(),d(m))},onMousedown(m){m.preventDefault(),m.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},A=F.value?!!o.chip:!!o.selection,I=A?He(F.value?o.chip({item:a,index:t,props:_}):o.selection({item:a,index:t})):void 0;if(!(A&&!I))return x("div",{key:a.value,class:je(["v-autocomplete__selection",t===s.value&&["v-autocomplete__selection--selected",le.value]]),style:We(t===s.value?ae.value:{})},[F.value?o.chip?v(Qe,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:a.title}}},{default:()=>[I]}):v(Ge,h({key:"chip",closable:l.closableChips,size:"small",text:a.title,disabled:a.props.disabled},_),null):I??x("span",{class:"v-autocomplete__selection-text"},[a.title,l.multiple&&t<u.value.length-1&&x("span",{class:"v-autocomplete__selection-comma"},[Xe(",")])])])})]),"append-inner":function(){for(var a=arguments.length,t=new Array(a),d=0;d<a;d++)t[d]=arguments[d];return x(z,null,[o["append-inner"]?.(...t),l.menuIcon?v(G,{class:"v-autocomplete__menu-icon",color:f.value?.fieldIconColor,icon:l.menuIcon,onMousedown:de,onClick:Ke,"aria-label":H.value,title:H.value,tabindex:"-1"},null):void 0])}})}),Ye({isFocused:g,isPristine:p,menu:r,search:i,filteredItems:O,select:V},f)}}),dl={__name:"DefaultAutocomplete",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(l){const S=al(),o=y(()=>S.multiple===""||!!S.multiple);return($,f)=>(ul(),tl(Ce,h({label:l.label},l.groupAttrs,{required:l.required}),{default:nl(()=>[v(il,h({color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},autocomplete:"off","hide-details":"auto",clearable:!o.value,"clear-on-select":!!o.value,chips:!!o.value,"closable-chips":!!o.value},ol(S)),null,16,["clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{dl as _};
