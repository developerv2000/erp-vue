import{_ as ke}from"./StandardLabeledGroup-BSSzWc1k.js";import{u as we,a as Se,b as Fe,c as Ie,h as De,d as Ae,m as Re}from"./filter-CnEtE6uU.js";import{R as Pe,M as _e,au as Me,h as O,N as w,br as Ee,bQ as Be,S as G,aW as Le,bs as Te,l as g,cf as R,af as P,cg as Ne,P as _,aV as J,bp as Ke,Y as Oe,bt as X,a as d,e as S,z as Z,bR as ze,F as j,az as qe,_ as p,ax as Ue,ay as ee,bg as $e,aw as je,bb as He,V as We,bv as Qe,aK as Ye,aF as Ge,ba as Je,aj as Xe,g as Ze,bw as el,av as ll,bz as al,bA as le,ch as tl,bL as ul,c as nl,o as ol,w as sl,b as il}from"./app-CAQEU6tV.js";const rl=_e({alwaysFilter:Boolean,autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Re({filterKeys:["title"]}),...Ae({hideNoData:!0,returnObject:!0}),...ll(al({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"])},"VCombobox"),cl=Pe()({name:"VCombobox",props:rl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,F){let{emit:k,slots:s}=F;const{t:H}=Me(),m=O(),y=w(!1),x=w(!0),z=w(!1),W=O(),M=O(),o=w(-1);let E=!1;const{items:Q,transformIn:ae,transformOut:te}=Ee(e),{textColorClasses:ue,textColorStyles:ne}=Be(()=>m.value?.color),u=G(e,"modelValue",[],l=>ae(Le(l)),l=>{const n=te(l);return e.multiple?n:n[0]??null}),B=Te(e),L=g(()=>!!(e.chips||s.chip)),V=g(()=>L.value||!!s.selection),b=w(!e.multiple&&!V.value?u.value[0]?.title??"":""),I=w(null),c=g({get:()=>b.value,set:async l=>{if(b.value=l??"",l===null||l===""&&!e.multiple&&!V.value?u.value=[]:!e.multiple&&!V.value&&(u.value=[R(e,l)],P(()=>M.value?.scrollToIndex(0))),l&&e.multiple&&e.delimiters?.length){const n=e.delimiters.map(Ne).join("|"),v=l.split(new RegExp(`(?:${n})+`));if(v.length>1){for(let a of v)a=a.trim(),a&&(h(R(e,a)),await P());b.value=""}}l||(o.value=-1),x.value=!l}}),oe=g(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?u.value.length:c.value.length),{filteredItems:T,getMatches:se}=we(e,Q,()=>I.value??(e.alwaysFilter||!x.value?c.value:"")),C=g(()=>e.hideSelected&&I.value===null?T.value.filter(l=>!u.value.some(n=>n.value===l.value)):T.value),N=g(()=>e.hideNoData&&!C.value.length||B.isReadonly.value||B.isDisabled.value),q=G(e,"menu"),r=g({get:()=>q.value,set:l=>{q.value&&!l&&W.value?.Î¨openChildren.size||l&&N.value||(q.value=l)}}),{menuId:ie,ariaExpanded:re,ariaControls:ce,ariaLabel:Y}=Se(e,r);_(b,l=>{E?P(()=>E=!1):y.value&&!r.value&&(r.value=!0),k("update:search",l)}),_(u,l=>{!e.multiple&&!V.value&&(b.value=l[0]?.title??"")});const ve=g(()=>u.value.map(l=>l.value)),U=g(()=>(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&c.value===C.value[0]?.title)&&C.value.length>0&&!x.value&&!z.value),$=O(),de=Fe($,m);function fe(l){E=!0,P(()=>E=!1),e.openOnClear&&(r.value=!0)}function me(){N.value||(r.value=!0)}function be(l){N.value||(y.value&&(l.preventDefault(),l.stopPropagation()),r.value=!r.value)}function he(l){(le(l)||l.key==="Backspace")&&m.value?.focus()}function ge(l){if(tl(l)||B.isReadonly.value)return;const n=m.value?.selectionStart,v=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(l.key)&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(r.value=!0),["Escape"].includes(l.key)&&(r.value=!1),U.value&&["Enter","Tab"].includes(l.key)&&!u.value.some(a=>{let{value:t}=a;return t===C.value[0].value})&&h(T.value[0]),l.key==="ArrowDown"&&U.value&&$.value?.focus("next"),l.key==="Enter"&&c.value&&(h(R(e,c.value),!0,!0),V.value&&(b.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&V.value&&u.value.length>0&&!c.value)return h(u.value[0],!1);if(~o.value){l.preventDefault();const a=o.value;h(u.value[o.value],!1),o.value=a>=v-1?v-2:a}else l.key==="Backspace"&&!c.value&&(o.value=v-1);return}if(e.multiple)if(l.key==="ArrowLeft"){if(o.value<0&&n&&n>0)return;const a=o.value>-1?o.value-1:v-1;u.value[a]?o.value=a:(o.value=-1,m.value?.setSelectionRange(c.value.length,c.value.length))}else if(l.key==="ArrowRight"){if(o.value<0)return;const a=o.value+1;u.value[a]?o.value=a:(o.value=-1,m.value?.setSelectionRange(0,0))}else~o.value&&le(l)&&(o.value=-1)}function pe(){e.eager&&M.value?.calculateVisibleItems()}function ye(){y.value&&m.value?.focus(),x.value=!0,I.value=null}function h(l){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!(!l||l.props.disabled))if(e.multiple){const a=u.value.findIndex(i=>(e.valueComparator||J)(i.value,l.value)),t=n??!~a;if(~a){const i=t?[...u.value,l]:[...u.value];i.splice(a,1),u.value=i}else t&&(u.value=[...u.value,l]);e.clearOnSelect&&(c.value="")}else{const a=n!==!1;u.value=a?[l]:[],(!x.value||e.alwaysFilter)&&b.value&&(I.value=b.value),b.value=a&&!V.value?l.title:"",P(()=>{r.value=v,x.value=!0})}}function xe(l){y.value=!0,setTimeout(()=>{z.value=!0})}function Ve(l){z.value=!1}return _(y,(l,n)=>{if(!(l||l===n)&&(o.value=-1,r.value=!1,c.value)){if(e.multiple){h(R(e,c.value));return}if(!V.value)return;u.value.some(v=>{let{title:a}=v;return a===c.value})?b.value="":h(R(e,c.value))}}),_(r,l=>{if(!e.hideSelected&&l&&u.value.length&&x.value){const n=C.value.findIndex(v=>u.value.some(a=>(e.valueComparator||J)(a.value,v.value)));Ke&&window.requestAnimationFrame(()=>{n>=0&&M.value?.scrollToIndex(n)})}l&&(I.value=null)}),_(Q,(l,n)=>{r.value||y.value&&!n.length&&l.length&&(r.value=!0)}),Oe(()=>{const l=!!(!e.hideNoData||C.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),n=u.value.length>0,v=X.filterProps(e);return d(X,p({ref:m},v,{modelValue:c.value,"onUpdate:modelValue":a=>c.value=a,focused:y.value,"onUpdate:focused":a=>y.value=a,validationValue:u.externalValue,counterValue:oe.value,dirty:n,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!V.value,"v-combobox--selecting-index":o.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:B.isReadonly.value,placeholder:n?void 0:e.placeholder,"onClick:clear":fe,"onMousedown:control":me,onKeydown:ge,"aria-expanded":re.value,"aria-controls":ce.value}),{...s,default:()=>S(j,null,[d(qe,p({id:ie.value,ref:W,modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,activator:"parent",contentClass:"v-combobox__content",disabled:N.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:pe,onAfterLeave:ye},e.menuProps),{default:()=>[l&&d(Ue,p({ref:$,filterable:!0,selected:ve.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),selectable:!0,onKeydown:he,onFocusin:xe,onFocusout:Ve,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},de,e.listProps),{default:()=>[s["prepend-item"]?.(),!C.value.length&&!e.hideNoData&&(s["no-data"]?.()??d(ee,{key:"no-data",title:H(e.noDataText)},null)),d(Ie,{ref:M,renderless:!0,items:C.value,itemKey:"value"},{default:a=>{let{item:t,index:i,itemRef:K}=a;const D=p(t.props,{ref:K,key:t.value,active:U.value&&i===0?!0:void 0,onClick:()=>h(t,null)});return t.type==="divider"?s.divider?.({props:t.raw,index:i})??d($e,p(t.props,{key:`divider-${i}`}),null):t.type==="subheader"?s.subheader?.({props:t.raw,index:i})??d(je,p(t.props,{key:`subheader-${i}`}),null):s.item?.({item:t,index:i,props:D})??d(ee,p(D,{role:"option"}),{prepend:A=>{let{isSelected:f}=A;return S(j,null,[e.multiple&&!e.hideSelected?d(He,{key:t.value,modelValue:f,ripple:!1,tabindex:"-1",onClick:Ce=>Ce.preventDefault()},null):void 0,t.props.prependAvatar&&d(We,{image:t.props.prependAvatar},null),t.props.prependIcon&&d(Z,{icon:t.props.prependIcon},null)])},title:()=>x.value?t.title:De("v-combobox",t.title,se(t)?.title)})}}),s["append-item"]?.()]})]}),u.value.map((a,t)=>{function i(f){f.stopPropagation(),f.preventDefault(),h(a,!1)}const K={"onClick:close":i,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),i(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},D=L.value?!!s.chip:!!s.selection,A=D?Qe(L.value?s.chip({item:a,index:t,props:K}):s.selection({item:a,index:t})):void 0;if(!(D&&!A))return S("div",{key:a.value,class:Ge(["v-combobox__selection",t===o.value&&["v-combobox__selection--selected",ue.value]]),style:Ye(t===o.value?ne.value:{})},[L.value?s.chip?d(Xe,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:a.title}}},{default:()=>[A]}):d(Je,p({key:"chip",closable:e.closableChips,size:"small",text:a.title,disabled:a.props.disabled},K),null):A??S("span",{class:"v-combobox__selection-text"},[a.title,e.multiple&&t<u.value.length-1&&S("span",{class:"v-combobox__selection-comma"},[Ze(",")])])])})]),"append-inner":function(){for(var a=arguments.length,t=new Array(a),i=0;i<a;i++)t[i]=arguments[i];return S(j,null,[s["append-inner"]?.(...t),(!e.hideNoData||e.items.length)&&e.menuIcon?d(Z,{class:"v-combobox__menu-icon",color:m.value?.fieldIconColor,icon:e.menuIcon,onMousedown:be,onClick:ze,"aria-label":Y.value,title:Y.value,tabindex:"-1"},null):void 0])}})}),el({isFocused:y,isPristine:x,menu:r,search:c,selectionIndex:o,filteredItems:T,select:h},m)}}),ml={__name:"DefaultCombobox",props:{label:String,required:{type:Boolean,default:!1},groupAttrs:{type:Object,default:()=>({})}},setup(e){const F=ul(),k=g(()=>F.multiple===""||!!F.multiple);return(s,H)=>(ol(),nl(ke,p(e.groupAttrs,{label:e.label,required:e.required}),{default:sl(()=>[d(cl,p({color:"orange",variant:"outlined",density:"compact","item-title":"name","item-value":"id","list-props":{density:"compact"},"auto-select-first":!0,autocomplete:"off","hide-details":"auto",clearable:!k.value,"clear-on-select":!!k.value,chips:!!k.value,"closable-chips":!!k.value},il(F)),null,16,["clearable","clear-on-select","chips","closable-chips"])]),_:1},16,["label","required"]))}};export{ml as _};
