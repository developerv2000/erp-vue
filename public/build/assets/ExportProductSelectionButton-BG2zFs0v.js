import{u as B,da as F,h as i,l as D,f,o as v,a,w as u,g as T,t as g,b as t,db as E,C as N,A as b,e as k,av as P,F as R,v as _}from"./app-7F7n231s.js";import{u as U}from"./messages-BpNGX81Q.js";import{_ as j}from"./DefaultButton-CwMkA5bK.js";import{W as w,G as z}from"./mdi-BZMfrfO1.js";import{V as A}from"./InertiaLinkedListItem-D1cs0l0k.js";const G={key:0,class:"d-flex ga-4 align-center"},I={key:1,class:"d-flex ga-4 align-center"},W={__name:"ExportProductSelectionButton",props:{model:String,store:Object},setup(y){const d=y,{t:m}=B(),V=U(),x=F(),o=i(!1),l=i(!1),r=i(!1),p=i(-1),S=D(()=>r.value?"success":"warning");function C(){r.value=!1,l.value=!0,p.value=-1,o.value=!0,_.post(route("mad.product-selection.generate",{model:d.model}),d.store.toQuery()).then(async n=>{await h(n.data.filename)})}async function h(n){l.value=!1,r.value=!0,p.value=5e3,o.value=!0,_.post(route("mad.product-selection.download",{model:d.model,filename:n}),{_token:x},{responseType:"blob"}).then(e=>{const c=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=c,s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove()}).catch(()=>{V.addSubmitionFailedMessage()})}return(n,e)=>(v(),f(R,null,[a(j,{color:"purple-lighten-2",variant:"tonal",size:"default","prepend-icon":t(w),loading:l.value,onClick:C},{default:u(()=>[T(g(t(m)("actions.PS")),1)]),_:1},8,["prepend-icon","loading"]),a(A,{class:"text-body-2",color:S.value,density:"compact",modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=c=>o.value=c),location:"top right",timeout:p.value},E({default:u(()=>[l.value?(v(),f("div",G,[a(P,{size:"20",indeterminate:""}),k("p",null,g(t(m)("files.Generating"))+"...",1)])):(v(),f("div",I,[a(b,{icon:t(w)},null,8,["icon"]),k("p",null,g(t(m)("files.Download started"))+"!",1)]))]),_:2},[r.value?{name:"actions",fn:u(()=>[a(N,{variant:"text",onClick:e[0]||(e[0]=c=>o.value=!1),icon:""},{default:u(()=>[a(b,{icon:t(z)},null,8,["icon"])]),_:1})]),key:"0"}:void 0]),1032,["color","modelValue","timeout"])],64))}};export{W as _};
