import{u as B,cQ as F,h as i,s as R,f,o as g,a,w as u,g as D,t as v,b as t,cR as N,I as T,G as k,e as b,aR as E,F as I,B as _}from"./app-C0zSqAfj.js";import{u as P}from"./messages-CzH3BBFj.js";import{_ as U}from"./DefaultButton-HVgzgV1x.js";import{N as w,x as j}from"./mdi-BINEaKNx.js";import{V as z}from"./InertiaLinkedListItem-DPQEEhma.js";const G={key:0,class:"d-flex ga-4 align-center"},L={key:1,class:"d-flex ga-4 align-center"},q={__name:"ExportProductSelectionButton",props:{model:String,store:Object},setup(x){const d=x,{t:m}=B(),y=P(),V=F(),o=i(!1),l=i(!1),r=i(!1),p=i(-1),S=R(()=>r.value?"success":"warning");function h(){r.value=!1,l.value=!0,p.value=-1,o.value=!0,_.post(route("mad.product-selection.generate",{model:d.model}),d.store.toQuery()).then(async n=>{await C(n.data.filename)})}async function C(n){l.value=!1,r.value=!0,p.value=5e3,o.value=!0,_.post(route("mad.product-selection.download",{model:d.model,filename:n}),{_token:V},{responseType:"blob"}).then(e=>{const c=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=c,s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove()}).catch(()=>{y.addSubmitionFailedMessage()})}return(n,e)=>(g(),f(I,null,[a(U,{color:"purple-lighten-2",variant:"tonal",size:"default","prepend-icon":t(w),loading:l.value,onClick:h},{default:u(()=>[D(v(t(m)("actions.PS")),1)]),_:1},8,["prepend-icon","loading"]),a(z,{class:"text-body-2",color:S.value,density:"compact",modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=c=>o.value=c),location:"top right",timeout:p.value},N({default:u(()=>[l.value?(g(),f("div",G,[a(E,{size:"20",indeterminate:""}),b("p",null,v(t(m)("files.Generating"))+"...",1)])):(g(),f("div",L,[a(k,{icon:t(w)},null,8,["icon"]),b("p",null,v(t(m)("files.Download started"))+"!",1)]))]),_:2},[r.value?{name:"actions",fn:u(()=>[a(T,{variant:"text",onClick:e[0]||(e[0]=c=>o.value=!1),icon:""},{default:u(()=>[a(k,{icon:t(j)},null,8,["icon"])]),_:1})]),key:"0"}:void 0]),1032,["color","modelValue","timeout"])],64))}};export{q as _};
