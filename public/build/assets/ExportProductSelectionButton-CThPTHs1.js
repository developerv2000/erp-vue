import{u as B,cK as F,h as i,l as D,f,o as v,a,w as u,g as P,t as g,b as t,cL as T,B as z,z as k,e as b,aJ as E,F as L,v as _}from"./app-BLgoNwh9.js";import{u as N}from"./messages-Daw9qpnw.js";import{_ as R}from"./DefaultButton-As932Yet.js";import{P as w,C as U}from"./mdi-FFd_BlEo.js";import{V as j}from"./InertiaLinkedListItem-C0g-MFzj.js";const I={key:0,class:"d-flex ga-4 align-center"},M={key:1,class:"d-flex ga-4 align-center"},K={__name:"ExportProductSelectionButton",props:{model:String,store:Object},setup(y){const d=y,{t:m}=B(),V=N(),x=F(),o=i(!1),l=i(!1),r=i(!1),p=i(-1),S=D(()=>r.value?"success":"warning");function C(){r.value=!1,l.value=!0,p.value=-1,o.value=!0,_.post(route("mad.product-selection.generate",{model:d.model}),d.store.toQuery()).then(async n=>{await h(n.data.filename)})}async function h(n){l.value=!1,r.value=!0,p.value=5e3,o.value=!0,_.post(route("mad.product-selection.download",{model:d.model,filename:n}),{_token:x},{responseType:"blob"}).then(e=>{const c=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=c,s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove()}).catch(()=>{V.addSubmitionFailedMessage()})}return(n,e)=>(v(),f(L,null,[a(R,{color:"purple-lighten-2",variant:"tonal",size:"default","prepend-icon":t(w),loading:l.value,onClick:C},{default:u(()=>[P(g(t(m)("actions.PS")),1)]),_:1},8,["prepend-icon","loading"]),a(j,{class:"text-body-2",color:S.value,density:"compact",modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=c=>o.value=c),location:"top right",timeout:p.value},T({default:u(()=>[l.value?(v(),f("div",I,[a(E,{size:"20",indeterminate:""}),b("p",null,g(t(m)("files.Generating"))+"...",1)])):(v(),f("div",M,[a(k,{icon:t(w)},null,8,["icon"]),b("p",null,g(t(m)("files.Download started"))+"!",1)]))]),_:2},[r.value?{name:"actions",fn:u(()=>[a(z,{variant:"text",onClick:e[0]||(e[0]=c=>o.value=!1),icon:""},{default:u(()=>[a(k,{icon:t(U)},null,8,["icon"])]),_:1})]),key:"0"}:void 0]),1032,["color","modelValue","timeout"])],64))}};export{K as _};
