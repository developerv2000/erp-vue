import{u as B,d6 as F,h as i,l as z,f,o as v,a,w as u,g as D,t as g,b as t,d7 as P,B as T,z as k,e as b,aJ as E,F as N,v as _}from"./app-hg2q9IKQ.js";import{u as R}from"./messages-DmLjcNv9.js";import{_ as U}from"./DefaultButton-DgD0IqzP.js";import{P as w,z as j}from"./mdi-DS42Ge1w.js";import{V as I}from"./InertiaLinkedListItem-BA9HFC2N.js";const L={key:0,class:"d-flex ga-4 align-center"},M={key:1,class:"d-flex ga-4 align-center"},Q={__name:"ExportProductSelectionButton",props:{model:String,store:Object},setup(y){const d=y,{t:m}=B(),V=R(),x=F(),o=i(!1),l=i(!1),r=i(!1),p=i(-1),S=z(()=>r.value?"success":"warning");function h(){r.value=!1,l.value=!0,p.value=-1,o.value=!0,_.post(route("mad.product-selection.generate",{model:d.model}),d.store.toQuery()).then(async n=>{await C(n.data.filename)})}async function C(n){l.value=!1,r.value=!0,p.value=5e3,o.value=!0,_.post(route("mad.product-selection.download",{model:d.model,filename:n}),{_token:x},{responseType:"blob"}).then(e=>{const c=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=c,s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove()}).catch(()=>{V.addSubmitionFailedMessage()})}return(n,e)=>(v(),f(N,null,[a(U,{color:"purple-lighten-2",variant:"tonal",size:"default","prepend-icon":t(w),loading:l.value,onClick:h},{default:u(()=>[D(g(t(m)("actions.PS")),1)]),_:1},8,["prepend-icon","loading"]),a(I,{class:"text-body-2",color:S.value,density:"compact",modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=c=>o.value=c),location:"top right",timeout:p.value},P({default:u(()=>[l.value?(v(),f("div",L,[a(E,{size:"20",indeterminate:""}),b("p",null,g(t(m)("files.Generating"))+"...",1)])):(v(),f("div",M,[a(k,{icon:t(w)},null,8,["icon"]),b("p",null,g(t(m)("files.Download started"))+"!",1)]))]),_:2},[r.value?{name:"actions",fn:u(()=>[a(T,{variant:"text",onClick:e[0]||(e[0]=c=>o.value=!1),icon:""},{default:u(()=>[a(k,{icon:t(j)},null,8,["icon"])]),_:1})]),key:"0"}:void 0]),1032,["color","modelValue","timeout"])],64))}};export{Q as _};
