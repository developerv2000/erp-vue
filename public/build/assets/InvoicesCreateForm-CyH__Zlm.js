import{u as w,d as B,h,m as E,p as M,s as T,D as U,v as I,c as V,o as n,w as l,a,g as f,t as p,b as e,e as N,f as j,F as R,r as z,E as A}from"./app-Bv235s-M.js";import{u as L,F as O}from"./vee-validate-B-1CKIak.js";import{u as G}from"./useVeeFormFields-J-_CRR1z.js";import{u as H}from"./useFormData-DEk4Ge6e.js";import{u as J}from"./messages-CrCj1jht.js";import{u as K}from"./useDateFormatter-cYKpR2k9.js";import{D as c}from"./DefaultSheet-kIGXXLen.js";import{_}from"./DefaultTitle-BFXSLasM.js";import{_ as Q}from"./DefaultWysiwyg-4IHBiKGV.js";import{F as W}from"./FormActionsContainer-Bg-aVW1K.js";import{_ as X}from"./FormResetButton-B0o_1JkG.js";import{_ as Y}from"./FormStoreAndRedirectBack-rqUP_AYw.js";import{_ as Z}from"./DefaultDateInput-Bd8T_AhU.js";import{_ as ee}from"./DefaultFileInput-DBvx7X94.js";import{V as F,a as b}from"./VRow-DQpkIAa1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-DHmFV98J.js";import"./DefaultButton-DBGLuZMW.js";import"./mdi-CnKAdudM.js";const ye={__name:"InvoicesCreateForm",setup(ae){const{t}=w(),{objectToFormData:y}=H(),m=B(),u=J(),{removeDateTimezonesFromFormData:C}=K(),d=h(!1),k=E({receive_date:U().required(),pdf_file:T().required(),products:M().required().min(1)}),v={receive_date:null,pdf_file:null,products:m.props.availableProducts.map(i=>i.id),comment:null},{errors:g,handleSubmit:D,resetForm:$,setErrors:x,meta:S}=L({validationSchema:k,initialValues:{...v}}),{values:r}=G(Object.keys(v)),P=D(i=>{const o=y({...i,order_id:m.props.order.id,payment_type_id:m.props.paymentType.id});C(o),d.value=!0,I.post(route("cmd.invoices.store"),o).then(()=>{u.addCreatedSuccessfullyMessage(),window.history.back()}).catch(s=>{s.response?.status===422?(x(s.response.data.errors),u.addFixErrorsMessage()):u.addSubmitionFailedMessage()}).finally(()=>{d.value=!1})});return(i,o)=>(n(),V(e(O),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:l(()=>[a(c,null,{default:l(()=>[a(_,null,{default:l(()=>[f(p(e(t)("Invoice")),1)]),_:1}),a(F,null,{default:l(()=>[a(b,null,{default:l(()=>[a(Z,{label:e(t)("dates.Receive"),modelValue:e(r).receive_date,"onUpdate:modelValue":o[0]||(o[0]=s=>e(r).receive_date=s),"error-messages":e(g).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),a(b,null,{default:l(()=>[a(ee,{label:e(t)("fields.Pdf"),modelValue:e(r).pdf_file,"onUpdate:modelValue":o[1]||(o[1]=s=>e(r).pdf_file=s),"error-messages":e(g).pdf_file,accept:".pdf",required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(c,null,{default:l(()=>[a(_,null,{default:l(()=>[f(p(e(t)("Products")),1)]),_:1}),N("div",null,[(n(!0),j(R,null,z(e(m).props.availableProducts,s=>(n(),V(A,{key:s.id,modelValue:e(r).products,"onUpdate:modelValue":o[2]||(o[2]=q=>e(r).products=q),value:s.id,label:s.process.full_english_product_label,disabled:e(m).props.isPrepayment,color:"primary"},null,8,["modelValue","value","label","disabled"]))),128))])]),_:1}),a(c,null,{default:l(()=>[a(_,null,{default:l(()=>[f(p(e(t)("Comment")),1)]),_:1}),a(F,null,{default:l(()=>[a(b,{cols:"12"},{default:l(()=>[a(Q,{modelValue:e(r).comment,"onUpdate:modelValue":o[3]||(o[3]=s=>e(r).comment=s),label:e(t)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(W,null,{default:l(()=>[a(X,{onClick:e($),loading:d.value},null,8,["onClick","loading"]),a(Y,{onClick:e(P),loading:d.value,disabled:!e(S).valid},null,8,["onClick","loading","disabled"])]),_:1})]),_:1}))}};export{ye as default};
