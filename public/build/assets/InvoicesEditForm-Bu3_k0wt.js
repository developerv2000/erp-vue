import{u as E,d as T,l as p,h as V,m as A,s as P,D as z,j as L,c as F,o as $,w as s,a,g as k,t as D,b as e,k as O}from"./app-Bv235s-M.js";import{u as G,F as H}from"./vee-validate-B-1CKIak.js";import{u as J}from"./useVeeFormFields-J-_CRR1z.js";import{u as K}from"./useFormData-DEk4Ge6e.js";import{u as Q}from"./messages-CrCj1jht.js";import{u as W}from"./useDateFormatter-cYKpR2k9.js";import{D as y}from"./DefaultSheet-kIGXXLen.js";import{_ as x}from"./DefaultTitle-BFXSLasM.js";import{_ as C}from"./DefaultWysiwyg-4IHBiKGV.js";import{F as X}from"./FormActionsContainer-Bg-aVW1K.js";import{_ as Y}from"./FormResetButton-B0o_1JkG.js";import{a as Z,_ as h}from"./FormUpdateWithourRedirect-CCYSlGQz.js";import{_ as ee}from"./DefaultDateInput-Bd8T_AhU.js";import{_ as ae}from"./DefaultFileInput-DBvx7X94.js";import{V as S,a as n}from"./VRow-DQpkIAa1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-DHmFV98J.js";import"./DefaultButton-DBGLuZMW.js";import"./mdi-CnKAdudM.js";const ke={__name:"InvoicesEditForm",setup(le){const{t}=E(),{objectToFormData:w}=K(),I=T(),d=Q(),{removeDateTimezonesFromFormData:R}=W(),m=p(()=>I.props.record),u=V(!1),i=V(!1),U=A({receive_date:z().required(),pdf_file:P().nullable()}),q=p(()=>({receive_date:m.value.receive_date,pdf_file:null})),M={comment:null},f=p(()=>({...q.value,...M})),{handleSubmit:N,errors:c,setErrors:j,resetForm:_,meta:v}=G({validationSchema:U,initialValues:f.value}),{values:r}=J(Object.keys(f.value)),b=N(g=>{const l=w(g);R(l),u.value=!0,axios.post(route("import.invoices.update",{record:m.value.id}),l).then(()=>{d.addUpdatedSuccessfullyMessage(),i.value?window.history.back():B()}).catch(o=>{o.response?.status===422?(j(o.response.data.errors),d.addFixErrorsMessage()):d.addSubmitionFailedMessage()}).finally(()=>{u.value=!1})}),B=()=>{L.reload({only:["record"],onSuccess:()=>{_({values:f.value})}})};return(g,l)=>($(),F(e(H),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:s(()=>[a(y,null,{default:s(()=>[a(x,null,{default:s(()=>[k(D(e(t)("Invoice")),1)]),_:1}),a(S,null,{default:s(()=>[a(n,null,{default:s(()=>[a(ee,{label:e(t)("dates.Receive"),modelValue:e(r).receive_date,"onUpdate:modelValue":l[0]||(l[0]=o=>e(r).receive_date=o),"error-messages":e(c).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),a(n,null,{default:s(()=>[a(ae,{label:e(t)("fields.Pdf"),modelValue:e(r).pdf_file,"onUpdate:modelValue":l[1]||(l[1]=o=>e(r).pdf_file=o),"error-messages":e(c).pdf_file,accept:".pdf",required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(y,null,{default:s(()=>[a(x,null,{default:s(()=>[k(D(e(t)("Comments")),1)]),_:1}),a(S,null,{default:s(()=>[a(n,null,{default:s(()=>[a(C,{modelValue:e(r).comment,"onUpdate:modelValue":l[2]||(l[2]=o=>e(r).comment=o),label:e(t)("comments.New"),"error-messages":e(c).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),m.value.last_comment?($(),F(n,{key:0},{default:s(()=>[a(C,{modelValue:m.value.last_comment.body,"onUpdate:modelValue":l[3]||(l[3]=o=>m.value.last_comment.body=o),label:e(t)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):O("",!0)]),_:1})]),_:1}),a(X,null,{default:s(()=>[a(Y,{onClick:e(_),loading:u.value},null,8,["onClick","loading"]),a(Z,{onClick:l[4]||(l[4]=o=>{i.value=!1,e(b)()}),loading:u.value,disabled:!e(v).valid},null,8,["loading","disabled"]),a(h,{onClick:l[5]||(l[5]=o=>{i.value=!0,e(b)()}),loading:u.value,disabled:!e(v).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{ke as default};
