import{u as T,d as A,l as p,h as x,m as L,s as z,n as O,D as C,j as G,c as b,o as i,w as o,a,g as y,t as v,b as e,e as H,f as J,F as K,r as Q,E as W,k as X}from"./app-CMSjNDK4.js";import{u as Y,F as Z}from"./vee-validate-D0NdbX5f.js";import{u as h}from"./useVeeFormFields-CKtARDYP.js";import{u as ee}from"./useFormData-DEk4Ge6e.js";import{u as ae}from"./messages-eCh_LZOb.js";import{u as le}from"./useDateFormatter-DsH7D03H.js";import{D as V}from"./DefaultSheet-C3udEJ1M.js";import{_ as g}from"./DefaultTitle-C2ikS6Ai.js";import{_ as S}from"./DefaultWysiwyg-Dc19NImY.js";import{F as te}from"./FormActionsContainer-CD-jvVHg.js";import{_ as oe}from"./FormResetButton-BccgBDwk.js";import{a as se,_ as re}from"./FormUpdateWithourRedirect-Di25lv8j.js";import{_ as q}from"./DefaultDateInput-hK9FKZtC.js";import{_ as ne}from"./DefaultFileInput-cwwBF39G.js";import{_ as me}from"./DefaultTextField-JI6kPgYm.js";import{V as w,a as m}from"./VRow-Dvbb8rke.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-DYDuYIbt.js";import"./DefaultButton-CFfFCqKo.js";import"./mdi-BZMfrfO1.js";import"./WrappedLabelGroup-YDYEYAYF.js";const Be={__name:"InvoicesEditForm",setup(ue){const{t:r}=T(),{objectToFormData:U}=ee(),B=A(),c=ae(),{removeDateTimezonesFromFormData:I}=le(),n=p(()=>B.props.record),u=x(!1),_=x(!1),E=L({payment_request_date_by_financier:C().nullable(),payment_date:C().nullable(),number:O().nullable(),payment_confirmation_document:z().nullable()}),N=p(()=>({payment_request_date_by_financier:n.value.payment_request_date_by_financier,payment_date:n.value.payment_date,number:n.value.number,payment_confirmation_document:null})),M={comment:null},f=p(()=>({...N.value,...M})),{handleSubmit:P,errors:d,setErrors:R,resetForm:F,meta:k}=Y({validationSchema:E,initialValues:f.value}),{values:s}=h(Object.keys(f.value)),$=P(D=>{const l=U(D);I(l),u.value=!0,axios.post(route("prd.invoices.production-types.update",{record:n.value.id}),l).then(()=>{c.addUpdatedSuccessfullyMessage(),_.value?window.history.back():j()}).catch(t=>{t.response?.status===422?(R(t.response.data.errors),c.addFixErrorsMessage()):c.addSubmitionFailedMessage()}).finally(()=>{u.value=!1})}),j=()=>{G.reload({only:["record"],onSuccess:()=>{F({values:f.value})}})};return(D,l)=>(i(),b(e(Z),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[a(V,null,{default:o(()=>[a(g,null,{default:o(()=>[y(v(e(r)("Invoice")),1)]),_:1}),a(w,null,{default:o(()=>[a(m,{cols:"6"},{default:o(()=>[a(q,{label:e(r)("dates.Payment request"),modelValue:e(s).payment_request_date_by_financier,"onUpdate:modelValue":l[0]||(l[0]=t=>e(s).payment_request_date_by_financier=t),"error-messages":e(d).payment_request_date_by_financier},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"6"},{default:o(()=>[a(me,{label:e(r)("fields.Invoie â„–"),modelValue:e(s).number,"onUpdate:modelValue":l[1]||(l[1]=t=>e(s).number=t),"error-messages":e(d).number},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"6"},{default:o(()=>[a(q,{label:e(r)("dates.Payment"),modelValue:e(s).payment_date,"onUpdate:modelValue":l[2]||(l[2]=t=>e(s).payment_date=t),"error-messages":e(d).payment_date},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"6"},{default:o(()=>[a(ne,{label:e(r)("fields.Swift"),modelValue:e(s).payment_confirmation_document,"onUpdate:modelValue":l[3]||(l[3]=t=>e(s).payment_confirmation_document=t),"error-messages":e(d).payment_confirmation_document},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(V,null,{default:o(()=>[a(g,null,{default:o(()=>[y(v(e(r)("Products")),1)]),_:1}),H("div",null,[(i(!0),J(K,null,Q(n.value.products,t=>(i(),b(W,{key:t.id,label:t.process.full_english_product_label,"model-value":!0,color:"primary",disabled:""},null,8,["label"]))),128))])]),_:1}),a(V,null,{default:o(()=>[a(g,null,{default:o(()=>[y(v(e(r)("Comments")),1)]),_:1}),a(w,null,{default:o(()=>[a(m,null,{default:o(()=>[a(S,{modelValue:e(s).comment,"onUpdate:modelValue":l[4]||(l[4]=t=>e(s).comment=t),label:e(r)("comments.New"),"error-messages":e(d).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),n.value.last_comment?(i(),b(m,{key:0},{default:o(()=>[a(S,{modelValue:n.value.last_comment.body,"onUpdate:modelValue":l[5]||(l[5]=t=>n.value.last_comment.body=t),label:e(r)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):X("",!0)]),_:1})]),_:1}),a(te,null,{default:o(()=>[a(oe,{onClick:e(F),loading:u.value},null,8,["onClick","loading"]),a(se,{onClick:l[6]||(l[6]=t=>{_.value=!1,e($)()}),loading:u.value,disabled:!e(k).valid},null,8,["loading","disabled"]),a(re,{onClick:l[7]||(l[7]=t=>{_.value=!0,e($)()}),loading:u.value,disabled:!e(k).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Be as default};
