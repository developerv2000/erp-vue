import{u as T,d as A,l as c,h as V,m as z,s as L,n as O,D as g,j as G,c as F,o as $,w as o,a,g as k,t as D,b as e,k as H}from"./app-Bv235s-M.js";import{u as J,F as K}from"./vee-validate-B-1CKIak.js";import{u as Q}from"./useVeeFormFields-J-_CRR1z.js";import{u as W}from"./useFormData-DEk4Ge6e.js";import{u as X}from"./messages-CrCj1jht.js";import{u as Y}from"./useDateFormatter-cYKpR2k9.js";import{D as x}from"./DefaultSheet-kIGXXLen.js";import{_ as C}from"./DefaultTitle-BFXSLasM.js";import{_ as S}from"./DefaultWysiwyg-4IHBiKGV.js";import{F as Z}from"./FormActionsContainer-Bg-aVW1K.js";import{_ as h}from"./FormResetButton-B0o_1JkG.js";import{a as ee,_ as ae}from"./FormUpdateWithourRedirect-CCYSlGQz.js";import{_ as q}from"./DefaultDateInput-Bd8T_AhU.js";import{_ as le}from"./DefaultFileInput-DBvx7X94.js";import{_ as te}from"./DefaultTextField-DEo4xlzs.js";import{V as w,a as m}from"./VRow-DQpkIAa1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-DHmFV98J.js";import"./DefaultButton-DBGLuZMW.js";import"./mdi-CnKAdudM.js";import"./WrappedLabelGroup-Cjr3GLjY.js";const Ce={__name:"InvoicesEditForm",setup(oe){const{t:n}=T(),{objectToFormData:U}=W(),I=A(),i=X(),{removeDateTimezonesFromFormData:M}=Y(),r=c(()=>I.props.record),u=V(!1),_=V(!1),N=z({payment_request_date_by_financier:g().nullable(),payment_date:g().nullable(),number:O().nullable(),payment_confirmation_document:L().nullable()}),R=c(()=>({payment_request_date_by_financier:r.value.payment_request_date_by_financier,payment_date:r.value.payment_date,number:r.value.number,payment_confirmation_document:null})),j={comment:null},f=c(()=>({...R.value,...j})),{handleSubmit:B,errors:d,setErrors:E,resetForm:p,meta:b}=J({validationSchema:N,initialValues:f.value}),{values:s}=Q(Object.keys(f.value)),y=B(v=>{const l=U(v);M(l),u.value=!0,axios.post(route("prd.invoices.import-types.update",{record:r.value.id}),l).then(()=>{i.addUpdatedSuccessfullyMessage(),_.value?window.history.back():P()}).catch(t=>{t.response?.status===422?(E(t.response.data.errors),i.addFixErrorsMessage()):i.addSubmitionFailedMessage()}).finally(()=>{u.value=!1})}),P=()=>{G.reload({only:["record"],onSuccess:()=>{p({values:f.value})}})};return(v,l)=>($(),F(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[a(x,null,{default:o(()=>[a(C,null,{default:o(()=>[k(D(e(n)("Invoice")),1)]),_:1}),a(w,null,{default:o(()=>[a(m,{cols:"6"},{default:o(()=>[a(q,{label:e(n)("dates.Payment request"),modelValue:e(s).payment_request_date_by_financier,"onUpdate:modelValue":l[0]||(l[0]=t=>e(s).payment_request_date_by_financier=t),"error-messages":e(d).payment_request_date_by_financier},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"6"},{default:o(()=>[a(te,{label:e(n)("fields.Invoie â„–"),modelValue:e(s).number,"onUpdate:modelValue":l[1]||(l[1]=t=>e(s).number=t),"error-messages":e(d).number},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"6"},{default:o(()=>[a(q,{label:e(n)("dates.Payment"),modelValue:e(s).payment_date,"onUpdate:modelValue":l[2]||(l[2]=t=>e(s).payment_date=t),"error-messages":e(d).payment_date},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"6"},{default:o(()=>[a(le,{label:e(n)("fields.Swift"),modelValue:e(s).payment_confirmation_document,"onUpdate:modelValue":l[3]||(l[3]=t=>e(s).payment_confirmation_document=t),"error-messages":e(d).payment_confirmation_document},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(C,null,{default:o(()=>[k(D(e(n)("Comments")),1)]),_:1}),a(w,null,{default:o(()=>[a(m,null,{default:o(()=>[a(S,{modelValue:e(s).comment,"onUpdate:modelValue":l[4]||(l[4]=t=>e(s).comment=t),label:e(n)("comments.New"),"error-messages":e(d).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),r.value.last_comment?($(),F(m,{key:0},{default:o(()=>[a(S,{modelValue:r.value.last_comment.body,"onUpdate:modelValue":l[5]||(l[5]=t=>r.value.last_comment.body=t),label:e(n)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):H("",!0)]),_:1})]),_:1}),a(Z,null,{default:o(()=>[a(h,{onClick:e(p),loading:u.value},null,8,["onClick","loading"]),a(ee,{onClick:l[6]||(l[6]=t=>{_.value=!1,e(y)()}),loading:u.value,disabled:!e(b).valid},null,8,["loading","disabled"]),a(ae,{onClick:l[7]||(l[7]=t=>{_.value=!0,e(y)()}),loading:u.value,disabled:!e(b).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Ce as default};
