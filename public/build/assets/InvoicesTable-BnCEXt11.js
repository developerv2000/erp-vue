import{u as v,c as f,o as c,w as t,g as r,t as i,b as o,v as I,d as V,i as C,a as p,f as b,k,F as S,e as D}from"./app-B129XDPu.js";import{u as F}from"./useQueryParams-Bqf02XNt.js";import{u as h}from"./productionTypeInvoices-2WZpNlX9.js";import{u as M}from"./useDateFormatter-CbVj98Q3.js";import{_ as N,D as R,V as w}from"./TableNavigateToPage-BIK0clJY.js";import A from"./InvoicesTableTop-DLgk7R6z.js";import{T as B}from"./TableDefaultSkeleton-DzEapxkE.js";import{_ as E}from"./TdEditButton-Bp_l6wzA.js";import"./TdInertiaLink-C6V2O5Sv.js";import{_ as x}from"./TogglableThreeLinesLimitedText-BtBsI7EM.js";import{_ as U}from"./TdRecordCommentsLink-iU1PCdd7.js";import{u as $}from"./messages-DtWWhcER.js";import{u as P}from"./global-B0kfi4Ll.js";import{_ as T}from"./DefaultButton-CvVzxMjx.js";import{q as z,M as O}from"./mdi-BiCQTzTv.js";import"./queryHelper-zuYrvkeK.js";import"./createRecordActions-Ba682ZE6.js";import"./VTable-DizTBAE1.js";import"./DefaultTableToolbar-BddToBwy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ColumnsListItem-BLOhYRxX.js";import"./VRow-B7t-PEF8.js";import"./VSwitch-DZ7AIVeK.js";import"./VNumberInput-CHjdEx4I.js";import"./FullscreenListItem-GbE2BpVh.js";import"./filter-CIvQV_OK.js";import"./InertiaLinkedButtonedIcon-DteCKhcU.js";import"./InertiaLink-KjiqGmfs.js";import"./useAuth-CdIBRpE4.js";const q={__name:"TdInvoiceAccept",props:{invoiceId:Number},setup(g){const y=g,{t:l}=v(),d=h(),a=P(),s=$(),u=m=>{a.loading=!0,I.post(route("prd.invoices.accept",{record:m})).then(n=>{s.addSuccessMessage(),d.updateRecord(n.data)}).catch(()=>{s.addSubmitionFailedMessage()}).finally(()=>{a.loading=!1})};return(m,n)=>(c(),f(T,{size:"small","append-icon":o(z),color:"secondary",onClick:n[0]||(n[0]=_=>u(y.invoiceId))},{default:t(()=>[r(i(o(l)("actions.Accept")),1)]),_:1},8,["append-icon"]))}},G={__name:"TdInvoiceCompletePayment",props:{invoiceId:Number},setup(g){const y=g,{t:l}=v(),d=h(),a=P(),s=$(),u=m=>{a.loading=!0,I.post(route("prd.invoices.complete-payment",{record:m})).then(n=>{s.addSuccessMessage(),d.updateRecord(n.data)}).catch(()=>{s.addSubmitionFailedMessage()}).finally(()=>{a.loading=!1})};return(m,n)=>(c(),f(T,{size:"small","append-icon":o(O),color:"success",onClick:n[0]||(n[0]=_=>u(y.invoiceId))},{default:t(()=>[r(i(o(l)("actions.End")),1)]),_:1},8,["append-icon"]))}},L=["href"],j=["href"],ke={__name:"InvoicesTable",setup(g){const{t:y}=v(),{get:l}=F(),d=V(),a=h(),{formatDate:s}=M();C(()=>{(!a.initializedFromInertiaPage||l("initialize_from_inertia_page"))&&a.initFromInertiaPage(d),a.fetchRecords({updateUrl:!0})});const u=n=>{a.fetchRecordsIfOptionsChanged(n)},m=n=>n.map((_,e)=>`${e+1}. ${_.process.full_english_product_label}`).join("<br>");return(n,_)=>(c(),f(w,{class:"main-table main-table--limited-height main-table--with-filter",headers:o(d).props.tableVisibleHeaders,modelValue:o(a).selected,"onUpdate:modelValue":_[0]||(_[0]=e=>o(a).selected=e),items:o(a).records,"items-length":o(a).pagination.total_records,page:o(a).pagination.page,"items-per-page":o(a).pagination.per_page,"items-per-page-options":o(R),"sort-by":[{key:o(a).pagination.order_by,order:o(a).pagination.order_direction}],"onUpdate:options":u,loading:o(a).loading,"must-sort":"","show-select":"","show-current-page":"","fixed-header":"",hover:""},{top:t(()=>[p(A)]),loading:t(()=>[p(B)]),"footer.prepend":t(()=>[p(N,{store:o(a)},null,8,["store"])]),"item.edit":t(({item:e})=>[p(E,{link:n.route("prd.invoices.production-types.edit",e.id)},null,8,["link"])]),"item.receive_date":t(({item:e})=>[r(i(o(s)(e.receive_date)),1)]),"item.payment_type_id":t(({item:e})=>[r(i(e.payment_type.name),1)]),"item.sent_for_payment_date":t(({item:e})=>[r(i(o(s)(e.sent_for_payment_date)),1)]),"item.accepted_by_financier_date":t(({item:e})=>[e.is_accepted_by_financier?(c(),b(S,{key:0},[r(i(o(s)(e.accepted_by_financier_date)),1)],64)):(c(),f(q,{key:1,"invoice-id":e.id},null,8,["invoice-id"]))]),"item.pdf_file":t(({item:e})=>[D("a",{class:"text-primary",href:e.pdf_file_url,target:"_blank"},i(e.pdf_file),9,L)]),"item.order_title":t(({item:e})=>[r(i(e.invoiceable.title),1)]),"item.order_manufacturer_name":t(({item:e})=>[r(i(e.invoiceable.manufacturer.name),1)]),"item.products":t(({item:e})=>[p(x,{text:m(e.products)},null,8,["text"])]),"item.order_country_code":t(({item:e})=>[r(i(e.invoiceable.country.code),1)]),"item.payment_request_date_by_financier":t(({item:e})=>[r(i(o(s)(e.payment_request_date_by_financier)),1)]),"item.payment_date":t(({item:e})=>[r(i(o(s)(e.payment_date)),1)]),"item.payment_completed_date":t(({item:e})=>[e.payment_is_completed?(c(),b(S,{key:0},[r(i(o(s)(e.payment_completed_date)),1)],64)):e.can_complete_payment?(c(),f(G,{key:1,"invoice-id":e.id},null,8,["invoice-id"])):k("",!0)]),"item.number":t(({item:e})=>[r(i(e.number),1)]),"item.payment_confirmation_document":t(({item:e})=>[e.payment_confirmation_document?(c(),b("a",{key:0,class:"text-primary",href:e.payment_confirmation_document_url,target:"_blank"},i(e.payment_confirmation_document),9,j)):k("",!0)]),"item.comments_count":t(({item:e})=>[p(U,{record:e},null,8,["record"])]),"item.last_comment_body":t(({item:e})=>[p(x,{class:"main-table__last-comment",text:e.last_comment?.body},null,8,["text"])]),"item.created_at":t(({item:e})=>[r(i(o(s)(e.created_at)),1)]),"item.updated_at":t(({item:e})=>[r(i(o(s)(e.updated_at)),1)]),_:1},8,["headers","modelValue","items","items-length","page","items-per-page","items-per-page-options","sort-by","loading"]))}};export{ke as default};
