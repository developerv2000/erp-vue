import{u as v,c as f,o as d,w as t,g as r,t as i,b as a,v as k,d as S,i as x,a as p,f as y,k as T,e as I,F as $}from"./app-CMSjNDK4.js";import{u as V}from"./useQueryParams-DSJ1dPLe.js";import{u as h}from"./invoices-Mee2wUU5.js";import{u as P}from"./useDateFormatter-DsH7D03H.js";import{_ as D,D as F,V as w}from"./TableNavigateToPage-DZtY5LO0.js";import N from"./InvoicesTableTop-DpSAGwbt.js";import{T as C}from"./TableDefaultSkeleton-DT6c-9fp.js";import{_ as M}from"./TdEditButton-XbcLimv4.js";import{T as R}from"./TdInertiaLink-B9gRn9a5.js";import{_ as b}from"./TogglableThreeLinesLimitedText-ABbZkxse.js";import{_ as U}from"./TdRecordCommentsLink-B7BO6V-0.js";import{u as z}from"./messages-eCh_LZOb.js";import{u as B}from"./global-DzKODoZg.js";import{_ as E}from"./DefaultButton-CFfFCqKo.js";import{g as O}from"./mdi-BZMfrfO1.js";import{_ as A}from"./TdInvoicePaymentType-BReD8mWR.js";import"./queryHelper-LZTJtzGq.js";import"./createRecordActions-BovokYM8.js";import"./VTable-C3mZiDDs.js";import"./useAuth-DUKBtqsc.js";import"./DefaultTableToolbar-ChjBEH8E.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DeleteSelectedButton-DzFN32rJ.js";import"./ColumnsListItem-yqIXi0oD.js";import"./VRow-Dvbb8rke.js";import"./VSwitch-apHMLF3B.js";import"./VNumberInput-BfmNjXd2.js";import"./FullscreenListItem-D0C4kfGX.js";import"./filter-gwBCF0wV.js";import"./InertiaLinkedButtonedIcon-YSpz34KH.js";import"./InertiaLink-B9Riv5UN.js";const L={__name:"TdInvoiceSentForPayment",props:{invoiceId:Number},setup(g){const l=g,{t:_}=v(),o=h(),n=B(),c=z(),u=s=>{n.loading=!0,k.post(route("cmd.invoices.send-for-payment",{record:s})).then(m=>{c.addSuccessMessage(),o.updateRecord(m.data)}).catch(()=>{c.addSubmitionFailedMessage()}).finally(()=>{n.loading=!1})};return(s,m)=>(d(),f(E,{size:"small","append-icon":a(O),color:"orange",onClick:m[0]||(m[0]=e=>u(l.invoiceId))},{default:t(()=>[r(i(a(_)("actions.Send")),1)]),_:1},8,["append-icon"]))}},q=["href"],G=["href"],Se={__name:"InvoicesTable",setup(g){const{get:l}=V(),_=S(),o=h(),{formatDate:n}=P();x(()=>{(!o.initializedFromInertiaPage||l("initialize_from_inertia_page"))&&o.initFromInertiaPage(_),o.fetchRecords({updateUrl:!0})});const c=s=>{o.fetchRecordsIfOptionsChanged(s)},u=s=>s.map((m,e)=>`${e+1}. ${m.process.full_english_product_label}`).join("<br>");return(s,m)=>(d(),f(w,{class:"main-table main-table--limited-height main-table--with-filter",headers:a(_).props.tableVisibleHeaders,modelValue:a(o).selected,"onUpdate:modelValue":m[0]||(m[0]=e=>a(o).selected=e),items:a(o).records,"items-length":a(o).pagination.total_records,page:a(o).pagination.page,"items-per-page":a(o).pagination.per_page,"items-per-page-options":a(F),"sort-by":[{key:a(o).pagination.order_by,order:a(o).pagination.order_direction}],"onUpdate:options":c,loading:a(o).loading,"must-sort":"","show-select":"","show-current-page":"","fixed-header":"",hover:""},{top:t(()=>[p(N)]),loading:t(()=>[p(C)]),"footer.prepend":t(()=>[p(D,{store:a(o)},null,8,["store"])]),"item.edit":t(({item:e})=>[p(M,{link:s.route("cmd.invoices.edit",e.id)},null,8,["link"])]),"item.receive_date":t(({item:e})=>[r(i(a(n)(e.receive_date)),1)]),"item.payment_type_id":t(({item:e})=>[p(A,{type:e.payment_type.name},null,8,["type"])]),"item.sent_for_payment_date":t(({item:e})=>[e.is_sent_for_payment?(d(),y($,{key:0},[r(i(a(n)(e.sent_for_payment_date)),1)],64)):(d(),f(L,{key:1,"invoice-id":e.id},null,8,["invoice-id"]))]),"item.accepted_by_financier_date":t(({item:e})=>[r(i(a(n)(e.accepted_by_financier_date)),1)]),"item.pdf_file":t(({item:e})=>[I("a",{class:"text-primary",href:e.pdf_file_url,target:"_blank"},i(e.pdf_file),9,q)]),"item.order_title":t(({item:e})=>[p(R,{link:s.route("cmd.orders.index",{"id[]":e.invoiceable_id,initialize_from_inertia_page:!0})},{default:t(()=>[r(i(e.invoiceable.title),1)]),_:2},1032,["link"])]),"item.order_manufacturer_name":t(({item:e})=>[r(i(e.invoiceable.manufacturer.name),1)]),"item.products":t(({item:e})=>[p(b,{text:u(e.products)},null,8,["text"])]),"item.order_country_code":t(({item:e})=>[r(i(e.invoiceable.country.code),1)]),"item.payment_request_date_by_financier":t(({item:e})=>[r(i(a(n)(e.payment_request_date_by_financier)),1)]),"item.payment_date":t(({item:e})=>[r(i(a(n)(e.payment_date)),1)]),"item.payment_completed_date":t(({item:e})=>[r(i(a(n)(e.payment_completed_date)),1)]),"item.number":t(({item:e})=>[r(i(e.number),1)]),"item.payment_confirmation_document":t(({item:e})=>[e.payment_confirmation_document?(d(),y("a",{key:0,class:"text-primary",href:e.payment_confirmation_document_url,target:"_blank"},i(e.payment_confirmation_document),9,G)):T("",!0)]),"item.comments_count":t(({item:e})=>[p(U,{record:e},null,8,["record"])]),"item.last_comment_body":t(({item:e})=>[p(b,{class:"main-table__last-comment",text:e.last_comment?.body},null,8,["text"])]),"item.created_at":t(({item:e})=>[r(i(a(n)(e.created_at)),1)]),"item.updated_at":t(({item:e})=>[r(i(a(n)(e.updated_at)),1)]),_:1},8,["headers","modelValue","items","items-length","page","items-per-page","items-per-page-options","sort-by","loading"]))}};export{Se as default};
