import{u as S,c as f,o as p,w as t,g as s,t as i,b as o,v as x,d as T,i as V,a as c,f as g,k as v,F as h,e as C}from"./app-BQRYHKht.js";import{u as D}from"./useQueryParams-B5qGb5Sv.js";import{u as b}from"./productionTypeInvoices-DyvabxK0.js";import{u as F}from"./useDateFormatter-KmwXWHv0.js";import{_ as N,D as M,V as R}from"./TableNavigateToPage-pW_VWFGw.js";import w from"./InvoicesTableTop-JNAwwoug.js";import{T as A}from"./TableDefaultSkeleton-DcMbDZ2S.js";import{_ as B}from"./TdEditButton-Cm9PjX_r.js";import{_ as k}from"./TogglableThreeLinesLimitedText--lUfQXQb.js";import{_ as E}from"./TdRecordCommentsLink-C9klBYU5.js";import{u as I}from"./messages-Cr-leA4g.js";import{u as $}from"./global-Db7dUzSb.js";import{_ as P}from"./DefaultButton-_QegtWBB.js";import{q as U,N as z}from"./mdi-BZMfrfO1.js";import{_ as O}from"./TdInvoicePaymentType-Be22xcUD.js";import"./queryHelper-LZTJtzGq.js";import"./createRecordActions-BovokYM8.js";import"./VTable-B3ggZOi7.js";import"./DefaultTableToolbar-D_cxf3aA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ColumnsListItem-C4OHr5V1.js";import"./VRow-pii14n6-.js";import"./VSwitch-BnVNCvXR.js";import"./VNumberInput-Br0mPjnE.js";import"./FullscreenListItem-C_S4r50t.js";import"./filter-3O7ON2dG.js";import"./InertiaLinkedButtonedIcon-CannhS2z.js";import"./TdInertiaLink-DWYbr4P1.js";import"./InertiaLink-CTYWb3ZF.js";import"./useAuth-CHzG6fTU.js";const q={__name:"TdInvoiceAccept",props:{invoiceId:Number},setup(y){const l=y,{t:_}=S(),a=b(),n=$(),d=I(),u=m=>{n.loading=!0,x.post(route("prd.invoices.accept",{record:m})).then(r=>{d.addSuccessMessage(),a.updateRecord(r.data)}).catch(()=>{d.addSubmitionFailedMessage()}).finally(()=>{n.loading=!1})};return(m,r)=>(p(),f(P,{size:"small","append-icon":o(U),color:"secondary",onClick:r[0]||(r[0]=e=>u(l.invoiceId))},{default:t(()=>[s(i(o(_)("actions.Accept")),1)]),_:1},8,["append-icon"]))}},G={__name:"TdInvoiceCompletePayment",props:{invoiceId:Number},setup(y){const l=y,{t:_}=S(),a=b(),n=$(),d=I(),u=m=>{n.loading=!0,x.post(route("prd.invoices.complete-payment",{record:m})).then(r=>{d.addSuccessMessage(),a.updateRecord(r.data)}).catch(()=>{d.addSubmitionFailedMessage()}).finally(()=>{n.loading=!1})};return(m,r)=>(p(),f(P,{size:"small","append-icon":o(z),color:"success",onClick:r[0]||(r[0]=e=>u(l.invoiceId))},{default:t(()=>[s(i(o(_)("actions.End")),1)]),_:1},8,["append-icon"]))}},L=["href"],j=["href"],Se={__name:"InvoicesTable",setup(y){const{get:l}=D(),_=T(),a=b(),{formatDate:n}=F();V(()=>{(!a.initializedFromInertiaPage||l("initialize_from_inertia_page"))&&a.initFromInertiaPage(_),a.fetchRecords({updateUrl:!0})});const d=m=>{a.fetchRecordsIfOptionsChanged(m)},u=m=>m.map((r,e)=>`${e+1}. ${r.process.full_english_product_label}`).join("<br>");return(m,r)=>(p(),f(R,{class:"main-table main-table--limited-height main-table--with-filter",headers:o(_).props.tableVisibleHeaders,modelValue:o(a).selected,"onUpdate:modelValue":r[0]||(r[0]=e=>o(a).selected=e),items:o(a).records,"items-length":o(a).pagination.total_records,page:o(a).pagination.page,"items-per-page":o(a).pagination.per_page,"items-per-page-options":o(M),"sort-by":[{key:o(a).pagination.order_by,order:o(a).pagination.order_direction}],"onUpdate:options":d,loading:o(a).loading,"must-sort":"","show-select":"","show-current-page":"","fixed-header":"",hover:""},{top:t(()=>[c(w)]),loading:t(()=>[c(A)]),"footer.prepend":t(()=>[c(N,{store:o(a)},null,8,["store"])]),"item.edit":t(({item:e})=>[c(B,{link:m.route("prd.invoices.production-types.edit",e.id)},null,8,["link"])]),"item.receive_date":t(({item:e})=>[s(i(o(n)(e.receive_date)),1)]),"item.payment_type_id":t(({item:e})=>[c(O,{type:e.payment_type.name},null,8,["type"])]),"item.sent_for_payment_date":t(({item:e})=>[s(i(o(n)(e.sent_for_payment_date)),1)]),"item.accepted_by_financier_date":t(({item:e})=>[e.is_accepted_by_financier?(p(),g(h,{key:0},[s(i(o(n)(e.accepted_by_financier_date)),1)],64)):(p(),f(q,{key:1,"invoice-id":e.id},null,8,["invoice-id"]))]),"item.pdf_file":t(({item:e})=>[C("a",{class:"text-primary",href:e.pdf_file_url,target:"_blank"},i(e.pdf_file),9,L)]),"item.order_title":t(({item:e})=>[s(i(e.invoiceable.title),1)]),"item.order_manufacturer_name":t(({item:e})=>[s(i(e.invoiceable.manufacturer.name),1)]),"item.products":t(({item:e})=>[c(k,{text:u(e.products)},null,8,["text"])]),"item.order_country_code":t(({item:e})=>[s(i(e.invoiceable.country.code),1)]),"item.payment_request_date_by_financier":t(({item:e})=>[s(i(o(n)(e.payment_request_date_by_financier)),1)]),"item.payment_date":t(({item:e})=>[s(i(o(n)(e.payment_date)),1)]),"item.payment_completed_date":t(({item:e})=>[e.payment_is_completed?(p(),g(h,{key:0},[s(i(o(n)(e.payment_completed_date)),1)],64)):e.can_complete_payment?(p(),f(G,{key:1,"invoice-id":e.id},null,8,["invoice-id"])):v("",!0)]),"item.number":t(({item:e})=>[s(i(e.number),1)]),"item.payment_confirmation_document":t(({item:e})=>[e.payment_confirmation_document?(p(),g("a",{key:0,class:"text-primary",href:e.payment_confirmation_document_url,target:"_blank"},i(e.payment_confirmation_document),9,j)):v("",!0)]),"item.comments_count":t(({item:e})=>[c(E,{record:e},null,8,["record"])]),"item.last_comment_body":t(({item:e})=>[c(k,{class:"main-table__last-comment",text:e.last_comment?.body},null,8,["text"])]),"item.created_at":t(({item:e})=>[s(i(o(n)(e.created_at)),1)]),"item.updated_at":t(({item:e})=>[s(i(o(n)(e.updated_at)),1)]),_:1},8,["headers","modelValue","items","items-length","page","items-per-page","items-per-page-options","sort-by","loading"]))}};export{Se as default};
