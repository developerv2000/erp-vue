import{u as I,d as L,l as c,h as x,m as q,D as p,n as A,cP as O,j as T,c as v,o as b,w as r,a as o,k,b as e}from"./app-B9LPjWSD.js";import{u as z,F as G}from"./vee-validate-CEw9W1pP.js";import{u as H}from"./useVeeFormFields-TGFQGttC.js";import{u as J}from"./useFormData-DEk4Ge6e.js";import{u as K}from"./messages-Bx-X0MsL.js";import{u as Q}from"./useDateFormatter-BCAMysvV.js";import{D}from"./DefaultSheet-CUJFLEyh.js";import{D as W}from"./DefaultSwitch-DbkssmUU.js";import{_ as $}from"./DefaultWysiwyg-B2Vavwb9.js";import{F as X}from"./FormActionsContainer-Dq-nzt-A.js";import{_ as Y}from"./FormResetButton-SAU_D-pz.js";import{a as Z,_ as h}from"./FormUpdateWithourRedirect-Dtea9Uf8.js";import{_ as ee}from"./DefaultTextField-xUJUpIqx.js";import{_ as g}from"./DefaultDateInput-Blfg739d.js";import{V as C,a as n}from"./VRow-YwEE9k1_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSwitch-BeDFw3gd.js";import"./StandardLabeledGroup-BZldPcee.js";import"./DefaultButton-BY5T7BWX.js";import"./mdi-BiCQTzTv.js";import"./WrappedLabelGroup-DQK6QduX.js";const xe={__name:"OrderProductsEditForm",setup(ae){const{t:u}=I(),{objectToFormData:S}=J(),U=L(),_=K(),{removeDateTimezonesFromFormData:B}=Q(),s=c(()=>U.props.record),m=x(!1),i=x(!1),M=q({new_layout:O().required(),date_of_sending_new_layout_to_manufacturer:p().nullable(),box_article:A().nullable(),date_of_receiving_print_proof_from_manufacturer:p().nullable(),layout_approved_date:p().nullable()}),N=c(()=>({new_layout:s.value.new_layout,date_of_sending_new_layout_to_manufacturer:s.value.date_of_sending_new_layout_to_manufacturer,box_article:s.value.box_article,date_of_receiving_print_proof_from_manufacturer:s.value.new_layout?s.value.date_of_receiving_print_proof_from_manufacturer:null,layout_approved_date:s.value.layout_approved_date})),P={comment:null},f=c(()=>({...N.value,...P})),{handleSubmit:R,errors:d,setErrors:j,resetForm:y,meta:V}=z({validationSchema:M,initialValues:f.value}),{values:t}=H(Object.keys(f.value)),w=R(F=>{const a=S(F);B(a),m.value=!0,axios.post(route("dd.order-products.update",{record:s.value.id}),a).then(()=>{_.addUpdatedSuccessfullyMessage(),i.value?window.history.back():E()}).catch(l=>{l.response?.status===422?(j(l.response.data.errors),_.addFixErrorsMessage()):_.addSubmitionFailedMessage()}).finally(()=>{m.value=!1})}),E=()=>{T.reload({only:["record"],onSuccess:()=>{y({values:f.value})}})};return(F,a)=>(b(),v(e(G),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:r(()=>[o(D,null,{default:r(()=>[o(C,null,{default:r(()=>[o(n,{cols:"12"},{default:r(()=>[o(W,{label:e(u)("fields.New layout"),modelValue:e(t).new_layout,"onUpdate:modelValue":a[0]||(a[0]=l=>e(t).new_layout=l),color:"green"},null,8,["label","modelValue"])]),_:1}),o(n,{cols:"6"},{default:r(()=>[o(g,{label:e(u)("dates.Layout sent"),modelValue:e(t).date_of_sending_new_layout_to_manufacturer,"onUpdate:modelValue":a[1]||(a[1]=l=>e(t).date_of_sending_new_layout_to_manufacturer=l),"error-messages":e(d).date_of_sending_new_layout_to_manufacturer},null,8,["label","modelValue","error-messages"])]),_:1}),o(n,{cols:"6"},{default:r(()=>[o(ee,{label:e(u)("fields.Box article"),modelValue:e(t).box_article,"onUpdate:modelValue":a[2]||(a[2]=l=>e(t).box_article=l),"error-messages":e(d).box_article},null,8,["label","modelValue","error-messages"])]),_:1}),e(t).new_layout?(b(),v(n,{key:0,cols:"6"},{default:r(()=>[o(g,{label:e(u)("dates.Print proof receive"),modelValue:e(t).date_of_receiving_print_proof_from_manufacturer,"onUpdate:modelValue":a[3]||(a[3]=l=>e(t).date_of_receiving_print_proof_from_manufacturer=l),"error-messages":e(d).date_of_receiving_print_proof_from_manufacturer},null,8,["label","modelValue","error-messages"])]),_:1})):k("",!0),o(n,{cols:"6"},{default:r(()=>[o(g,{label:e(u)("dates.Layout approved"),modelValue:e(t).layout_approved_date,"onUpdate:modelValue":a[4]||(a[4]=l=>e(t).layout_approved_date=l),"error-messages":e(d).layout_approved_date},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),o(D,null,{default:r(()=>[o(C,null,{default:r(()=>[o(n,null,{default:r(()=>[o($,{modelValue:e(t).comment,"onUpdate:modelValue":a[5]||(a[5]=l=>e(t).comment=l),label:e(u)("comments.New"),"error-messages":e(d).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),s.value.last_comment?(b(),v(n,{key:0},{default:r(()=>[o($,{modelValue:s.value.last_comment.body,"onUpdate:modelValue":a[6]||(a[6]=l=>s.value.last_comment.body=l),label:e(u)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):k("",!0)]),_:1})]),_:1}),o(X,null,{default:r(()=>[o(Y,{onClick:e(y),loading:m.value},null,8,["onClick","loading"]),o(Z,{onClick:a[7]||(a[7]=l=>{i.value=!1,e(w)()}),loading:m.value,disabled:!e(V).valid},null,8,["loading","disabled"]),o(h,{onClick:a[8]||(a[8]=l=>{i.value=!0,e(w)()}),loading:m.value,disabled:!e(V).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{xe as default};
