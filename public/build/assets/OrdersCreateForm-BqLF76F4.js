import{u as O,d as P,h as g,m as y,p as U,q as i,n as A,d9 as R,v as j,c as E,o as T,w as o,a,b as e}from"./app-BLgoNwh9.js";import{u as h,b as z,F as I}from"./vee-validate-Drp1LwNg.js";import{u as N}from"./useVeeFormFields-CjyoEa7T.js";import{u as X}from"./useFormData-CgBSWld4.js";import"./global-p80oGj8c.js";import{u as G}from"./messages-Daw9qpnw.js";import{D as C}from"./DefaultSheet-B_F13Ex0.js";import H from"./OrdersCreateProductsRepeater-DqrhcR8Z.js";import{_ as q}from"./DefaultAutocomplete-DaB-TeL_.js";import{_ as J}from"./DefaultWysiwyg-JPRqTxNU.js";import{F as K}from"./FormActionsContainer-6sOzMZOR.js";import{_ as L}from"./FormResetButton-fHr4EBMu.js";import{_ as Q,a as W}from"./FormStoreAndReset-nHsg47pC.js";import{_ as Y}from"./FormStoreWithoutReseting-XDSvTllP.js";import{_ as Z}from"./DefaultDateInput-D-62BDQS.js";import{V as k,a as f}from"./VRow-CyYZUeep.js";import"./notifications-D7-HyuMy.js";import"./queryHelper-C2x2SXyh.js";import"./processesTable-uA5X_qMy.js";import"./processStatusHistoryTable-CBjXxKTj.js";import"./productsTable-BLcZaBVv.js";import"./attachments-CxQdauOI.js";import"./comments-Ay0h32nL.js";import"./manufacturersTable-DrB2o6yK.js";import"./usersTable-DsixxUmd.js";import"./kpi-DKQzWN0y.js";import"./useAuth-DdAYRigt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DefaultTitle-CXHnAhzD.js";import"./DefaultTextField-DLLz5uQ3.js";import"./WrappedLabelGroup-mjx86u9J.js";import"./DefaultButton-As932Yet.js";import"./DefaultNumberInput-Br_GsxGZ.js";import"./VNumberInput-C_RYYyP0.js";import"./mdi-FFd_BlEo.js";import"./StandardLabeledGroup-CKUmWAz5.js";import"./filter-p85kxTXY.js";const Ee={__name:"OrdersCreateForm",setup(ee){const{t:u}=O(),{objectToFormData:S}=X(),V=P(),p=G(),t=g(!1),d=g(!1),m=g(!1),w=y({manufacturer_id:i().required(),country_id:i().required(),receive_date:R().required(),products:U().of(y({process_id:i().required(),quantity:i().required(),comment:A().nullable(),serialization_type_id:i().required()}))}),F={manufacturer_id:null,country_id:null,receive_date:null,comment:null,products:[]},{errors:c,handleSubmit:x,resetForm:$,setErrors:D,meta:_}=h({validationSchema:w,initialValues:{...F}}),{values:l}=N(Object.keys(F)),{fields:v,push:M,remove:B}=z("products"),b=x(n=>{t.value=!0;const r=S(n);j.post(route("pld.orders.store"),r).then(()=>{p.addCreatedSuccessfullyMessage(),m.value&&$(),d.value&&window.history.back()}).catch(s=>{s.response?.status===422?(D(s.response.data.errors),p.addFixErrorsMessage()):p.addSubmitionFailedMessage()}).finally(()=>{t.value=!1})});return(n,r)=>(T(),E(e(I),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[a(C,null,{default:o(()=>[a(k,null,{default:o(()=>[a(f,{cols:"4"},{default:o(()=>[a(q,{label:e(u)("fields.Manufacturer"),items:e(V).props.manufacturers,modelValue:e(l).manufacturer_id,"onUpdate:modelValue":r[0]||(r[0]=s=>e(l).manufacturer_id=s),"error-messages":e(c).manufacturer_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),a(f,{cols:"4"},{default:o(()=>[a(q,{label:e(u)("fields.Country"),items:e(V).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(l).country_id,"onUpdate:modelValue":r[1]||(r[1]=s=>e(l).country_id=s),"error-messages":e(c).country_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),a(f,{cols:"4"},{default:o(()=>[a(Z,{label:e(u)("dates.Receive"),modelValue:e(l).receive_date,"onUpdate:modelValue":r[2]||(r[2]=s=>e(l).receive_date=s),"error-messages":e(c).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(H,{"form-values":e(l),"products-fields":e(v),push:e(M),remove:e(B)},null,8,["form-values","products-fields","push","remove"]),a(C,null,{default:o(()=>[a(k,null,{default:o(()=>[a(f,{cols:"12"},{default:o(()=>[a(J,{modelValue:e(l).comment,"onUpdate:modelValue":r[3]||(r[3]=s=>e(l).comment=s),label:e(u)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(K,null,{default:o(()=>[a(L,{onClick:r[4]||(r[4]=s=>{n.similarRecords=void 0,n.matchedATX=void 0,e($)()}),loading:t.value},null,8,["loading"]),a(Y,{onClick:r[5]||(r[5]=s=>{m.value=!1,d.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),a(Q,{onClick:r[6]||(r[6]=s=>{m.value=!0,d.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),a(W,{onClick:r[7]||(r[7]=s=>{m.value=!0,d.value=!0,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Ee as default};
