import{u as P,d as U,h as b,m as y,p as h,q as u,n as j,D as z,v as A,c as E,o as R,w as o,a,b as e}from"./app-BQRYHKht.js";import{u as T,b as I,F as N}from"./vee-validate-DrS_gLnz.js";import{u as G}from"./useVeeFormFields-Dg2HoVj1.js";import{u as H}from"./useFormData-DEk4Ge6e.js";import{u as J}from"./messages-Cr-leA4g.js";import{u as K}from"./useDateFormatter-KmwXWHv0.js";import{D as C}from"./DefaultSheet-BK-fqgfD.js";import L from"./OrdersCreateProductsRepeater-ARdu59S8.js";import{_ as q}from"./DefaultAutocomplete-BuRqL9PL.js";import{_ as Q}from"./DefaultWysiwyg-x4NvAbOl.js";import{F as W}from"./FormActionsContainer-C3ElCyZ7.js";import{_ as X}from"./FormResetButton-BmrmXXzN.js";import{_ as Y}from"./FormStoreAndRedirectBack-BVYGWQHY.js";import{_ as Z}from"./FormStoreAndReset-CRycJE4S.js";import{_ as ee}from"./FormStoreWithoutReseting-B6emMwdS.js";import{_ as ae}from"./DefaultDateInput-C61eSffF.js";import{V as k,a as n}from"./VRow-pii14n6-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./global-Db7dUzSb.js";import"./useAuth-CHzG6fTU.js";import"./DefaultTitle-RSaZXzDR.js";import"./DefaultTextField-DbOR6j_7.js";import"./WrappedLabelGroup-BiDUtg_g.js";import"./DefaultButton-_QegtWBB.js";import"./DefaultNumberInput-uQbTjR1q.js";import"./VNumberInput-Br0mPjnE.js";import"./mdi-BZMfrfO1.js";import"./StandardLabeledGroup-2MFCue-t.js";import"./filter-3O7ON2dG.js";const Oe={__name:"OrdersCreateForm",setup(re){const{t:i}=P(),{objectToFormData:D}=H(),g=U(),f=J(),{removeDateTimezonesFromFormData:x}=K(),t=b(!1),m=b(!1),d=b(!1),S=y({manufacturer_id:u().required(),country_id:u().required(),receive_date:z().required(),products:h().of(y({process_id:u().required(),quantity:u().required(),comment:j().nullable(),serialization_type_id:u().required()}))}),F={manufacturer_id:null,country_id:null,receive_date:null,comment:null,products:[]},{errors:c,handleSubmit:w,resetForm:V,setErrors:M,meta:p}=T({validationSchema:S,initialValues:{...F}}),{values:l}=G(Object.keys(F)),{fields:_,push:B,remove:O}=I("products"),v=w($=>{const r=D($);x(r),t.value=!0,A.post(route("pld.orders.store"),r).then(()=>{f.addCreatedSuccessfullyMessage(),d.value&&V(),m.value&&window.history.back()}).catch(s=>{s.response?.status===422?(M(s.response.data.errors),f.addFixErrorsMessage()):f.addSubmitionFailedMessage()}).finally(()=>{t.value=!1})});return($,r)=>(R(),E(e(N),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[a(C,null,{default:o(()=>[a(k,null,{default:o(()=>[a(n,{cols:"4"},{default:o(()=>[a(q,{label:e(i)("fields.Manufacturer"),items:e(g).props.manufacturers,modelValue:e(l).manufacturer_id,"onUpdate:modelValue":r[0]||(r[0]=s=>e(l).manufacturer_id=s),"error-messages":e(c).manufacturer_id,disabled:e(_).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),a(n,{cols:"4"},{default:o(()=>[a(q,{label:e(i)("fields.Country"),items:e(g).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(l).country_id,"onUpdate:modelValue":r[1]||(r[1]=s=>e(l).country_id=s),"error-messages":e(c).country_id,disabled:e(_).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),a(n,{cols:"4"},{default:o(()=>[a(ae,{label:e(i)("dates.Receive"),modelValue:e(l).receive_date,"onUpdate:modelValue":r[2]||(r[2]=s=>e(l).receive_date=s),"error-messages":e(c).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(L,{"form-values":e(l),"products-fields":e(_),push:e(B),remove:e(O)},null,8,["form-values","products-fields","push","remove"]),a(C,null,{default:o(()=>[a(k,null,{default:o(()=>[a(n,{cols:"12"},{default:o(()=>[a(Q,{modelValue:e(l).comment,"onUpdate:modelValue":r[3]||(r[3]=s=>e(l).comment=s),label:e(i)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(W,null,{default:o(()=>[a(X,{onClick:e(V),loading:t.value},null,8,["onClick","loading"]),a(ee,{onClick:r[4]||(r[4]=s=>{d.value=!1,m.value=!1,e(v)()}),loading:t.value,disabled:!e(p).valid},null,8,["loading","disabled"]),a(Z,{onClick:r[5]||(r[5]=s=>{d.value=!0,m.value=!1,e(v)()}),loading:t.value,disabled:!e(p).valid},null,8,["loading","disabled"]),a(Y,{onClick:r[6]||(r[6]=s=>{d.value=!0,m.value=!0,e(v)()}),loading:t.value,disabled:!e(p).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Oe as default};
