import{u as P,d as U,h as g,m as y,p as A,q as u,n as R,D as T,v as j,c as z,o as E,w as o,a as r,b as e}from"./app-B9LPjWSD.js";import{u as h,b as I,F as N}from"./vee-validate-CEw9W1pP.js";import{u as X}from"./useVeeFormFields-TGFQGttC.js";import{u as G}from"./useFormData-DEk4Ge6e.js";import{u as H}from"./messages-Bx-X0MsL.js";import{u as J}from"./useDateFormatter-BCAMysvV.js";import{D as C}from"./DefaultSheet-CUJFLEyh.js";import K from"./OrdersCreateProductsRepeater-Fh84FRFs.js";import{_ as q}from"./DefaultAutocomplete-BXgm-69R.js";import{_ as L}from"./DefaultWysiwyg-B2Vavwb9.js";import{F as Q}from"./FormActionsContainer-Dq-nzt-A.js";import{_ as W}from"./FormResetButton-SAU_D-pz.js";import{_ as Y}from"./FormStoreAndRedirectBack-ClLhu-c5.js";import{_ as Z}from"./FormStoreAndReset-CPzpHERn.js";import{_ as ee}from"./FormStoreWithoutReseting-DNYVteTe.js";import{_ as ae}from"./DefaultDateInput-Blfg739d.js";import{V as k,a as f}from"./VRow-YwEE9k1_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./global-B1_AbHmT.js";import"./useAuth-BdfaLBok.js";import"./DefaultTitle-DGhQm38J.js";import"./DefaultTextField-xUJUpIqx.js";import"./WrappedLabelGroup-DQK6QduX.js";import"./DefaultButton-BY5T7BWX.js";import"./DefaultNumberInput-LCLIRzSy.js";import"./VNumberInput-BGCQJ9Qa.js";import"./mdi-BiCQTzTv.js";import"./StandardLabeledGroup-BZldPcee.js";import"./filter-CLF1nGTb.js";const Oe={__name:"OrdersCreateForm",setup(re){const{t:i}=P(),{objectToFormData:D}=G(),F=U(),c=H(),{removeDateTimezonesFromFormData:S}=J(),t=g(!1),d=g(!1),m=g(!1),w=y({manufacturer_id:u().required(),country_id:u().required(),receive_date:T().required(),products:A().of(y({process_id:u().required(),quantity:u().required(),comment:R().nullable(),serialization_type_id:u().required()}))}),V={manufacturer_id:null,country_id:null,receive_date:null,comment:null,products:[]},{errors:p,handleSubmit:x,resetForm:$,setErrors:M,meta:_}=h({validationSchema:w,initialValues:{...V}}),{values:l}=X(Object.keys(V)),{fields:v,push:B,remove:O}=I("products"),b=x(n=>{const a=D(n);S(a),t.value=!0,j.post(route("pld.orders.store"),a).then(()=>{c.addCreatedSuccessfullyMessage(),m.value&&$(),d.value&&window.history.back()}).catch(s=>{s.response?.status===422?(M(s.response.data.errors),c.addFixErrorsMessage()):c.addSubmitionFailedMessage()}).finally(()=>{t.value=!1})});return(n,a)=>(E(),z(e(N),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[r(C,null,{default:o(()=>[r(k,null,{default:o(()=>[r(f,{cols:"4"},{default:o(()=>[r(q,{label:e(i)("fields.Manufacturer"),items:e(F).props.manufacturers,modelValue:e(l).manufacturer_id,"onUpdate:modelValue":a[0]||(a[0]=s=>e(l).manufacturer_id=s),"error-messages":e(p).manufacturer_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),r(f,{cols:"4"},{default:o(()=>[r(q,{label:e(i)("fields.Country"),items:e(F).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(l).country_id,"onUpdate:modelValue":a[1]||(a[1]=s=>e(l).country_id=s),"error-messages":e(p).country_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),r(f,{cols:"4"},{default:o(()=>[r(ae,{label:e(i)("dates.Receive"),modelValue:e(l).receive_date,"onUpdate:modelValue":a[2]||(a[2]=s=>e(l).receive_date=s),"error-messages":e(p).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),r(K,{"form-values":e(l),"products-fields":e(v),push:e(B),remove:e(O)},null,8,["form-values","products-fields","push","remove"]),r(C,null,{default:o(()=>[r(k,null,{default:o(()=>[r(f,{cols:"12"},{default:o(()=>[r(L,{modelValue:e(l).comment,"onUpdate:modelValue":a[3]||(a[3]=s=>e(l).comment=s),label:e(i)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),r(Q,null,{default:o(()=>[r(W,{onClick:a[4]||(a[4]=s=>{n.similarRecords=void 0,n.matchedATX=void 0,e($)()}),loading:t.value},null,8,["loading"]),r(ee,{onClick:a[5]||(a[5]=s=>{m.value=!1,d.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),r(Z,{onClick:a[6]||(a[6]=s=>{m.value=!0,d.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),r(Y,{onClick:a[7]||(a[7]=s=>{m.value=!0,d.value=!0,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Oe as default};
