import{u as P,d as U,h as g,m as y,p as A,q as i,n as R,d9 as T,v as j,c as z,o as E,w as s,a,b as e}from"./app-BNo3BRZK.js";import{u as h,b as I,F as N}from"./vee-validate-BGprmE20.js";import{u as X}from"./useVeeFormFields-CcqTQBJf.js";import{u as G}from"./useFormData-CgBSWld4.js";import{u as H}from"./messages-Cs0KdrfF.js";import{u as J}from"./useDateFormatter-BmNfNSqK.js";import{D as C}from"./DefaultSheet-DFjuZFHA.js";import K from"./OrdersCreateProductsRepeater-DH8tJtzi.js";import{_ as q}from"./DefaultAutocomplete-DszskMLj.js";import{_ as L}from"./DefaultWysiwyg-Berhlzg0.js";import{F as Q}from"./FormActionsContainer-DVRhIQui.js";import{_ as W}from"./FormResetButton-JYxkgVjV.js";import{_ as Y,a as Z}from"./FormStoreAndReset-DdXWvpUr.js";import{_ as ee}from"./FormStoreWithoutReseting-Ce8vmhC_.js";import{_ as re}from"./DefaultDateInput-B0xn95Is.js";import{V as k,a as f}from"./VRow-CaL1JTsj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./global-D6MjQ0eg.js";import"./notifications-CMQhZgJC.js";import"./queryHelper-C2x2SXyh.js";import"./processesTable-DPkTOcMJ.js";import"./processStatusHistoryTable-DvHlBA9L.js";import"./productsTable-DNWXQY2R.js";import"./attachments-BJYYVVB2.js";import"./comments-tUKV5Khd.js";import"./manufacturersTable-CJSwRuvl.js";import"./usersTable-DGLRepJo.js";import"./kpi-D8F2vbOi.js";import"./useAuth-Ch3vS9aF.js";import"./DefaultTitle-CflPgBg7.js";import"./DefaultTextField-Cphlco4a.js";import"./WrappedLabelGroup-B8FR6YOG.js";import"./DefaultButton-DV9vALRm.js";import"./DefaultNumberInput-DhLo7zal.js";import"./VNumberInput-BYmtFQh2.js";import"./mdi-FFd_BlEo.js";import"./StandardLabeledGroup-BYx6jjmA.js";import"./filter-l9f7gJs0.js";const he={__name:"OrdersCreateForm",setup(ae){const{t:u}=P(),{objectToFormData:D}=G(),F=U(),p=H(),{removeDateTimezonesFromFormData:S}=J(),t=g(!1),m=g(!1),d=g(!1),w=y({manufacturer_id:i().required(),country_id:i().required(),receive_date:T().required(),products:A().of(y({process_id:i().required(),quantity:i().required(),comment:R().nullable(),serialization_type_id:i().required()}))}),V={manufacturer_id:null,country_id:null,receive_date:null,comment:null,products:[]},{errors:c,handleSubmit:x,resetForm:$,setErrors:M,meta:_}=h({validationSchema:w,initialValues:{...V}}),{values:l}=X(Object.keys(V)),{fields:v,push:B,remove:O}=I("products"),b=x(n=>{const r=D(n);S(r),t.value=!0,j.post(route("pld.orders.store"),r).then(()=>{p.addCreatedSuccessfullyMessage(),d.value&&$(),m.value&&window.history.back()}).catch(o=>{o.response?.status===422?(M(o.response.data.errors),p.addFixErrorsMessage()):p.addSubmitionFailedMessage()}).finally(()=>{t.value=!1})});return(n,r)=>(E(),z(e(N),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:s(()=>[a(C,null,{default:s(()=>[a(k,null,{default:s(()=>[a(f,{cols:"4"},{default:s(()=>[a(q,{label:e(u)("fields.Manufacturer"),items:e(F).props.manufacturers,modelValue:e(l).manufacturer_id,"onUpdate:modelValue":r[0]||(r[0]=o=>e(l).manufacturer_id=o),"error-messages":e(c).manufacturer_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),a(f,{cols:"4"},{default:s(()=>[a(q,{label:e(u)("fields.Country"),items:e(F).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(l).country_id,"onUpdate:modelValue":r[1]||(r[1]=o=>e(l).country_id=o),"error-messages":e(c).country_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),a(f,{cols:"4"},{default:s(()=>[a(re,{label:e(u)("dates.Receive"),modelValue:e(l).receive_date,"onUpdate:modelValue":r[2]||(r[2]=o=>e(l).receive_date=o),"error-messages":e(c).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(K,{"form-values":e(l),"products-fields":e(v),push:e(B),remove:e(O)},null,8,["form-values","products-fields","push","remove"]),a(C,null,{default:s(()=>[a(k,null,{default:s(()=>[a(f,{cols:"12"},{default:s(()=>[a(L,{modelValue:e(l).comment,"onUpdate:modelValue":r[3]||(r[3]=o=>e(l).comment=o),label:e(u)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(Q,null,{default:s(()=>[a(W,{onClick:r[4]||(r[4]=o=>{n.similarRecords=void 0,n.matchedATX=void 0,e($)()}),loading:t.value},null,8,["loading"]),a(ee,{onClick:r[5]||(r[5]=o=>{d.value=!1,m.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),a(Y,{onClick:r[6]||(r[6]=o=>{d.value=!0,m.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),a(Z,{onClick:r[7]||(r[7]=o=>{d.value=!0,m.value=!0,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{he as default};
