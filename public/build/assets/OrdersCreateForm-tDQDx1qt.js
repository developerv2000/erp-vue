import{u as P,d as U,h as g,m as y,p as A,q as u,n as R,D as T,v as j,c as z,o as E,w as o,a as r,b as e}from"./app-DOf95tBZ.js";import{u as h,b as I,F as N}from"./vee-validate-iGy6L2Et.js";import{u as X}from"./useVeeFormFields-BgSQN7NI.js";import{u as G}from"./useFormData-DEk4Ge6e.js";import{u as H}from"./messages-CJWGX76Z.js";import{u as J}from"./useDateFormatter-lNg3m9jd.js";import{D as C}from"./DefaultSheet-Bo28t-lZ.js";import K from"./OrdersCreateProductsRepeater-COGb9QHH.js";import{_ as q}from"./DefaultAutocomplete-BJbYhNkf.js";import{_ as L}from"./DefaultWysiwyg-CWkSG_Q_.js";import{F as Q}from"./FormActionsContainer-Dotk18hQ.js";import{_ as W}from"./FormResetButton-DP-Ysz90.js";import{_ as Y}from"./FormStoreAndRedirectBack-BM4n7RXX.js";import{_ as Z}from"./FormStoreAndReset-CCyVC2q4.js";import{_ as ee}from"./FormStoreWithoutReseting-B9bJiztA.js";import{_ as ae}from"./DefaultDateInput-DXhsv86L.js";import{V as k,a as f}from"./VRow-Cy3v7yA0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./global-DWteVSZf.js";import"./useAuth-D6vGxOb_.js";import"./DefaultTitle-B3d09Usl.js";import"./DefaultTextField-GcET5rA7.js";import"./WrappedLabelGroup-CL5wgard.js";import"./DefaultButton-CDvad8-0.js";import"./DefaultNumberInput-ClQn_v_M.js";import"./VNumberInput-ykTB3xol.js";import"./mdi-BiCQTzTv.js";import"./StandardLabeledGroup-DUofg0o0.js";import"./filter-DZdboOLp.js";const Oe={__name:"OrdersCreateForm",setup(re){const{t:i}=P(),{objectToFormData:D}=G(),F=U(),c=H(),{removeDateTimezonesFromFormData:S}=J(),t=g(!1),d=g(!1),m=g(!1),w=y({manufacturer_id:u().required(),country_id:u().required(),receive_date:T().required(),products:A().of(y({process_id:u().required(),quantity:u().required(),comment:R().nullable(),serialization_type_id:u().required()}))}),V={manufacturer_id:null,country_id:null,receive_date:null,comment:null,products:[]},{errors:p,handleSubmit:x,resetForm:$,setErrors:M,meta:_}=h({validationSchema:w,initialValues:{...V}}),{values:l}=X(Object.keys(V)),{fields:v,push:B,remove:O}=I("products"),b=x(n=>{const a=D(n);S(a),t.value=!0,j.post(route("pld.orders.store"),a).then(()=>{c.addCreatedSuccessfullyMessage(),m.value&&$(),d.value&&window.history.back()}).catch(s=>{s.response?.status===422?(M(s.response.data.errors),c.addFixErrorsMessage()):c.addSubmitionFailedMessage()}).finally(()=>{t.value=!1})});return(n,a)=>(E(),z(e(N),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[r(C,null,{default:o(()=>[r(k,null,{default:o(()=>[r(f,{cols:"4"},{default:o(()=>[r(q,{label:e(i)("fields.Manufacturer"),items:e(F).props.manufacturers,modelValue:e(l).manufacturer_id,"onUpdate:modelValue":a[0]||(a[0]=s=>e(l).manufacturer_id=s),"error-messages":e(p).manufacturer_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),r(f,{cols:"4"},{default:o(()=>[r(q,{label:e(i)("fields.Country"),items:e(F).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(l).country_id,"onUpdate:modelValue":a[1]||(a[1]=s=>e(l).country_id=s),"error-messages":e(p).country_id,disabled:e(v).length>0,required:""},null,8,["label","items","modelValue","error-messages","disabled"])]),_:1}),r(f,{cols:"4"},{default:o(()=>[r(ae,{label:e(i)("dates.Receive"),modelValue:e(l).receive_date,"onUpdate:modelValue":a[2]||(a[2]=s=>e(l).receive_date=s),"error-messages":e(p).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),r(K,{"form-values":e(l),"products-fields":e(v),push:e(B),remove:e(O)},null,8,["form-values","products-fields","push","remove"]),r(C,null,{default:o(()=>[r(k,null,{default:o(()=>[r(f,{cols:"12"},{default:o(()=>[r(L,{modelValue:e(l).comment,"onUpdate:modelValue":a[3]||(a[3]=s=>e(l).comment=s),label:e(i)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),r(Q,null,{default:o(()=>[r(W,{onClick:a[4]||(a[4]=s=>{n.similarRecords=void 0,n.matchedATX=void 0,e($)()}),loading:t.value},null,8,["loading"]),r(ee,{onClick:a[5]||(a[5]=s=>{m.value=!1,d.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),r(Z,{onClick:a[6]||(a[6]=s=>{m.value=!0,d.value=!1,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"]),r(Y,{onClick:a[7]||(a[7]=s=>{m.value=!0,d.value=!0,e(b)()}),loading:t.value,disabled:!e(_).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Oe as default};
