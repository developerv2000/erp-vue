import{d as S,u as U,h as P,c as y,o as p,w as o,a,f as V,k as x,g,t as h,b as r,dc as M,F as z,r as O,C as $,v}from"./app-7F7n231s.js";import{u as A}from"./messages-BpNGX81Q.js";import{u as B}from"./global-CYw4cvbg.js";import{D as N}from"./DefaultSheet-Bm4meVVs.js";import{_ as T}from"./DefaultTitle-DATk8Np2.js";import{_ as D}from"./DefaultTextField-iaBkelQq.js";import{_ as R}from"./DefaultButton-CwMkA5bK.js";import{_ as j}from"./DefaultNumberInput-BobIA8kF.js";import{_ as f}from"./DefaultAutocomplete-CFwUw-fX.js";import{G as E,O as G}from"./mdi-BZMfrfO1.js";import{V as H,a as i}from"./VRow-CyQ_eN64.js";import"./useAuth-DFZ3-HmZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-ACzNTxzo.js";import"./VNumberInput-C9eUyK9o.js";import"./StandardLabeledGroup-6CEA9mNA.js";import"./filter-P6R30PoH.js";const L={key:0,class:"mb-5"},ne={__name:"OrdersCreateProductsRepeater",props:{formValues:{type:Object,required:!0},productsFields:{type:Array,required:!0},push:{type:Function,required:!0},remove:{type:Function,required:!0}},setup(u){const d=u,b=S(),{t:l}=U(),m=P([]),c=A(),n=B(),F=()=>({ready_for_order_process_id:null,process_id:null,mah_options:[],quantity:null,comment:null,serialization_type_id:null}),q=async()=>{if(!n.loading){n.loading=!0;try{const s=await v.get(route("pld.get-ready-for-order-processes-of-manufacturer",{manufacturer_id:d.formValues.manufacturer_id,country_id:d.formValues.country_id}));m.value=s.data??[]}catch{m.value=[],c.addSubmitionFailedMessage()}finally{n.loading=!1}}},k=async()=>{try{if(d.productsFields.length===0&&await q(),m.value.length===0){c.add({text:l("messages.No products found for the given manufacturer and country"),color:"error"});return}d.push(F())}catch{c.addSubmitionFailedMessage()}},w=async(s,_)=>{if(!_){s.value.mah_options=[];return}n.loading=!0;try{const e=await v.get(route("pld.get-process-with-it-similar-records-for-order",{process_id:_}));s.value.mah_options=e.data??[]}catch{s.value.mah_options=[],c.addSubmitionFailedMessage()}finally{n.loading=!1}};return(s,_)=>(p(),y(N,null,{default:o(()=>[a(T,null,{default:o(()=>[g(h(r(l)("Products")),1)]),_:1}),u.productsFields.length>0?(p(),V("div",L,[a(M,{tag:"div",group:""},{default:o(()=>[(p(!0),V(z,null,O(u.productsFields,(e,C)=>(p(),y(H,{key:e.key},{default:o(()=>[a(i,null,{default:o(()=>[a(f,{label:r(l)("fields.TM Eng"),modelValue:e.value.ready_for_order_process_id,"onUpdate:modelValue":[t=>e.value.ready_for_order_process_id=t,t=>w(e,t)],items:m.value,"item-title":"full_english_product_label_with_id",required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(i,null,{default:o(()=>[a(f,{label:r(l)("fields.MAH"),modelValue:e.value.process_id,"onUpdate:modelValue":t=>e.value.process_id=t,items:e.value.mah_options,"item-title":"mah_name_with_id",required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(i,null,{default:o(()=>[a(j,{label:r(l)("fields.Quantity"),modelValue:e.value.quantity,"onUpdate:modelValue":t=>e.value.quantity=t,min:0,required:""},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(i,null,{default:o(()=>[a(D,{label:r(l)("Comment"),modelValue:e.value.comment,"onUpdate:modelValue":t=>e.value.comment=t},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(i,null,{default:o(()=>[a(f,{label:r(l)("fields.Serialization type"),modelValue:e.value.serialization_type_id,"onUpdate:modelValue":t=>e.value.serialization_type_id=t,items:r(b).props.serializationTypes,required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(i,{cols:"1",class:"d-flex align-center justify-center"},{default:o(()=>[a($,{class:"mt-6",color:"error",size:"small",icon:r(E),onClick:t=>u.remove(C)},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):x("",!0),a(R,{color:"indigo","prepend-icon":r(G),onClick:k,disabled:!u.formValues.manufacturer_id||!u.formValues.country_id},{default:o(()=>[g(h(r(l)("actions.Add")),1)]),_:1},8,["prepend-icon","disabled"])]),_:1}))}};export{ne as default};
