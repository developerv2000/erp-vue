import{d as S,u as U,h as P,c as y,o as p,w as o,a,f as V,k as x,g,t as h,b as r,da as M,F as z,r as $,B,v}from"./app-BNo3BRZK.js";import{u as O}from"./messages-Cs0KdrfF.js";import{u as A}from"./global-D6MjQ0eg.js";import{D as N}from"./DefaultSheet-DFjuZFHA.js";import{_ as T}from"./DefaultTitle-CflPgBg7.js";import{_ as D}from"./DefaultTextField-Cphlco4a.js";import{_ as R}from"./DefaultButton-DV9vALRm.js";import{_ as j}from"./DefaultNumberInput-DhLo7zal.js";import{_ as f}from"./DefaultAutocomplete-DszskMLj.js";import{C as E,K as H}from"./mdi-FFd_BlEo.js";import{V as G,a as u}from"./VRow-CaL1JTsj.js";import"./notifications-CMQhZgJC.js";import"./queryHelper-C2x2SXyh.js";import"./processesTable-DPkTOcMJ.js";import"./processStatusHistoryTable-DvHlBA9L.js";import"./productsTable-DNWXQY2R.js";import"./attachments-BJYYVVB2.js";import"./comments-tUKV5Khd.js";import"./manufacturersTable-CJSwRuvl.js";import"./usersTable-DGLRepJo.js";import"./kpi-D8F2vbOi.js";import"./useAuth-Ch3vS9aF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-B8FR6YOG.js";import"./VNumberInput-BYmtFQh2.js";import"./StandardLabeledGroup-BYx6jjmA.js";import"./filter-l9f7gJs0.js";const K={key:0,class:"mb-5"},he={__name:"OrdersCreateProductsRepeater",props:{formValues:{type:Object,required:!0},productsFields:{type:Array,required:!0},push:{type:Function,required:!0},remove:{type:Function,required:!0}},setup(i){const d=i,b=S(),{t:l}=U(),m=P([]),c=O(),n=A(),F=()=>({ready_for_order_process_id:null,process_id:null,mah_options:[],quantity:null,comment:null,serialization_type_id:null}),k=async()=>{if(!n.loading){n.loading=!0;try{const s=await v.get(route("pld.get-ready-for-order-processes-of-manufacturer",{manufacturer_id:d.formValues.manufacturer_id,country_id:d.formValues.country_id}));m.value=s.data??[]}catch{m.value=[],c.addSubmitionFailedMessage()}finally{n.loading=!1}}},q=async()=>{try{if(d.productsFields.length===0&&await k(),m.value.length===0){c.add({text:l("messages.No products found for the given manufacturer and country"),color:"error"});return}d.push(F())}catch{c.addSubmitionFailedMessage()}},w=async(s,_)=>{if(!_){s.value.mah_options=[];return}n.loading=!0;try{const e=await v.get(route("pld.get-process-with-it-similar-records-for-order",{process_id:_}));s.value.mah_options=e.data??[]}catch{s.value.mah_options=[],c.addSubmitionFailedMessage()}finally{n.loading=!1}};return(s,_)=>(p(),y(N,null,{default:o(()=>[a(T,null,{default:o(()=>[g(h(r(l)("Products")),1)]),_:1}),i.productsFields.length>0?(p(),V("div",K,[a(M,{tag:"div",group:""},{default:o(()=>[(p(!0),V(z,null,$(i.productsFields,(e,C)=>(p(),y(G,{key:e.key},{default:o(()=>[a(u,null,{default:o(()=>[a(f,{label:r(l)("fields.TM Eng"),modelValue:e.value.ready_for_order_process_id,"onUpdate:modelValue":[t=>e.value.ready_for_order_process_id=t,t=>w(e,t)],items:m.value,"item-title":"full_english_product_label_with_id",required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(u,null,{default:o(()=>[a(f,{label:r(l)("fields.MAH"),modelValue:e.value.process_id,"onUpdate:modelValue":t=>e.value.process_id=t,items:e.value.mah_options,"item-title":"mah_name_with_id",required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(u,null,{default:o(()=>[a(j,{label:r(l)("fields.Quantity"),modelValue:e.value.quantity,"onUpdate:modelValue":t=>e.value.quantity=t,min:0},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(u,null,{default:o(()=>[a(D,{label:r(l)("Comment"),modelValue:e.value.comment,"onUpdate:modelValue":t=>e.value.comment=t},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(u,null,{default:o(()=>[a(f,{label:r(l)("fields.Serialization type"),modelValue:e.value.serialization_type_id,"onUpdate:modelValue":t=>e.value.serialization_type_id=t,items:r(b).props.serializationTypes,required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(u,{cols:"1",class:"d-flex align-center justify-center"},{default:o(()=>[a(B,{class:"mt-6",color:"error",size:"small",icon:r(E),onClick:t=>i.remove(C)},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):x("",!0),a(R,{color:"indigo","prepend-icon":r(H),onClick:q,disabled:!i.formValues.manufacturer_id||!i.formValues.country_id},{default:o(()=>[g(h(r(l)("actions.Add")),1)]),_:1},8,["prepend-icon","disabled"])]),_:1}))}};export{he as default};
