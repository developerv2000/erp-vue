import{d as S,u as U,h as P,c as y,o as p,w as o,a,f as V,k as x,g,t as h,b as l,dc as M,F as z,r as $,C as N,v}from"./app-CQVFqoTu.js";import{u as O}from"./messages-BRd9BCk1.js";import{u as A}from"./global-B64Y10lP.js";import{D as B}from"./DefaultSheet-B2JB7lGP.js";import{_ as T}from"./DefaultTitle-BiVa2e-i.js";import{_ as D}from"./DefaultTextField-Do4YQsZX.js";import{_ as R}from"./DefaultButton-B_v1FrQC.js";import{_ as j}from"./DefaultNumberInput-BetiOo9z.js";import{_ as f}from"./DefaultAutocomplete-Ba5hMo-M.js";import{F as E,N as H}from"./mdi-BiCQTzTv.js";import{V as G,a as n}from"./VRow-DY7ZvkVD.js";import"./useAuth-Coe5__aO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-DsYq1q3D.js";import"./VNumberInput-BCJiuLoL.js";import"./StandardLabeledGroup-B3eb9bCu.js";import"./filter-DXn2-kQs.js";const L={key:0,class:"mb-5"},ie={__name:"OrdersCreateProductsRepeater",props:{formValues:{type:Object,required:!0},productsFields:{type:Array,required:!0},push:{type:Function,required:!0},remove:{type:Function,required:!0}},setup(u){const d=u,b=S(),{t:r}=U(),m=P([]),c=O(),i=A(),F=()=>({ready_for_order_process_id:null,process_id:null,mah_options:[],quantity:null,comment:null,serialization_type_id:null}),k=async()=>{if(!i.loading){i.loading=!0;try{const s=await v.get(route("pld.get-ready-for-order-processes-of-manufacturer",{manufacturer_id:d.formValues.manufacturer_id,country_id:d.formValues.country_id}));m.value=s.data??[]}catch{m.value=[],c.addSubmitionFailedMessage()}finally{i.loading=!1}}},q=async()=>{try{if(d.productsFields.length===0&&await k(),m.value.length===0){c.add({text:r("messages.No products found for the given manufacturer and country"),color:"error"});return}d.push(F())}catch{c.addSubmitionFailedMessage()}},w=async(s,_)=>{if(!_){s.value.mah_options=[];return}i.loading=!0;try{const e=await v.get(route("pld.get-process-with-it-similar-records-for-order",{process_id:_}));s.value.mah_options=e.data??[]}catch{s.value.mah_options=[],c.addSubmitionFailedMessage()}finally{i.loading=!1}};return(s,_)=>(p(),y(B,null,{default:o(()=>[a(T,null,{default:o(()=>[g(h(l(r)("Products")),1)]),_:1}),u.productsFields.length>0?(p(),V("div",L,[a(M,{tag:"div",group:""},{default:o(()=>[(p(!0),V(z,null,$(u.productsFields,(e,C)=>(p(),y(G,{key:e.key},{default:o(()=>[a(n,null,{default:o(()=>[a(f,{label:l(r)("fields.TM Eng"),modelValue:e.value.ready_for_order_process_id,"onUpdate:modelValue":[t=>e.value.ready_for_order_process_id=t,t=>w(e,t)],items:m.value,"item-title":"full_english_product_label_with_id",required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(n,null,{default:o(()=>[a(f,{label:l(r)("fields.MAH"),modelValue:e.value.process_id,"onUpdate:modelValue":t=>e.value.process_id=t,items:e.value.mah_options,"item-title":"mah_name_with_id",required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(n,null,{default:o(()=>[a(j,{label:l(r)("fields.Quantity"),modelValue:e.value.quantity,"onUpdate:modelValue":t=>e.value.quantity=t,min:0},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(n,null,{default:o(()=>[a(D,{label:l(r)("Comment"),modelValue:e.value.comment,"onUpdate:modelValue":t=>e.value.comment=t},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(n,null,{default:o(()=>[a(f,{label:l(r)("fields.Serialization type"),modelValue:e.value.serialization_type_id,"onUpdate:modelValue":t=>e.value.serialization_type_id=t,items:l(b).props.serializationTypes,required:""},null,8,["label","modelValue","onUpdate:modelValue","items"])]),_:2},1024),a(n,{cols:"1",class:"d-flex align-center justify-center"},{default:o(()=>[a(N,{class:"mt-6",color:"error",size:"small",icon:l(E),onClick:t=>u.remove(C)},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):x("",!0),a(R,{color:"indigo","prepend-icon":l(H),onClick:q,disabled:!u.formValues.manufacturer_id||!u.formValues.country_id},{default:o(()=>[g(h(l(r)("actions.Add")),1)]),_:1},8,["prepend-icon","disabled"])]),_:1}))}};export{ie as default};
