import{u as T,d as A,l as f,h as U,D as L,q as V,n as z,m as G,j as H,c as b,o as g,w as s,a,k as w,g as y,t as F,b as e}from"./app-7F7n231s.js";import{u as J,F as K}from"./vee-validate-DitXN_gH.js";import{u as Q}from"./useVeeFormFields-D3hBZ0Tv.js";import{u as W}from"./useFormData-DEk4Ge6e.js";import{u as X}from"./messages-BpNGX81Q.js";import{u as Y}from"./useDateFormatter-aJ6VLTy8.js";import{D as $}from"./DefaultSheet-Bm4meVVs.js";import{_ as C}from"./DefaultTitle-DATk8Np2.js";import{_ as Z}from"./DefaultTextField-iaBkelQq.js";import{_ as D}from"./DefaultAutocomplete-CFwUw-fX.js";import{_ as M}from"./DefaultWysiwyg-B20h2Gec.js";import{_ as h}from"./DefaultDateInput-LY6Hla1c.js";import{F as ee}from"./FormActionsContainer-BjLDdYrs.js";import{_ as ae}from"./FormResetButton-C2t87iFc.js";import{a as le,_ as re}from"./FormUpdateWithourRedirect-B6LYWHXu.js";import{V as k,a as m}from"./VRow-CyQ_eN64.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-ACzNTxzo.js";import"./StandardLabeledGroup-6CEA9mNA.js";import"./filter-P6R30PoH.js";import"./mdi-BZMfrfO1.js";import"./DefaultButton-CwMkA5bK.js";const xe={__name:"OrdersEditForm",setup(se){const{t:u}=T(),{objectToFormData:N}=W(),c=A(),_=X(),{removeDateTimezonesFromFormData:R}=Y(),t=f(()=>c.props.record),i=U(!1),p=U(!1),B=f(()=>{const d={manufacturer_id:V().required(),country_id:V().required(),receive_date:L().required()};return t.value?.is_sent_to_confirmation&&(d.name=z().required(),d.currency_id=V().required()),G(d)}),j=f(()=>({manufacturer_id:t.value.manufacturer_id,country_id:t.value.country_id,receive_date:t.value.receive_date,name:t.value.name,currency_id:t.value.currency_id})),E={comment:null},v=f(()=>({...j.value,...E})),{handleSubmit:I,errors:n,setErrors:O,resetForm:q,meta:x}=J({validationSchema:B,initialValues:v.value}),{values:o}=Q(Object.keys(v.value)),S=I(d=>{const l=N(d);R(l),i.value=!0,axios.post(route("pld.orders.update",{record:t.value.id}),l).then(()=>{_.addUpdatedSuccessfullyMessage(),p.value?window.history.back():P()}).catch(r=>{r.response?.status===422?(O(r.response.data.errors),_.addFixErrorsMessage()):_.addSubmitionFailedMessage()}).finally(()=>{i.value=!1})}),P=()=>{H.reload({only:["record"],onSuccess:()=>{q({values:v.value})}})};return(d,l)=>(g(),b(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:s(()=>[a($,null,{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("departments.PLD")),1)]),_:1}),a(k,null,{default:s(()=>[a(m,null,{default:s(()=>[a(D,{label:e(u)("fields.Manufacturer"),items:e(c).props.manufacturers,modelValue:e(o).manufacturer_id,"onUpdate:modelValue":l[0]||(l[0]=r=>e(o).manufacturer_id=r),"error-messages":e(n).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),a(m,null,{default:s(()=>[a(D,{label:e(u)("fields.Country"),items:e(c).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(o).country_id,"onUpdate:modelValue":l[1]||(l[1]=r=>e(o).country_id=r),"error-messages":e(n).country_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),a(m,null,{default:s(()=>[a(h,{label:e(u)("dates.Receive"),modelValue:e(o).receive_date,"onUpdate:modelValue":l[2]||(l[2]=r=>e(o).receive_date=r),"error-messages":e(n).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),t.value.is_sent_to_confirmation?(g(),b($,{key:0},{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("departments.CMD")),1)]),_:1}),a(k,null,{default:s(()=>[a(m,null,{default:s(()=>[a(Z,{label:e(u)("fields.Name"),modelValue:e(o).name,"onUpdate:modelValue":l[3]||(l[3]=r=>e(o).name=r),"error-messages":e(n).name,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,null,{default:s(()=>[a(D,{label:e(u)("fields.Currency"),items:e(c).props.currencies,modelValue:e(o).currency_id,"onUpdate:modelValue":l[4]||(l[4]=r=>e(o).currency_id=r),"error-messages":e(n).currency_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1})):w("",!0),a($,null,{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("Comments")),1)]),_:1}),a(k,null,{default:s(()=>[a(m,null,{default:s(()=>[a(M,{modelValue:e(o).comment,"onUpdate:modelValue":l[5]||(l[5]=r=>e(o).comment=r),label:e(u)("comments.New"),"error-messages":e(n).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),t.value.last_comment?(g(),b(m,{key:0},{default:s(()=>[a(M,{modelValue:t.value.last_comment.body,"onUpdate:modelValue":l[6]||(l[6]=r=>t.value.last_comment.body=r),label:e(u)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):w("",!0)]),_:1})]),_:1}),a(ee,null,{default:s(()=>[a(ae,{onClick:e(q),loading:i.value},null,8,["onClick","loading"]),a(le,{onClick:l[7]||(l[7]=r=>{p.value=!1,e(S)()}),loading:i.value,disabled:!e(x).valid},null,8,["loading","disabled"]),a(re,{onClick:l[8]||(l[8]=r=>{p.value=!0,e(S)()}),loading:i.value,disabled:!e(x).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{xe as default};
