import{u as T,d as A,l as f,h as N,d9 as L,q as V,n as z,m as G,j as H,c as b,o as g,w as s,a,k as S,g as y,t as F,b as e}from"./app-BNo3BRZK.js";import{u as J,F as K}from"./vee-validate-BGprmE20.js";import{u as Q}from"./useVeeFormFields-CcqTQBJf.js";import{u as W}from"./useFormData-CgBSWld4.js";import{u as X}from"./messages-Cs0KdrfF.js";import{u as Y}from"./useDateFormatter-BmNfNSqK.js";import{D as $}from"./DefaultSheet-DFjuZFHA.js";import{_ as C}from"./DefaultTitle-CflPgBg7.js";import{_ as Z}from"./DefaultTextField-Cphlco4a.js";import{_ as k}from"./DefaultAutocomplete-DszskMLj.js";import{_ as U}from"./DefaultWysiwyg-Berhlzg0.js";import{_ as h}from"./DefaultDateInput-B0xn95Is.js";import{F as ee}from"./FormActionsContainer-DVRhIQui.js";import{_ as ae}from"./FormResetButton-JYxkgVjV.js";import{_ as re,a as le}from"./FormUpdateWithourRedirect-CAH9E1oV.js";import{V as q,a as m}from"./VRow-CaL1JTsj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-B8FR6YOG.js";import"./StandardLabeledGroup-BYx6jjmA.js";import"./filter-l9f7gJs0.js";import"./mdi-FFd_BlEo.js";import"./DefaultButton-DV9vALRm.js";const xe={__name:"OrdersEditForm",setup(se){const{t:u}=T(),{objectToFormData:w}=W(),c=A(),_=X(),{removeDateTimezonesFromFormData:R}=Y(),t=f(()=>c.props.record),i=N(!1),p=N(!1),B=f(()=>{const n={manufacturer_id:V().required(),country_id:V().required(),receive_date:L().required()};return t.value.is_sent_to_confirmation&&(n.name=z().required(),n.currency_id=V().required()),G(n)}),j=f(()=>({manufacturer_id:t.value.manufacturer_id,country_id:t.value.country_id,receive_date:t.value.receive_date,name:t.value.name,currency_id:t.value.currency_id})),E={comment:null},v=f(()=>({...j.value,...E})),{handleSubmit:I,errors:d,setErrors:O,resetForm:D,meta:x}=J({validationSchema:B,initialValues:v.value}),{values:o}=Q(Object.keys(v.value)),M=I(n=>{const r=w(n);R(r),i.value=!0,axios.post(route("pld.orders.update",{record:t.value.id}),r).then(()=>{_.addUpdatedSuccessfullyMessage(),p.value?window.history.back():P()}).catch(l=>{l.response?.status===422?(O(l.response.data.errors),_.addFixErrorsMessage()):_.addSubmitionFailedMessage()}).finally(()=>{i.value=!1})}),P=()=>{H.reload({only:["record"],onSuccess:()=>{D({values:v.value})}})};return(n,r)=>(g(),b(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:s(()=>[a($,null,{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("departments.PLD")),1)]),_:1}),a(q,null,{default:s(()=>[a(m,{cols:"4"},{default:s(()=>[a(k,{label:e(u)("fields.Manufacturer"),items:e(c).props.manufacturers,modelValue:e(o).manufacturer_id,"onUpdate:modelValue":r[0]||(r[0]=l=>e(o).manufacturer_id=l),"error-messages":e(d).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),a(m,{cols:"4"},{default:s(()=>[a(k,{label:e(u)("fields.Country"),items:e(c).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(o).country_id,"onUpdate:modelValue":r[1]||(r[1]=l=>e(o).country_id=l),"error-messages":e(d).country_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),a(m,{cols:"4"},{default:s(()=>[a(h,{label:e(u)("dates.Receive"),modelValue:e(o).receive_date,"onUpdate:modelValue":r[2]||(r[2]=l=>e(o).receive_date=l),"error-messages":e(d).receive_date,"value-format":"yyyy-MM-dd",required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),t.value.is_sent_to_confirmation?(g(),b($,{key:0},{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("departments.CMD")),1)]),_:1}),a(q,null,{default:s(()=>[a(m,{cols:"4"},{default:s(()=>[a(Z,{label:e(u)("fields.Name"),modelValue:e(o).Name,"onUpdate:modelValue":r[3]||(r[3]=l=>e(o).Name=l),"error-messages":e(d).Name,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,{cols:"4"},{default:s(()=>[a(k,{label:e(u)("fields.Currency"),items:e(c).props.currencies,modelValue:e(o).currency_id,"onUpdate:modelValue":r[4]||(r[4]=l=>e(o).currency_id=l),"error-messages":e(d).currency_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1})):S("",!0),a($,null,{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("Comments")),1)]),_:1}),a(q,null,{default:s(()=>[a(m,null,{default:s(()=>[a(U,{modelValue:e(o).comment,"onUpdate:modelValue":r[5]||(r[5]=l=>e(o).comment=l),label:e(u)("comments.New"),"error-messages":e(d).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),t.value.last_comment?(g(),b(m,{key:0},{default:s(()=>[a(U,{modelValue:t.value.last_comment.body,"onUpdate:modelValue":r[6]||(r[6]=l=>t.value.last_comment.body=l),label:e(u)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):S("",!0)]),_:1})]),_:1}),a(ee,null,{default:s(()=>[a(ae,{onClick:e(D),loading:i.value},null,8,["onClick","loading"]),a(re,{onClick:r[7]||(r[7]=l=>{p.value=!0,e(M)()}),loading:i.value,disabled:!e(x).valid},null,8,["loading","disabled"]),a(le,{onClick:r[8]||(r[8]=l=>{p.value=!1,e(M)()}),loading:i.value,disabled:!e(x).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{xe as default};
