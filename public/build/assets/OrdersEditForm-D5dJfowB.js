import{u as T,d as A,l as f,h as U,D as L,q as V,n as z,m as G,j as H,c as b,o as g,w as s,a,k as w,g as y,t as F,b as e}from"./app-Bv235s-M.js";import{u as J,F as K}from"./vee-validate-B-1CKIak.js";import{u as Q}from"./useVeeFormFields-J-_CRR1z.js";import{u as W}from"./useFormData-DEk4Ge6e.js";import{u as X}from"./messages-CrCj1jht.js";import{u as Y}from"./useDateFormatter-cYKpR2k9.js";import{D as $}from"./DefaultSheet-kIGXXLen.js";import{_ as C}from"./DefaultTitle-BFXSLasM.js";import{_ as Z}from"./DefaultTextField-DEo4xlzs.js";import{_ as D}from"./DefaultAutocomplete-TUcT7G3v.js";import{_ as M}from"./DefaultWysiwyg-4IHBiKGV.js";import{_ as h}from"./DefaultDateInput-Bd8T_AhU.js";import{F as ee}from"./FormActionsContainer-Bg-aVW1K.js";import{_ as ae}from"./FormResetButton-B0o_1JkG.js";import{a as re,_ as le}from"./FormUpdateWithourRedirect-CCYSlGQz.js";import{V as k,a as m}from"./VRow-DQpkIAa1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-Cjr3GLjY.js";import"./StandardLabeledGroup-DHmFV98J.js";import"./filter-ELhmIoIq.js";import"./mdi-CnKAdudM.js";import"./DefaultButton-DBGLuZMW.js";const xe={__name:"OrdersEditForm",setup(se){const{t:u}=T(),{objectToFormData:N}=W(),c=A(),_=X(),{removeDateTimezonesFromFormData:R}=Y(),t=f(()=>c.props.record),i=U(!1),p=U(!1),B=f(()=>{const d={manufacturer_id:V().required(),country_id:V().required(),receive_date:L().required()};return t.value?.is_sent_to_confirmation&&(d.name=z().required(),d.currency_id=V().required()),G(d)}),j=f(()=>({manufacturer_id:t.value.manufacturer_id,country_id:t.value.country_id,receive_date:t.value.receive_date,name:t.value.name,currency_id:t.value.currency_id})),E={comment:null},v=f(()=>({...j.value,...E})),{handleSubmit:I,errors:n,setErrors:O,resetForm:q,meta:x}=J({validationSchema:B,initialValues:v.value}),{values:o}=Q(Object.keys(v.value)),S=I(d=>{const r=N(d);R(r),i.value=!0,axios.post(route("pld.orders.update",{record:t.value.id}),r).then(()=>{_.addUpdatedSuccessfullyMessage(),p.value?window.history.back():P()}).catch(l=>{l.response?.status===422?(O(l.response.data.errors),_.addFixErrorsMessage()):_.addSubmitionFailedMessage()}).finally(()=>{i.value=!1})}),P=()=>{H.reload({only:["record"],onSuccess:()=>{q({values:v.value})}})};return(d,r)=>(g(),b(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:s(()=>[a($,null,{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("departments.PLD")),1)]),_:1}),a(k,null,{default:s(()=>[a(m,null,{default:s(()=>[a(D,{label:e(u)("Manufacturer"),items:e(c).props.manufacturers,modelValue:e(o).manufacturer_id,"onUpdate:modelValue":r[0]||(r[0]=l=>e(o).manufacturer_id=l),"error-messages":e(n).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),a(m,null,{default:s(()=>[a(D,{label:e(u)("fields.Country"),items:e(c).props.countriesOrderedByProcessesCount,"item-title":"code",modelValue:e(o).country_id,"onUpdate:modelValue":r[1]||(r[1]=l=>e(o).country_id=l),"error-messages":e(n).country_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),a(m,null,{default:s(()=>[a(h,{label:e(u)("dates.Receive"),modelValue:e(o).receive_date,"onUpdate:modelValue":r[2]||(r[2]=l=>e(o).receive_date=l),"error-messages":e(n).receive_date,required:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),t.value.is_sent_to_confirmation?(g(),b($,{key:0},{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("departments.CMD")),1)]),_:1}),a(k,null,{default:s(()=>[a(m,null,{default:s(()=>[a(Z,{label:e(u)("fields.Name"),modelValue:e(o).name,"onUpdate:modelValue":r[3]||(r[3]=l=>e(o).name=l),"error-messages":e(n).name,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),a(m,null,{default:s(()=>[a(D,{label:e(u)("fields.Currency"),items:e(c).props.currencies,modelValue:e(o).currency_id,"onUpdate:modelValue":r[4]||(r[4]=l=>e(o).currency_id=l),"error-messages":e(n).currency_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1})):w("",!0),a($,null,{default:s(()=>[a(C,null,{default:s(()=>[y(F(e(u)("Comments")),1)]),_:1}),a(k,null,{default:s(()=>[a(m,null,{default:s(()=>[a(M,{modelValue:e(o).comment,"onUpdate:modelValue":r[5]||(r[5]=l=>e(o).comment=l),label:e(u)("comments.New"),"error-messages":e(n).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),t.value.last_comment?(g(),b(m,{key:0},{default:s(()=>[a(M,{modelValue:t.value.last_comment.body,"onUpdate:modelValue":r[6]||(r[6]=l=>t.value.last_comment.body=l),label:e(u)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):w("",!0)]),_:1})]),_:1}),a(ee,null,{default:s(()=>[a(ae,{onClick:e(q),loading:i.value},null,8,["onClick","loading"]),a(re,{onClick:r[7]||(r[7]=l=>{p.value=!1,e(S)()}),loading:i.value,disabled:!e(x).valid},null,8,["loading","disabled"]),a(le,{onClick:r[8]||(r[8]=l=>{p.value=!0,e(S)()}),loading:i.value,disabled:!e(x).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{xe as default};
