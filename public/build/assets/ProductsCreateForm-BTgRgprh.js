import{h as Z,i as Y,r as g,j as z,k as R,m as _,n as x,p as C,a as M,o as D,w as r,b as l,u as e,ac as B,s as P}from"./app-BN27vI2s.js";import{u as H,a as J,F as K}from"./vee-validate-BMCBLxOQ.js";import{u as Q}from"./useVeeFormFields-C1ufDKTL.js";import{u as W}from"./useFormData-CgBSWld4.js";import{u as h}from"./global-BU4MyCAM.js";import{u as ee}from"./messages-Db4UKgA7.js";import le from"./ProductsSimilarRecords-DmRwOoPJ.js";import ae from"./ProductsMatchedATX-DSJDrYuG.js";import se from"./ProductsCreateRepeater-Cmv4HM9l.js";import{D as F}from"./DefaultSheet-Cl8fn3wX.js";import{_ as b}from"./DefaultTextField-Nkap9VOR.js";import{_ as c}from"./DefaultAutocomplete-C4u3BvbQ.js";import{_ as oe}from"./DefaultFileInput-Bpry5xz0.js";import{D as X}from"./DefaultSwitch-CGYa0dAs.js";import{_ as re}from"./DefaultWysiwyg-DhWsvs_Q.js";import{F as de}from"./FormActionsContainer-DokICrL3.js";import{_ as te}from"./FormResetButton-DGjL4dFi.js";import{_ as ie,a as ue}from"./FormStoreAndReset-C6-qL0hT.js";import{_ as ne}from"./FormStoreWithoutReseting-CyrLPfJR.js";import{V as U,a as t}from"./VRow-BBoCECn2.js";import"./DefaultTitle-DVKCj7A3.js";import"./InertiaLink-BaBkWODh.js";import"./utilities-BOpNCN-e.js";import"./DefaultButton-bK-sfj_8.js";import"./DefaultNumberInput-Cj6DUUf_.js";import"./WrappedLabelGroup-WAr2PA7b.js";import"./VNumberInput-CVY8OHej.js";import"./mdi-B8JOKl2S.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-DlI0SdXp.js";import"./filter-C_VrKd3f.js";import"./VSwitch-CiLd8Xz7.js";const Ne={__name:"ProductsCreateForm",setup(me){const{t:d}=Z(),{objectToFormData:E}=W(),u=Y(),V=h(),m=ee(),f=g(void 0),v=g(!1),p=g(!1),y=g(!1),S=g(!1),I=z({manufacturer_id:_().required(),inn_id:_().required(),form_id:_().required(),class_id:_().required(),shelf_life_id:_().required(),zones:R().required().min(1),atx_name:x().required(),products:R().of(z({dosage:x().required(),pack:x().nullable(),moq:_().nullable()}))}),w={manufacturer_id:null,inn_id:null,form_id:null,class_id:u.props.defaultSelectedClassID??null,shelf_life_id:u.props.defaultSelectedShelfLifeID??null,brand:null,zones:u.props.defaultSelectedZoneIDs??[],dossier:null,bioequivalence:null,down_payment:null,validity_period:null,registered_in_eu:0,sold_in_eu:0,attachments:[],comment:null,atx_name:null,atx_short_name:null,products:[{dosage:null,pack:null}]},{errors:i,handleSubmit:j,resetForm:A,setErrors:G,meta:$}=H({validationSchema:I,initialValues:{...w}}),{values:s}=Q(Object.keys(w)),{fields:L,push:N,remove:O}=J("products"),q=j(n=>{p.value=!0;const a=E(n);C.post(route("mad.products.store"),a).then(()=>{m.addCreatedSuccessfullyMessage(),f.value=void 0,S.value&&(f.value=void 0,v.value=!1,A()),y.value&&window.history.back()}).catch(o=>{o.response?.status===422?(G(o.response.data.errors),m.addFixErrorsMessage()):m.addSubmitionFailedMessage()}).finally(()=>{p.value=!1})}),k=()=>{if(!s.manufacturer_id||!s.inn_id||!s.form_id){f.value=void 0;return}V.loading=!0,C.post(route("mad.products.get-similar-records"),{manufacturer_id:s.manufacturer_id,inn_id:s.inn_id,form_id:s.form_id}).then(n=>{f.value=n.data,m.addSimilarRecordsUpdatedSuccessfullyMessage()}).catch(()=>{m.addSimilarRecordsUpdateFailedMessage()}).finally(()=>{V.loading=!1})},T=()=>{if(!s.inn_id||!s.form_id){v.value=!1;return}v.value=!0,V.loading=!0,C.post(route("mad.products.get-matched-atx"),{inn_id:s.inn_id,form_id:s.form_id}).then(n=>{s.atx_name=n.data?.name,s.atx_short_name=n.data?.short_name,m.addMatchedATXUpdatedSuccessfullyMessage()}).catch(()=>{m.addMatchedATXUpdateFailedMessage()}).finally(()=>{V.loading=!1})};return(n,a)=>(D(),M(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:r(()=>[l(F,null,{default:r(()=>[l(U,null,{default:r(()=>[l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Manufacturer"),items:e(u).props.manufacturers,modelValue:e(s).manufacturer_id,"onUpdate:modelValue":[a[0]||(a[0]=o=>e(s).manufacturer_id=o),k],"error-messages":e(i).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Generic"),items:e(u).props.inns,modelValue:e(s).inn_id,"onUpdate:modelValue":[a[1]||(a[1]=o=>e(s).inn_id=o),a[2]||(a[2]=o=>{k(),T()})],"error-messages":e(i).inn_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Form"),items:e(u).props.productForms,modelValue:e(s).form_id,"onUpdate:modelValue":[a[3]||(a[3]=o=>e(s).form_id=o),a[4]||(a[4]=o=>{k(),T()})],"error-messages":e(i).form_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(B,null,{default:r(()=>[f.value!=null?(D(),M(le,{key:0,records:f.value},null,8,["records"])):P("",!0)]),_:1}),l(B,null,{default:r(()=>[v.value?(D(),M(ae,{key:0,values:e(s),errors:e(i)},null,8,["values","errors"])):P("",!0)]),_:1}),l(se,{fields:e(L),push:e(N),remove:e(O)},null,8,["fields","push","remove"]),l(F,null,{default:r(()=>[l(U,null,{default:r(()=>[l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Product class"),items:e(u).props.productClasses,modelValue:e(s).class_id,"onUpdate:modelValue":a[5]||(a[5]=o=>e(s).class_id=o),"error-messages":e(i).class_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Shelf life"),items:e(u).props.shelfLifes,modelValue:e(s).shelf_life_id,"onUpdate:modelValue":a[6]||(a[6]=o=>e(s).shelf_life_id=o),"error-messages":e(i).shelf_life_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Brand"),modelValue:e(s).brand,"onUpdate:modelValue":a[7]||(a[7]=o=>e(s).brand=o),"error-messages":e(i).brand},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Dossier"),modelValue:e(s).dossier,"onUpdate:modelValue":a[8]||(a[8]=o=>e(s).dossier=o),"error-messages":e(i).dossier},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Zones"),items:e(u).props.zones,modelValue:e(s).zones,"onUpdate:modelValue":a[9]||(a[9]=o=>e(s).zones=o),"error-messages":e(i).zones,multiple:"",required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Bioequivalence"),modelValue:e(s).bioequivalence,"onUpdate:modelValue":a[10]||(a[10]=o=>e(s).bioequivalence=o),"error-messages":e(i).bioequivalence},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Down payment"),modelValue:e(s).down_payment,"onUpdate:modelValue":a[11]||(a[11]=o=>e(s).down_payment=o),"error-messages":e(i).down_payment},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Validity period"),modelValue:e(s).validity_period,"onUpdate:modelValue":a[12]||(a[12]=o=>e(s).validity_period=o),"error-messages":e(i).validity_period},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(oe,{label:e(d)("Attachments"),modelValue:e(s).attachments,"onUpdate:modelValue":a[13]||(a[13]=o=>e(s).attachments=o),"error-messages":e(i).attachments,multiple:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(F,null,{default:r(()=>[l(U,null,{default:r(()=>[l(t,{cols:"12",class:"d-flex ga-12"},{default:r(()=>[l(X,{color:"pink-darken-3",label:e(d)("fields.Registered in EU"),modelValue:e(s).registered_in_eu,"onUpdate:modelValue":a[14]||(a[14]=o=>e(s).registered_in_eu=o)},null,8,["label","modelValue"]),l(X,{color:"indigo",label:e(d)("fields.Sold in EU"),modelValue:e(s).sold_in_eu,"onUpdate:modelValue":a[15]||(a[15]=o=>e(s).sold_in_eu=o)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),l(F,null,{default:r(()=>[l(U,null,{default:r(()=>[l(t,{cols:"12"},{default:r(()=>[l(re,{modelValue:e(s).comment,"onUpdate:modelValue":a[16]||(a[16]=o=>e(s).comment=o),label:e(d)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),l(de,null,{default:r(()=>[l(te,{onClick:a[17]||(a[17]=o=>{f.value=void 0,n.matchedATX=void 0,e(A)()}),loading:p.value},null,8,["loading"]),l(ne,{onClick:a[18]||(a[18]=o=>{S.value=!1,y.value=!1,e(q)()}),loading:p.value,disabled:!e($).valid},null,8,["loading","disabled"]),l(ie,{onClick:a[19]||(a[19]=o=>{S.value=!0,y.value=!1,e(q)()}),loading:p.value,disabled:!e($).valid},null,8,["loading","disabled"]),l(ue,{onClick:a[20]||(a[20]=o=>{S.value=!0,y.value=!0,e(q)()}),loading:p.value,disabled:!e($).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Ne as default};
