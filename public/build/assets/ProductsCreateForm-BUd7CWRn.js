import{u as Z,d as Y,h as g,m as z,p as R,q as _,n as x,v as C,c as M,o as D,w as r,a as l,b as e,db as B,k as P}from"./app-Clvn7mZt.js";import{u as H,b as J,F as K}from"./vee-validate-CtywQttp.js";import{u as Q}from"./useVeeFormFields-D7gXNeDw.js";import{u as W}from"./useFormData-DEk4Ge6e.js";import{u as h}from"./global-DDw4yfKB.js";import{u as ee}from"./messages-NMh0QN-V.js";import le from"./ProductsSimilarRecords-fWADYlYB.js";import ae from"./ProductsMatchedATX-YM-qsTZc.js";import se from"./ProductsCreateRepeater-H7DxDDnd.js";import{D as q}from"./DefaultSheet-CDkrXgyL.js";import{_ as b}from"./DefaultTextField-RKxCG5Y-.js";import{_ as c}from"./DefaultAutocomplete-Czwix3Fg.js";import{_ as oe}from"./DefaultFileInput-D1r9L_lo.js";import{D as X}from"./DefaultSwitch-CuPQy5Jj.js";import{_ as re}from"./DefaultWysiwyg-BU4XL9Yo.js";import{F as de}from"./FormActionsContainer-B6L5wfCr.js";import{_ as te}from"./FormResetButton-CO2Q9277.js";import{_ as ie}from"./FormStoreAndRedirectBack-DcrzuWSl.js";import{_ as ue}from"./FormStoreAndReset-DVBmRvna.js";import{_ as ne}from"./FormStoreWithoutReseting-D1YXYVk6.js";import{V as F,a as t}from"./VRow-D9HLbqfl.js";import"./useAuth-D50fan-m.js";import"./DefaultTitle-McgGyca7.js";import"./InertiaLink-DxSMLlYu.js";import"./utilities-BOpNCN-e.js";import"./DefaultButton-BFphiFCx.js";import"./DefaultNumberInput-CnqZJhao.js";import"./WrappedLabelGroup-aYf4w-ZQ.js";import"./VNumberInput-Dvx616f0.js";import"./mdi-BiCQTzTv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-LekNWnmf.js";import"./filter-DSSeUQYK.js";import"./VSwitch-Dz3lTKem.js";const Ze={__name:"ProductsCreateForm",setup(me){const{t:d}=Z(),{objectToFormData:E}=W(),u=Y(),V=h(),m=ee(),f=g(void 0),v=g(!1),p=g(!1),y=g(!1),S=g(!1),I=z({manufacturer_id:_().required(),inn_id:_().required(),form_id:_().required(),class_id:_().required(),shelf_life_id:_().required(),zones:R().required().min(1),atx_name:x().required(),products:R().of(z({dosage:x().required(),pack:x().nullable(),moq:_().nullable()}))}),w={manufacturer_id:null,inn_id:null,form_id:null,class_id:u.props.defaultSelectedClassID??null,shelf_life_id:u.props.defaultSelectedShelfLifeID??null,brand:null,zones:u.props.defaultSelectedZoneIDs??[],dossier:null,bioequivalence:null,down_payment:null,validity_period:null,registered_in_eu:0,sold_in_eu:0,attachments:[],comment:null,atx_name:null,atx_short_name:null,products:[{dosage:null,pack:null}]},{errors:i,handleSubmit:j,resetForm:A,setErrors:G,meta:U}=H({validationSchema:I,initialValues:{...w}}),{values:s}=Q(Object.keys(w)),{fields:L,push:N,remove:O}=J("products"),$=j(n=>{p.value=!0;const a=E(n);C.post(route("mad.products.store"),a).then(()=>{m.addCreatedSuccessfullyMessage(),f.value=void 0,S.value&&(f.value=void 0,v.value=!1,A()),y.value&&window.history.back()}).catch(o=>{o.response?.status===422?(G(o.response.data.errors),m.addFixErrorsMessage()):m.addSubmitionFailedMessage()}).finally(()=>{p.value=!1})}),k=()=>{if(!s.manufacturer_id||!s.inn_id||!s.form_id){f.value=void 0;return}V.loading=!0,C.post(route("mad.products.get-similar-records"),{manufacturer_id:s.manufacturer_id,inn_id:s.inn_id,form_id:s.form_id}).then(n=>{f.value=n.data,m.addSimilarRecordsUpdatedSuccessfullyMessage()}).catch(()=>{m.addSimilarRecordsUpdateFailedMessage()}).finally(()=>{V.loading=!1})},T=()=>{if(!s.inn_id||!s.form_id){v.value=!1;return}v.value=!0,V.loading=!0,C.post(route("mad.products.get-matched-atx"),{inn_id:s.inn_id,form_id:s.form_id}).then(n=>{s.atx_name=n.data?.name,s.atx_short_name=n.data?.short_name,m.addMatchedATXUpdatedSuccessfullyMessage()}).catch(()=>{m.addMatchedATXUpdateFailedMessage()}).finally(()=>{V.loading=!1})};return(n,a)=>(D(),M(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:r(()=>[l(q,null,{default:r(()=>[l(F,null,{default:r(()=>[l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Manufacturer"),items:e(u).props.manufacturers,modelValue:e(s).manufacturer_id,"onUpdate:modelValue":[a[0]||(a[0]=o=>e(s).manufacturer_id=o),k],"error-messages":e(i).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Generic"),items:e(u).props.inns,modelValue:e(s).inn_id,"onUpdate:modelValue":[a[1]||(a[1]=o=>e(s).inn_id=o),a[2]||(a[2]=o=>{k(),T()})],"error-messages":e(i).inn_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Form"),items:e(u).props.productForms,modelValue:e(s).form_id,"onUpdate:modelValue":[a[3]||(a[3]=o=>e(s).form_id=o),a[4]||(a[4]=o=>{k(),T()})],"error-messages":e(i).form_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(B,null,{default:r(()=>[f.value!=null?(D(),M(le,{key:0,records:f.value},null,8,["records"])):P("",!0)]),_:1}),l(B,null,{default:r(()=>[v.value?(D(),M(ae,{key:0,values:e(s),errors:e(i)},null,8,["values","errors"])):P("",!0)]),_:1}),l(se,{fields:e(L),push:e(N),remove:e(O)},null,8,["fields","push","remove"]),l(q,null,{default:r(()=>[l(F,null,{default:r(()=>[l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Product class"),items:e(u).props.productClasses,modelValue:e(s).class_id,"onUpdate:modelValue":a[5]||(a[5]=o=>e(s).class_id=o),"error-messages":e(i).class_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Shelf life"),items:e(u).props.shelfLifes,modelValue:e(s).shelf_life_id,"onUpdate:modelValue":a[6]||(a[6]=o=>e(s).shelf_life_id=o),"error-messages":e(i).shelf_life_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Brand"),modelValue:e(s).brand,"onUpdate:modelValue":a[7]||(a[7]=o=>e(s).brand=o),"error-messages":e(i).brand},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Dossier"),modelValue:e(s).dossier,"onUpdate:modelValue":a[8]||(a[8]=o=>e(s).dossier=o),"error-messages":e(i).dossier},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(c,{label:e(d)("fields.Zones"),items:e(u).props.zones,modelValue:e(s).zones,"onUpdate:modelValue":a[9]||(a[9]=o=>e(s).zones=o),"error-messages":e(i).zones,multiple:"",required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Bioequivalence"),modelValue:e(s).bioequivalence,"onUpdate:modelValue":a[10]||(a[10]=o=>e(s).bioequivalence=o),"error-messages":e(i).bioequivalence},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Down payment"),modelValue:e(s).down_payment,"onUpdate:modelValue":a[11]||(a[11]=o=>e(s).down_payment=o),"error-messages":e(i).down_payment},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(b,{label:e(d)("fields.Validity period"),modelValue:e(s).validity_period,"onUpdate:modelValue":a[12]||(a[12]=o=>e(s).validity_period=o),"error-messages":e(i).validity_period},null,8,["label","modelValue","error-messages"])]),_:1}),l(t,{cols:"4"},{default:r(()=>[l(oe,{label:e(d)("Attachments"),modelValue:e(s).attachments,"onUpdate:modelValue":a[13]||(a[13]=o=>e(s).attachments=o),"error-messages":e(i).attachments,multiple:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(q,null,{default:r(()=>[l(F,null,{default:r(()=>[l(t,{cols:"12",class:"d-flex ga-12"},{default:r(()=>[l(X,{color:"pink-darken-3",label:e(d)("fields.Registered in EU"),modelValue:e(s).registered_in_eu,"onUpdate:modelValue":a[14]||(a[14]=o=>e(s).registered_in_eu=o)},null,8,["label","modelValue"]),l(X,{color:"indigo",label:e(d)("fields.Sold in EU"),modelValue:e(s).sold_in_eu,"onUpdate:modelValue":a[15]||(a[15]=o=>e(s).sold_in_eu=o)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),l(q,null,{default:r(()=>[l(F,null,{default:r(()=>[l(t,{cols:"12"},{default:r(()=>[l(re,{modelValue:e(s).comment,"onUpdate:modelValue":a[16]||(a[16]=o=>e(s).comment=o),label:e(d)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),l(de,null,{default:r(()=>[l(te,{onClick:a[17]||(a[17]=o=>{f.value=void 0,n.matchedATX=void 0,e(A)()}),loading:p.value},null,8,["loading"]),l(ne,{onClick:a[18]||(a[18]=o=>{S.value=!1,y.value=!1,e($)()}),loading:p.value,disabled:!e(U).valid},null,8,["loading","disabled"]),l(ue,{onClick:a[19]||(a[19]=o=>{S.value=!0,y.value=!1,e($)()}),loading:p.value,disabled:!e(U).valid},null,8,["loading","disabled"]),l(ie,{onClick:a[20]||(a[20]=o=>{S.value=!0,y.value=!0,e($)()}),loading:p.value,disabled:!e(U).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Ze as default};
