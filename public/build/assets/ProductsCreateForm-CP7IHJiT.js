import{h as Z,i as Y,r as c,j as z,k as R,n as x,m as g,p as C,a as M,o as D,w as o,b as l,u as e,ac as B,s as P}from"./app-DAozJfJi.js";import{u as H,a as J,F as K}from"./vee-validate-D3eE-l8X.js";import{u as Q}from"./useVeeFormFields-BjupO0_d.js";import{u as W}from"./useFormData-CgBSWld4.js";import{u as h}from"./global-tXBlfjCw.js";import{u as ee}from"./messages-DMYsu7y-.js";import le from"./ProductsSimilarRecords-3NKxQwf0.js";import ae from"./ProductsMatchedATX--tzIILyV.js";import se from"./ProductsCreateRepeater-DaLhqMaB.js";import{D as F}from"./DefaultSheet-Cb7a327k.js";import{_ as b}from"./DefaultTextField-D3Lo5c6q.js";import{_}from"./DefaultAutocomplete-BGgEnULx.js";import{_ as re}from"./DefaultFileInput-izm0aEC9.js";import{D as X}from"./DefaultSwitch-CbxQf1gm.js";import{_ as oe}from"./DefaultWysiwyg-vaAeo481.js";import{F as de}from"./FormActionsContainer-Cdv5hsQI.js";import{_ as ie}from"./FormResetButton-DpRbNtYy.js";import{_ as te,a as ue}from"./FormStoreAndReset-CGKTC4mJ.js";import{_ as ne}from"./FormStoreWithoutReseting-B6E7_62l.js";import{V as U,a as i}from"./VRow-BvpG3oFW.js";import"./DefaultTitle-DH_bbtU4.js";import"./InertiaLink-xWejzHcQ.js";import"./utilities-BOpNCN-e.js";import"./DefaultButton-KwobY4u7.js";import"./DefaultNumberInput-DB8XclRr.js";import"./WrappedLabelGroup-D-KlSZGz.js";import"./VNumberInput-msrK-wkm.js";import"./mdi-B8JOKl2S.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StandardLabeledGroup-DxZxJ086.js";import"./filter-DPydDAdU.js";import"./VSwitch-ivR2wn1Y.js";const Ne={__name:"ProductsCreateForm",setup(me){const{t:d}=Z(),{objectToFormData:E}=W(),u=Y(),V=h(),m=ee(),f=c(void 0),v=c(!1),p=c(!1),y=c(!1),S=c(!1),I=z({manufacturer_id:g().required(),inn_id:g().required(),form_id:g().required(),class_id:g().required(),shelf_life_id:g().required(),zones:R().required().min(1),atx_name:x().required(),products:R().of(z({dosage:x().required(),pack:x().required()}))}),w={manufacturer_id:null,inn_id:null,form_id:null,class_id:u.props.defaultSelectedClassID??null,shelf_life_id:u.props.defaultSelectedShelfLifeID??null,brand:null,zones:u.props.defaultSelectedZoneIDs??[],dossier:null,bioequivalence:null,down_payment:null,validity_period:null,registered_in_eu:0,sold_in_eu:0,attachments:[],comment:null,atx_name:null,atx_short_name:null,products:[]},{errors:t,handleSubmit:j,resetForm:A,setErrors:G,meta:$}=H({validationSchema:I,initialValues:{...w}}),{values:s}=Q(Object.keys(w)),{fields:L,push:N,remove:O}=J("products"),q=j(n=>{p.value=!0;const a=E(n);C.post(route("mad.products.store"),a).then(()=>{m.addCreatedSuccessfullyMessage(),f.value=void 0,S.value&&(f.value=void 0,v.value=!1,A()),y.value&&window.history.back()}).catch(r=>{r.response?.status===422?(G(r.response.data.errors),m.addFixErrorsMessage()):m.addSubmitionFailedMessage()}).finally(()=>{p.value=!1})}),k=()=>{if(!s.manufacturer_id||!s.inn_id||!s.form_id){f.value=void 0;return}V.loading=!0,C.post(route("mad.products.get-similar-records"),{manufacturer_id:s.manufacturer_id,inn_id:s.inn_id,form_id:s.form_id}).then(n=>{f.value=n.data,m.addSimilarRecordsUpdatedSuccessfullyMessage()}).catch(()=>{m.addSimilarRecordsUpdateFailedMessage()}).finally(()=>{V.loading=!1})},T=()=>{if(!s.inn_id||!s.form_id){v.value=!1;return}v.value=!0,V.loading=!0,C.post(route("mad.products.get-matched-atx"),{inn_id:s.inn_id,form_id:s.form_id}).then(n=>{s.atx_name=n.data?.name,s.atx_short_name=n.data?.short_name,m.addMatchedATXUpdatedSuccessfullyMessage()}).catch(()=>{m.addMatchedATXUpdateFailedMessage()}).finally(()=>{V.loading=!1})};return(n,a)=>(D(),M(e(K),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:o(()=>[l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(i,{cols:"4"},{default:o(()=>[l(_,{label:e(d)("fields.Manufacturer"),items:e(u).props.manufacturers,modelValue:e(s).manufacturer_id,"onUpdate:modelValue":[a[0]||(a[0]=r=>e(s).manufacturer_id=r),k],"error-messages":e(t).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(_,{label:e(d)("fields.Generic"),items:e(u).props.inns,modelValue:e(s).inn_id,"onUpdate:modelValue":[a[1]||(a[1]=r=>e(s).inn_id=r),a[2]||(a[2]=r=>{k(),T()})],"error-messages":e(t).inn_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(_,{label:e(d)("fields.Form"),items:e(u).props.productForms,modelValue:e(s).form_id,"onUpdate:modelValue":[a[3]||(a[3]=r=>e(s).form_id=r),a[4]||(a[4]=r=>{k(),T()})],"error-messages":e(t).form_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(B,null,{default:o(()=>[f.value!=null?(D(),M(le,{key:0,records:f.value},null,8,["records"])):P("",!0)]),_:1}),l(B,null,{default:o(()=>[v.value?(D(),M(ae,{key:0,values:e(s),errors:e(t)},null,8,["values","errors"])):P("",!0)]),_:1}),l(se,{fields:e(L),push:e(N),remove:e(O)},null,8,["fields","push","remove"]),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(i,{cols:"4"},{default:o(()=>[l(_,{label:e(d)("fields.Product class"),items:e(u).props.productClasses,modelValue:e(s).class_id,"onUpdate:modelValue":a[5]||(a[5]=r=>e(s).class_id=r),"error-messages":e(t).class_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(_,{label:e(d)("fields.Shelf life"),items:e(u).props.shelfLifes,modelValue:e(s).shelf_life_id,"onUpdate:modelValue":a[6]||(a[6]=r=>e(s).shelf_life_id=r),"error-messages":e(t).shelf_life_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(b,{label:e(d)("fields.Brand"),modelValue:e(s).brand,"onUpdate:modelValue":a[7]||(a[7]=r=>e(s).brand=r),"error-messages":e(t).brand},null,8,["label","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(b,{label:e(d)("fields.Dossier"),modelValue:e(s).dossier,"onUpdate:modelValue":a[8]||(a[8]=r=>e(s).dossier=r),"error-messages":e(t).dossier},null,8,["label","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(_,{label:e(d)("fields.Zones"),items:e(u).props.zones,modelValue:e(s).zones,"onUpdate:modelValue":a[9]||(a[9]=r=>e(s).zones=r),"error-messages":e(t).zones,multiple:"",required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(b,{label:e(d)("fields.Bioequivalence"),modelValue:e(s).bioequivalence,"onUpdate:modelValue":a[10]||(a[10]=r=>e(s).bioequivalence=r),"error-messages":e(t).bioequivalence},null,8,["label","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(b,{label:e(d)("fields.Down payment"),modelValue:e(s).down_payment,"onUpdate:modelValue":a[11]||(a[11]=r=>e(s).down_payment=r),"error-messages":e(t).down_payment},null,8,["label","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(b,{label:e(d)("fields.Validity period"),modelValue:e(s).validity_period,"onUpdate:modelValue":a[12]||(a[12]=r=>e(s).validity_period=r),"error-messages":e(t).validity_period},null,8,["label","modelValue","error-messages"])]),_:1}),l(i,{cols:"4"},{default:o(()=>[l(re,{label:e(d)("Attachments"),modelValue:e(s).attachments,"onUpdate:modelValue":a[13]||(a[13]=r=>e(s).attachments=r),"error-messages":e(t).attachments,multiple:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(i,{cols:"12",class:"d-flex ga-12"},{default:o(()=>[l(X,{color:"pink-darken-3",label:e(d)("fields.Registered in EU"),modelValue:e(s).registered_in_eu,"onUpdate:modelValue":a[14]||(a[14]=r=>e(s).registered_in_eu=r)},null,8,["label","modelValue"]),l(X,{color:"indigo",label:e(d)("fields.Sold in EU"),modelValue:e(s).sold_in_eu,"onUpdate:modelValue":a[15]||(a[15]=r=>e(s).sold_in_eu=r)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),l(F,null,{default:o(()=>[l(U,null,{default:o(()=>[l(i,{cols:"12"},{default:o(()=>[l(oe,{modelValue:e(s).comment,"onUpdate:modelValue":a[16]||(a[16]=r=>e(s).comment=r),label:e(d)("Comment"),folder:"comments"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),l(de,null,{default:o(()=>[l(ie,{onClick:a[17]||(a[17]=r=>{f.value=void 0,n.matchedATX=void 0,e(A)()}),loading:p.value},null,8,["loading"]),l(te,{onClick:a[18]||(a[18]=r=>{S.value=!0,y.value=!0,e(q)()}),loading:p.value,disabled:!e($).valid},null,8,["loading","disabled"]),l(ue,{onClick:a[19]||(a[19]=r=>{S.value=!0,y.value=!1,e(q)()}),loading:p.value,disabled:!e($).valid},null,8,["loading","disabled"]),l(ne,{onClick:a[20]||(a[20]=r=>{S.value=!1,y.value=!1,e(q)()}),loading:p.value,disabled:!e($).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Ne as default};
