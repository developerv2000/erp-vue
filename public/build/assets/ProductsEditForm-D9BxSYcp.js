import{u as P,d as j,s as q,h as w,v as N,x as L,y as O,z as b,j as G,c as D,o as M,w as r,a as l,b as e,k as Q}from"./app-hZxUZo90.js";import{u as Z,F as H}from"./vee-validate-xUKBdEX1.js";import{u as J}from"./useVeeFormFields-CAsfxCR-.js";import{u as K}from"./useFormData-CgBSWld4.js";import{u as W}from"./messages-PTw3b4Be.js";import{d as S,n as Y}from"./utilities-BOpNCN-e.js";import h from"./ProductsMatchedATX-BfHNN6ZR.js";import{D as g}from"./DefaultSheet-DDxr4CAS.js";import{_ as f}from"./DefaultTextField-BCVdUvEi.js";import{_ as p}from"./DefaultAutocomplete-dhVJ-Dig.js";import{_ as ee}from"./DefaultFileInput-CgfrChy-.js";import{D as z}from"./DefaultSwitch-CrBlXTAF.js";import{_ as C}from"./DefaultWysiwyg-Bj21r9oL.js";import{_ as le}from"./DefaultNumberInput-B3UWXhs-.js";import{F as ae}from"./FormActionsContainer-lQnKM5YW.js";import{_ as se}from"./FormResetButton-B2DgPr3f.js";import{_ as oe,a as re}from"./FormUpdateWithourRedirect-CTTZK4oV.js";import{V as c,a as u}from"./VRow-BoKDetD-.js";import"./DefaultTitle-Cw3hPyGf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-BDla1E_l.js";import"./StandardLabeledGroup-BV07aOWA.js";import"./filter-B1WJDCTu.js";import"./mdi-BINEaKNx.js";import"./VSwitch-Cz8axZnM.js";import"./VNumberInput-D_8YWvs6.js";import"./DefaultButton-BHYe61nh.js";const Be={__name:"ProductsEditForm",setup(de){const{t}=P(),{objectToFormData:A}=K(),n=j(),_=W(),d=q(()=>n.props.record),V=w(!1),v=w(!1),T=N({manufacturer_id:b().required(),inn_id:b().required(),form_id:b().required(),class_id:b().required(),shelf_life_id:b().required(),zones:O().required().min(1),atx_name:L().required()}),B=q(()=>({manufacturer_id:d.value.manufacturer_id,inn_id:d.value.inn_id,form_id:d.value.form_id,class_id:d.value.class_id,dosage:d.value.dosage,pack:d.value.pack,moq:d.value.moq,shelf_life_id:d.value.shelf_life_id,brand:d.value.brand,zones:d.value.zones.map(i=>i.id),dossier:d.value.dossier,bioequivalence:d.value.bioequivalence,down_payment:d.value.down_payment,validity_period:d.value.validity_period,registered_in_eu:d.value.registered_in_eu,sold_in_eu:d.value.sold_in_eu,atx_name:d.value.atx?.name,atx_short_name:d.value.atx?.short_name})),E={attachments:[],comment:null},U=q(()=>({...B.value,...E})),{handleSubmit:I,errors:m,setErrors:R,resetForm:y,meta:x}=Z({validationSchema:T,initialValues:U.value}),{values:o}=J(Object.keys(U.value)),k=I(i=>{const a=A(i);V.value=!0,axios.post(route("mad.products.update",{record:d.value.id}),a).then(()=>{_.addUpdatedSuccessfullyMessage(),v.value?window.history.back():X()}).catch(s=>{s.response?.status===422?(R(s.response.data.errors),_.addFixErrorsMessage()):_.addSubmitionFailedMessage()}).finally(()=>{V.value=!1})}),X=()=>{G.reload({only:["record","breadcrumbs"],onSuccess:()=>{y({values:U.value})}})},F=S(()=>{axios.post(route("mad.products.get-matched-atx"),{inn_id:o.inn_id,form_id:o.form_id}).then(i=>{i.data?(o.atx_name=i.data.name,o.atx_short_name=i.data.short_name):(o.atx_name=null,o.atx_short_name=null),_.addMatchedATXUpdatedSuccessfullyMessage()}).catch(()=>{_.addMatchedATXUpdateFailedMessage()})},500),$=S((i,a,s)=>{a[s]=Y(i)},300);return(i,a)=>(M(),D(e(H),{class:"d-flex flex-column ga-6 pb-8",enctype:"multipart/form-data"},{default:r(()=>[l(g,null,{default:r(()=>[l(c,null,{default:r(()=>[l(u,{cols:"4"},{default:r(()=>[l(p,{label:e(t)("fields.Manufacturer"),items:e(n).props.manufacturers,modelValue:e(o).manufacturer_id,"onUpdate:modelValue":a[0]||(a[0]=s=>e(o).manufacturer_id=s),"error-messages":e(m).manufacturer_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(p,{label:e(t)("fields.Generic"),items:e(n).props.inns,modelValue:e(o).inn_id,"onUpdate:modelValue":[a[1]||(a[1]=s=>e(o).inn_id=s),e(F)],"error-messages":e(m).inn_id,required:""},null,8,["label","items","modelValue","error-messages","onUpdate:modelValue"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(p,{label:e(t)("fields.Form"),items:e(n).props.productForms,modelValue:e(o).form_id,"onUpdate:modelValue":[a[2]||(a[2]=s=>e(o).form_id=s),e(F)],"error-messages":e(m).form_id,required:""},null,8,["label","items","modelValue","error-messages","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1}),l(h,{values:e(o),errors:e(m)},null,8,["values","errors"]),l(g,null,{default:r(()=>[l(c,null,{default:r(()=>[l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Dosage"),modelValue:e(o).dosage,"onUpdate:modelValue":[a[3]||(a[3]=s=>e(o).dosage=s),a[4]||(a[4]=s=>e($)(s,e(o),"dosage"))],"error-messages":e(m).dosage},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Pack"),modelValue:e(o).pack,"onUpdate:modelValue":[a[5]||(a[5]=s=>e(o).pack=s),a[6]||(a[6]=s=>e($)(s,e(o),"pack"))],"error-messages":e(m).pack},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(le,{label:e(t)("fields.MOQ"),modelValue:e(o).moq,"onUpdate:modelValue":a[7]||(a[7]=s=>e(o).moq=s),"error-messages":e(m).moq,min:0},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(g,null,{default:r(()=>[l(c,null,{default:r(()=>[l(u,{cols:"4"},{default:r(()=>[l(p,{label:e(t)("fields.Product class"),items:e(n).props.productClasses,modelValue:e(o).class_id,"onUpdate:modelValue":a[8]||(a[8]=s=>e(o).class_id=s),"error-messages":e(m).class_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(p,{label:e(t)("fields.Shelf life"),items:e(n).props.shelfLifes,modelValue:e(o).shelf_life_id,"onUpdate:modelValue":a[9]||(a[9]=s=>e(o).shelf_life_id=s),"error-messages":e(m).shelf_life_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Brand"),modelValue:e(o).brand,"onUpdate:modelValue":a[10]||(a[10]=s=>e(o).brand=s),"error-messages":e(m).brand},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Dossier"),modelValue:e(o).dossier,"onUpdate:modelValue":a[11]||(a[11]=s=>e(o).dossier=s),"error-messages":e(m).dossier},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(p,{label:e(t)("fields.Zones"),items:e(n).props.zones,modelValue:e(o).zones,"onUpdate:modelValue":a[12]||(a[12]=s=>e(o).zones=s),"error-messages":e(m).zones,multiple:"",required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Bioequivalence"),modelValue:e(o).bioequivalence,"onUpdate:modelValue":a[13]||(a[13]=s=>e(o).bioequivalence=s),"error-messages":e(m).bioequivalence},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Down payment"),modelValue:e(o).down_payment,"onUpdate:modelValue":a[14]||(a[14]=s=>e(o).down_payment=s),"error-messages":e(m).down_payment},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(f,{label:e(t)("fields.Validity period"),modelValue:e(o).validity_period,"onUpdate:modelValue":a[15]||(a[15]=s=>e(o).validity_period=s),"error-messages":e(m).validity_period},null,8,["label","modelValue","error-messages"])]),_:1}),l(u,{cols:"4"},{default:r(()=>[l(ee,{label:e(t)("Attachments"),modelValue:e(o).attachments,"onUpdate:modelValue":a[16]||(a[16]=s=>e(o).attachments=s),"error-messages":e(m).attachments,multiple:""},null,8,["label","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(g,null,{default:r(()=>[l(c,null,{default:r(()=>[l(u,{cols:"12",class:"d-flex ga-12"},{default:r(()=>[l(z,{color:"pink-darken-3",label:e(t)("fields.Registered in EU"),modelValue:e(o).registered_in_eu,"onUpdate:modelValue":a[17]||(a[17]=s=>e(o).registered_in_eu=s)},null,8,["label","modelValue"]),l(z,{color:"indigo",label:e(t)("fields.Sold in EU"),modelValue:e(o).sold_in_eu,"onUpdate:modelValue":a[18]||(a[18]=s=>e(o).sold_in_eu=s)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),l(g,null,{default:r(()=>[l(c,null,{default:r(()=>[l(u,null,{default:r(()=>[l(C,{modelValue:e(o).comment,"onUpdate:modelValue":a[19]||(a[19]=s=>e(o).comment=s),label:e(t)("comments.New"),"error-messages":e(m).comment,folder:"comments"},null,8,["modelValue","label","error-messages"])]),_:1}),d.value.last_comment?(M(),D(u,{key:0},{default:r(()=>[l(C,{modelValue:d.value.last_comment.body,"onUpdate:modelValue":a[20]||(a[20]=s=>d.value.last_comment.body=s),label:e(t)("comments.Last"),disabled:""},null,8,["modelValue","label"])]),_:1})):Q("",!0)]),_:1})]),_:1}),l(ae,null,{default:r(()=>[l(se,{onClick:e(y),loading:V.value},null,8,["onClick","loading"]),l(oe,{onClick:a[21]||(a[21]=s=>{v.value=!0,e(k)()}),loading:V.value,disabled:!e(x).valid},null,8,["loading","disabled"]),l(re,{onClick:a[22]||(a[22]=s=>{v.value=!1,e(k)()}),loading:V.value,disabled:!e(x).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{Be as default};
