import{u as S,d as P,l as F,h as $,m as j,p as w,q as R,n as q,j as B,c as E,o as M,w as r,a as s,g as N,t as A,b as e}from"./app-BLgoNwh9.js";import{u as O,F as T}from"./vee-validate-Drp1LwNg.js";import{u as I}from"./useVeeFormFields-CjyoEa7T.js";import{u as z}from"./useFormData-CgBSWld4.js";import{u as G}from"./messages-Daw9qpnw.js";import{D as H}from"./DefaultSheet-B_F13Ex0.js";import{_ as J}from"./DefaultTitle-CXHnAhzD.js";import{_ as k}from"./DefaultTextField-DLLz5uQ3.js";import{_ as f}from"./DefaultAutocomplete-DaB-TeL_.js";import{_ as K}from"./DefaultFileInput-CrJZKpqf.js";import{F as L}from"./FormActionsContainer-6sOzMZOR.js";import{_ as Q}from"./FormResetButton-fHr4EBMu.js";import{_ as W,a as X}from"./FormUpdateWithourRedirect-CzYrkXcW.js";import{V as Y,a as d}from"./VRow-CyYZUeep.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./WrappedLabelGroup-mjx86u9J.js";import"./StandardLabeledGroup-CKUmWAz5.js";import"./filter-p85kxTXY.js";import"./mdi-FFd_BlEo.js";import"./DefaultButton-As932Yet.js";const ve={__name:"UsersEditPersonalDataForm",setup(Z){const{t}=S(),{objectToFormData:D}=z(),u=P(),c=G(),m=F(()=>u.props.record),p=$(!1),g=$(!1),U=j({name:q().required(),email:q().email().required(),department_id:R().required(),roles:w().required().min(1)}),_=F(()=>({name:m.value.name,email:m.value.email,photo:null,department_id:m.value.department_id,roles:m.value.roles.map(i=>i.id),responsible_countries:m.value.responsible_countries.map(i=>i.id),permissions:m.value.permissions.map(i=>i.id)})),{handleSubmit:x,errors:n,setErrors:y,resetForm:b,meta:V}=O({validationSchema:U,initialValues:_.value}),{values:o}=I(Object.keys(_.value)),v=x(i=>{const a=D(i);p.value=!0,axios.post(route("administration.users.update",{record:m.value.id}),a).then(()=>{c.addUpdatedSuccessfullyMessage(),g.value?window.history.back():C()}).catch(l=>{l.response?.status===422?(y(l.response.data.errors),c.addFixErrorsMessage()):c.addSubmitionFailedMessage()}).finally(()=>{p.value=!1})}),C=()=>{B.reload({only:["auth","record"],onSuccess:()=>{b({values:_.value})}})};return(i,a)=>(M(),E(e(T),{class:"d-flex flex-column ga-6",enctype:"multipart/form-data"},{default:r(()=>[s(H,null,{default:r(()=>[s(J,null,{default:r(()=>[N(A(e(t)("forms.Personal data")),1)]),_:1}),s(Y,null,{default:r(()=>[s(d,{cols:"4"},{default:r(()=>[s(k,{label:e(t)("fields.Name"),modelValue:e(o).name,"onUpdate:modelValue":a[0]||(a[0]=l=>e(o).name=l),"error-messages":e(n).name,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),s(d,{cols:"4"},{default:r(()=>[s(k,{label:e(t)("fields.Email"),modelValue:e(o).email,"onUpdate:modelValue":a[1]||(a[1]=l=>e(o).email=l),"error-messages":e(n).email,required:""},null,8,["label","modelValue","error-messages"])]),_:1}),s(d,{cols:"4"},{default:r(()=>[s(K,{label:e(t)("fields.Photo"),modelValue:e(o).photo,"onUpdate:modelValue":a[2]||(a[2]=l=>e(o).photo=l),"error-messages":e(n).photo,accept:".png, .jpg, .jpeg"},null,8,["label","modelValue","error-messages"])]),_:1}),s(d,{cols:"4"},{default:r(()=>[s(f,{label:e(t)("Department"),items:e(u).props.departments,modelValue:e(o).department_id,"onUpdate:modelValue":a[3]||(a[3]=l=>e(o).department_id=l),"error-messages":e(n).department_id,required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),s(d,{cols:"4"},{default:r(()=>[s(f,{label:e(t)("Roles"),items:e(u).props.roles,modelValue:e(o).roles,"onUpdate:modelValue":a[4]||(a[4]=l=>e(o).roles=l),"error-messages":e(n).roles,multiple:"",required:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),s(d,{cols:"4"},{default:r(()=>[s(f,{label:e(t)("fields.Responsible"),items:e(u).props.countriesOrderedByProcessesCount,modelValue:e(o).responsible_countries,"onUpdate:modelValue":a[5]||(a[5]=l=>e(o).responsible_countries=l),"error-messages":e(n).responsible_countries,"item-title":"code",multiple:""},null,8,["label","items","modelValue","error-messages"])]),_:1}),s(d,{cols:"4"},{default:r(()=>[s(f,{label:e(t)("Permissions"),items:e(u).props.permissions,modelValue:e(o).permissions,"onUpdate:modelValue":a[6]||(a[6]=l=>e(o).permissions=l),"error-messages":e(n).permissions,multiple:""},null,8,["label","items","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),s(L,null,{default:r(()=>[s(Q,{onClick:e(b),loading:p.value},null,8,["onClick","loading"]),s(W,{onClick:a[7]||(a[7]=l=>{g.value=!0,e(v)()}),loading:p.value,disabled:!e(V).valid},null,8,["loading","disabled"]),s(X,{onClick:a[8]||(a[8]=l=>{g.value=!1,e(v)()}),loading:p.value,disabled:!e(V).valid},null,8,["loading","disabled"])]),_:1})]),_:1}))}};export{ve as default};
