import{y as o,j as a,v as n}from"./app-B9LPjWSD.js";import{b as s,c as d,n as p,a as _,d as g}from"./queryHelper-LZTJtzGq.js";import{c as l}from"./createRecordActions-Ba682ZE6.js";const r={page:1,per_page:50,order_by:"id",order_direction:"asc",total_records:0,last_page:1,navigate_to_page:1},i={receive_date:null,sent_for_payment_date:null,created_at:null,updated_at:null,invoiceable_id:null,product_id:null,number:[],order_name:[],id:[],payment_type_id:[],order_manufacturer_id:[],order_country_id:[]},c=route("api.pld.invoices.get"),m=o("PLDInvoicesTable",{state:()=>({records:[],loading:!1,initializedFromInertiaPage:!1,selected:[],pagination:{...r},filters:{...i}}),actions:{...l(),initFromInertiaPage(t){this.records=[];const e=t.props.query;this.pagination.page=Number(e.page??1),this.pagination.per_page=Number(e.per_page??r.per_page),this.pagination.order_by=e.order_by??r.order_by,this.pagination.order_direction=e.order_direction??r.order_direction,this.navigate_to_page=this.pagination.page,this.filters.number=e.number,this.filters.order_name=e.order_name,this.filters.id=e.id,p(this.filters,e,["invoiceable_id","product_id"]),_(this.filters,e,["payment_type_id","order_manufacturer_id","order_country_id"]),g(this.filters,e,["receive_date","sent_for_payment_date","created_at","updated_at"]),this.initializedFromInertiaPage=!0},toQuery(){const t={page:this.pagination.page,per_page:this.pagination.per_page,order_by:this.pagination.order_by,order_direction:this.pagination.order_direction,...this.filters,...s(this.filters,["receive_date","sent_for_payment_date","created_at","updated_at"])};return t.page===r.page&&delete t.page,t.per_page===r.per_page&&delete t.per_page,t.order_by===r.order_by&&delete t.order_by,t.order_direction===r.order_direction&&delete t.order_direction,d(t)},fetchRecords({updateUrl:t=!0}={}){this.loading=!0,n.get(c,{params:this.toQuery()}).then(e=>{this.records=e.data.data,this.pagination.total_records=e.data.total,this.pagination.last_page=e.data.last_page,this.pagination.navigate_to_page=e.data.current_page,t&&this.updateUrlAfterFetch()}).finally(()=>{this.loading=!1,this.selected=[]})},fetchRecordsIfOptionsChanged(t){const e=t.sortBy?.[0]??{};(t.page!==this.pagination.page||t.itemsPerPage!==this.pagination.per_page||e.key!==this.pagination.order_by||e.order!==this.pagination.order_direction)&&(this.pagination.page=t.page,this.pagination.per_page=t.itemsPerPage,this.pagination.order_by=e.key??this.pagination.order_by,this.pagination.order_direction=e.order??this.pagination.order_direction,this.fetchRecords({updateUrl:!0}))},updateUrlAfterFetch(){a.get(route(route().current()),this.toQuery(),{only:["query"],replace:!0,preserveState:!0,preserveScroll:!0})},handleNavigateToPage(){this.pagination.page=this.pagination.navigate_to_page,this.fetchRecords({updateUrl:!0})},resetState(){this.records=[],this.loading=!1,this.selected=[],this.pagination={...r},this.filters={...i}},resetUrl(){a.get(route(route().current()),{},{only:[],replace:!0,preserveState:!0,preserveScroll:!0})},applyFilter(){this.pagination.page=1,this.fetchRecords()},resetFilter(){this.resetState(),this.resetUrl(),this.fetchRecords()}}});export{m as u};
