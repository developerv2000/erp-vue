import{y as o,j as a,v as s}from"./app-Bv235s-M.js";import{c as d,e as n,a as p}from"./queryHelper-LZTJtzGq.js";const t={page:1,per_page:50,order_by:"readiness_for_order_date",order_direction:"desc",total_records:0,last_page:1,navigate_to_page:1},i={product_dosage:null,product_pack:null,trademark_en:null,trademark_ru:null,manufacturer_bdm_user_id:null,id:[],product_inn_id:[],manufacturer_id:[],product_form_id:[],country_id:[],marketing_authorization_holder_id:[]},g=route("api.pld.ready-for-order-processes.get"),u=o("PLDReadyForOrderProcessesTable",{state:()=>({records:[],loading:!1,initializedFromInertiaPage:!1,selected:[],pagination:{...t},filters:{...i}}),actions:{initFromInertiaPage(r){this.records=[];const e=r.props.query;this.pagination.page=Number(e.page??1),this.pagination.per_page=Number(e.per_page??t.per_page),this.pagination.order_by=e.order_by??t.order_by,this.pagination.order_direction=e.order_direction??t.order_direction,this.navigate_to_page=this.pagination.page,this.filters.product_dosage=e.product_dosage,this.filters.product_pack=e.product_pack,this.filters.trademark_en=e.trademark_en,this.filters.trademark_ru=e.trademark_ru,this.filters.id=e.id,n(this.filters,e,["manufacturer_bdm_user_id"]),p(this.filters,e,["product_inn_id","manufacturer_id","product_form_id","country_id","marketing_authorization_holder_id"]),this.initializedFromInertiaPage=!0},toQuery(){const r={page:this.pagination.page,per_page:this.pagination.per_page,order_by:this.pagination.order_by,order_direction:this.pagination.order_direction,...this.filters};return r.page===t.page&&delete r.page,r.per_page===t.per_page&&delete r.per_page,r.order_by===t.order_by&&delete r.order_by,r.order_direction===t.order_direction&&delete r.order_direction,d(r)},fetchRecords({updateUrl:r=!0}={}){this.loading=!0,s.get(g,{params:this.toQuery()}).then(e=>{this.records=e.data.data,this.pagination.total_records=e.data.total,this.pagination.last_page=e.data.last_page,this.pagination.navigate_to_page=e.data.current_page,r&&this.updateUrlAfterFetch()}).finally(()=>{this.loading=!1,this.selected=[]})},fetchRecordsIfOptionsChanged(r){const e=r.sortBy?.[0]??{};(r.page!==this.pagination.page||r.itemsPerPage!==this.pagination.per_page||e.key!==this.pagination.order_by||e.order!==this.pagination.order_direction)&&(this.pagination.page=r.page,this.pagination.per_page=r.itemsPerPage,this.pagination.order_by=e.key??this.pagination.order_by,this.pagination.order_direction=e.order??this.pagination.order_direction,this.fetchRecords({updateUrl:!0}))},updateUrlAfterFetch(){a.get(route(route().current()),this.toQuery(),{only:["query"],replace:!0,preserveState:!0,preserveScroll:!0})},handleNavigateToPage(){this.pagination.page=this.pagination.navigate_to_page,this.fetchRecords({updateUrl:!0})},resetState(){this.records=[],this.loading=!1,this.selected=[],this.pagination={...t},this.filters={...i}},resetUrl(){a.get(route(route().current()),{},{only:[],replace:!0,preserveState:!0,preserveScroll:!0})},applyFilter(){this.pagination.page=1,this.fetchRecords()},resetFilter(){this.resetState(),this.resetUrl(),this.fetchRecords()}}});export{u};
