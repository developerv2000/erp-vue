import{d as p,l}from"./app-zlqHbSzm.js";function D(){const c=p(),r=l(()=>c.props.auth?.user),f=l(()=>!!r.value),t=e=>r.value?.roles?r.value.roles.some(n=>n.name===e):!1,o=()=>t("Global administrator"),m=()=>t("Global administrator")||t("MAD administrator"),v=e=>e.replace(/^can-/,"can-not-"),d=e=>{if(!r.value)return!1;const n=v(e);if(r.value.permissions?.some(s=>s.name===n))return!1;if(r.value.permissions?.some(s=>s.name===e))return!0;for(const s of r.value.roles??[])if(s.permissions?.some(a=>a.name===n))return!1;for(const s of r.value.roles??[])if(s.permissions?.some(a=>a.name===e))return!0;return!1},A=e=>e.startsWith("can-")?e:`can-${e}`,i=e=>r.value?o()?!0:d(A(e)):!1,u=(e=[])=>r.value?o()?!0:e.some(n=>i(n)):!1;return{user:r,isLoggedIn:f,hasRole:t,isGlobalAdministrator:o,isAnyAdministrator:m,can:i,canAny:u,owns:e=>!r.value||!e||!e.user_id?!1:e.user_id===r.value.id,isCurrentUserInArray:e=>!r.value||!Array.isArray(e)?!1:e.some(n=>n.id===r.value.id),canReceiveNotifications:()=>r.value?u(["receive-notification-on-MAD-VPS-contract"]):!1}}export{D as u};
