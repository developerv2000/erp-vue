import{d as A,s as i}from"./app-DFGAykv1.js";function G(){const l=A(),e=i(()=>l.props.auth?.user),f=i(()=>!!e.value),t=r=>e.value?.roles?e.value.roles.some(s=>s.name===r):!1,a=()=>t("Global administrator"),c=()=>t("Global administrator")||t("MAD administrator"),m=r=>r.replace(/^can-/,"can-not-"),v=r=>{if(!e.value)return!1;const s=m(r);if(e.value.permissions?.some(n=>n.name===s))return!1;if(e.value.permissions?.some(n=>n.name===r))return!0;for(const n of e.value.roles??[])if(n.permissions?.some(o=>o.name===s))return!1;for(const n of e.value.roles??[])if(n.permissions?.some(o=>o.name===r))return!0;return!1},d=r=>r.startsWith("can-")?r:`can-${r}`,u=r=>e.value?a()?!0:v(d(r)):!1;return{user:e,isLoggedIn:f,hasRole:t,isGlobalAdministrator:a,isAnyAdministrator:c,can:u,canAny:(r=[])=>e.value?a()?!0:r.some(s=>u(s)):!1,owns:r=>!e.value||!r||!r.user_id?!1:r.user_id===e.value.id,isCurrentUserInArray:r=>!e.value||!Array.isArray(r)?!1:r.some(s=>s.id===e.value.id)}}export{G as u};
