import{d as A,l as u}from"./app-CMSjNDK4.js";function G(){const l=A(),r=u(()=>l.props.auth?.user),c=u(()=>!!r.value),t=e=>r.value?.roles?r.value.roles.some(s=>s.name===e):!1,o=()=>t("Global administrator"),f=()=>t("Global administrator")||t("MAD administrator"),m=e=>e.replace(/^can-/,"can-not-"),v=e=>{if(!r.value)return!1;const s=m(e);if(r.value.permissions?.some(n=>n.name===s))return!1;if(r.value.permissions?.some(n=>n.name===e))return!0;for(const n of r.value.roles??[])if(n.permissions?.some(a=>a.name===s))return!1;for(const n of r.value.roles??[])if(n.permissions?.some(a=>a.name===e))return!0;return!1},d=e=>e.startsWith("can-")?e:`can-${e}`,i=e=>r.value?o()?!0:v(d(e)):!1;return{user:r,isLoggedIn:c,hasRole:t,isGlobalAdministrator:o,isAnyAdministrator:f,can:i,canAny:(e=[])=>r.value?o()?!0:e.some(s=>i(s)):!1,owns:e=>!r.value||!e||!e.user_id?!1:e.user_id===r.value.id,isCurrentUserInArray:e=>!r.value||!Array.isArray(e)?!1:e.some(s=>s.id===r.value.id),canReceiveNotifications:()=>{if(!r.value)return!1;if(o())return!0;const e=s=>s?.some(n=>n.name.startsWith("can-receive-notification"));return e(r.value.permissions)||r.value.roles?.some(s=>e(s.permissions))||!1}}}export{G as u};
