import{i as A,c as i}from"./app-BN27vI2s.js";function G(){const l=A(),e=i(()=>l.props.auth?.user),c=i(()=>!!e.value),t=r=>e.value?.roles?e.value.roles.some(n=>n.name===r):!1,a=()=>t("Global administrator"),f=()=>t("Global administrator")||t("MAD administrator"),m=r=>r.replace(/^can-/,"can-not-"),v=r=>{if(!e.value)return!1;const n=m(r);if(e.value.permissions?.some(s=>s.name===n))return!1;if(e.value.permissions?.some(s=>s.name===r))return!0;for(const s of e.value.roles??[])if(s.permissions?.some(o=>o.name===n))return!1;for(const s of e.value.roles??[])if(s.permissions?.some(o=>o.name===r))return!0;return!1},d=r=>r.startsWith("can-")?r:`can-${r}`,u=r=>e.value?a()?!0:v(d(r)):!1;return{user:e,isLoggedIn:c,hasRole:t,isGlobalAdministrator:a,isAnyAdministrator:f,can:u,canAny:(r=[])=>e.value?a()?!0:r.some(n=>u(n)):!1,owns:r=>!e.value||!r||!r.user_id?!1:r.user_id===e.value.id,isCurrentUserInArray:r=>!e.value||!Array.isArray(r)?!1:r.some(n=>n.id===e.value.id)}}export{G as u};
