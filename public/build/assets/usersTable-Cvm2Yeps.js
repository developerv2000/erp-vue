import{E as o,j as a,B as s}from"./app-CGP4rxJE.js";import{b as n,c as d,a as p,d as g}from"./queryHelper-zuYrvkeK.js";const r={page:1,per_page:50,order_by:"name",order_direction:"asc",total_records:0,last_page:1,navigate_to_page:1},i={email:null,created_at:null,updated_at:null,id:[],department_id:[],roles:[],permissions:[],responsible_countries:[]},l=route("api.users.get"),u=o("AdministrationUsersTable",{state:()=>({records:[],loading:!1,initializedFromInertiaPage:!1,selected:[],pagination:{...r},filters:{...i}}),actions:{initFromInertiaPage(e){this.records=[];const t=e.props.query;this.pagination.page=Number(t.page??1),this.pagination.per_page=Number(t.per_page??r.per_page),this.pagination.order_by=t.order_by??r.order_by,this.pagination.order_direction=t.order_direction??r.order_direction,this.navigate_to_page=this.pagination.page,this.filters.email=t.email,p(this.filters,t,["id","department_id","roles","permissions","responsible_countries"]),g(this.filters,t,["created_at","updated_at"]),this.initializedFromInertiaPage=!0},toQuery(){const e={page:this.pagination.page,per_page:this.pagination.per_page,order_by:this.pagination.order_by,order_direction:this.pagination.order_direction,...this.filters,...n(this.filters,["created_at","updated_at"])};return e.page===r.page&&delete e.page,e.per_page===r.per_page&&delete e.per_page,e.order_by===r.order_by&&delete e.order_by,e.order_direction===r.order_direction&&delete e.order_direction,d(e)},fetchRecords({updateUrl:e=!0}={}){this.loading=!0,s.get(l,{params:this.toQuery()}).then(t=>{this.records=t.data.data,this.pagination.total_records=t.data.total,this.pagination.last_page=t.data.last_page,this.pagination.navigate_to_page=t.data.current_page,e&&this.updateUrlAfterFetch()}).finally(()=>{this.loading=!1,this.selected=[]})},fetchRecordsIfOptionsChanged(e){const t=e.sortBy?.[0]??{};(e.page!==this.pagination.page||e.itemsPerPage!==this.pagination.per_page||t.key!==this.pagination.order_by||t.order!==this.pagination.order_direction)&&(this.pagination.page=e.page,this.pagination.per_page=e.itemsPerPage,this.pagination.order_by=t.key??this.pagination.order_by,this.pagination.order_direction=t.order??this.pagination.order_direction,this.fetchRecords({updateUrl:!0}))},updateUrlAfterFetch(){a.get(route(route().current()),this.toQuery(),{only:["query"],replace:!0,preserveState:!0,preserveScroll:!0})},handleNavigateToPage(){this.pagination.page=this.pagination.navigate_to_page,this.fetchRecords({updateUrl:!0})},resetState(){this.records=[],this.loading=!1,this.selected=[],this.pagination={...r},this.filters={...i}},resetUrl(){a.get(route(route().current()),{},{only:[],replace:!0,preserveState:!0,preserveScroll:!0})}}});export{u};
